<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python Web（一）' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python Web（一）</center></div><div class='banquan'>原文出处:本文由博客园博主Infi_chu提供。<br/>
原文连接:https://www.cnblogs.com/Infi-chu/p/11384613.html</div><br>
    <p>&nbsp;Infi-chu:</p>
<p><a href="http://www.cnblogs.com/Infi-chu/" target="_blank">http://www.cnblogs.com/Infi-chu/</a></p>
<p>一、Web框架</p>
<p>1.socket网络编程</p>
<ul>
<li>架构：C/S</li>
<li>协议：TCP/UDP</li>
<li>传输层</li>
</ul>
<p>2.Web应用</p>
<ul>
<li>架构：B/S</li>
<li>协议：HTTP</li>
<li>应用层</li>
</ul>
<p>二、HTTP协议</p>
<p>1.请求、响应</p>
<ul>
<li>请求头</li>
<li>请求体</li>
<li>响应头</li>
<li>响应体</li>
</ul>
<p>2.请求头中的相关参数</p>
<ul>
<li>浏览器支持的内容
<ul>
<li>Accept：客户端接收什么类型的响应</li>
<li>Accept-Charset：浏览器可以接收的字符集</li>
<li>Accept-Encoding：浏览器能够进行解码的数据编码方式</li>
<li>Accept-Language：浏览器希望的语言种类</li>
</ul>
</li>
<li>重要的交互参数
<ul>
<li>Cookie：客户端的Cookie就是通过这个报文头属性传给服务端的后台</li>
<li>Referer：请求的来源URL</li>
<li>Host：初始URL中的IP和PORT</li>
<li>Cache-control：对缓存进行控制</li>
<li>User-Agent：发起请求来源</li>
</ul>
</li>
</ul>
<ul>
<li>其他参数
<ul>
<li>If-Modified-Since：If-Modified-Since：只有当所请求的内容在指定的日期之后又经过修改才返回它，否则返回304&ldquo;Not Modified&rdquo;应答</li>
<li>Pragma：指定&ldquo;no-cache&rdquo;值表示服务器必须返回一个刷新后的文档，即使它是代理服务器而且已经有了页面的本地拷贝</li>
<li>UA-Pixels，UA-Color，UA-OS，UA-CPU：由某些版本的IE浏览器所发送的非标准的请求头，表示屏幕大小、颜色深度、操作系统和CPU类型</li>
<li>Authorization：授权信息，通常出现在对服务器发送的WWW-Authenticate头的应答中</li>
<li>Connection：表示是否需要持久连接。如果Servlet看到这里的值为&ldquo;Keep-Alive&rdquo;，或者看到请求使用的是HTTP 1.1（HTTP 1.1默认进行持久连接），它就可以利用持久连接的优点，当页面包含多个元素时（例如Applet，图片），显著地减少下载所需要的时间。要实现这一点，Servlet需要在应答中发送一个Content-Length头，最简单的实现方法是：先把内容写入ByteArrayOutputStream，然后在正式写出内容之前计算它的大小</li>
<li>Content-Length：表示请求消息正文的长度</li>
</ul>
</li>
</ul>
<p>3.响应头中的相关参数</p>
<table>
<thead>
<tr class="header"><th><strong>Header</strong></th><th><strong>解释</strong></th><th><strong>示例</strong></th></tr>
</thead>
<tbody>
<tr class="odd">
<td>Accept-Ranges</td>
<td>表明服务器是否支持指定范围请求及哪种类型的分段请求</td>
<td>Accept-Ranges: bytes</td>
</tr>
<tr class="even">
<td>Age</td>
<td>从原始服务器到代理缓存形成的估算时间（以秒计，非负）</td>
<td>Age: 12</td>
</tr>
<tr class="odd">
<td>Allow</td>
<td>对某网络资源的有效的请求行为，不允许则返回405</td>
<td>Allow: GET, HEAD</td>
</tr>
<tr class="even">
<td>Cache-Control</td>
<td>告诉所有的缓存机制是否可以缓存及哪种类型</td>
<td>Cache-Control: no-cache</td>
</tr>
<tr class="odd">
<td>Content-Encoding</td>
<td>web服务器支持的返回内容压缩编码类型。</td>
<td>Content-Encoding: gzip</td>
</tr>
<tr class="even">
<td>Content-Language</td>
<td>响应体的语言</td>
<td>Content-Language: en,zh</td>
</tr>
<tr class="odd">
<td>Content-Length</td>
<td>响应体的长度</td>
<td>Content-Length: 348</td>
</tr>
<tr class="even">
<td>Content-Location</td>
<td>请求资源可替代的备用的另一地址</td>
<td>Content-Location: /index.htm</td>
</tr>
<tr class="odd">
<td>Content-MD5</td>
<td>返回资源的MD5校验值</td>
<td>Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ==</td>
</tr>
<tr class="even">
<td>Content-Range</td>
<td>在整个返回体中本部分的字节位置</td>
<td>Content-Range: bytes 21010-47021/47022</td>
</tr>
<tr class="odd">
<td>Content-Type</td>
<td>返回内容的MIME类型</td>
<td>Content-Type: text/html; charset=utf-8</td>
</tr>
<tr class="even">
<td>Date</td>
<td>原始服务器消息发出的时间</td>
<td>Date: Tue, 15 Nov 2010 08:12:31 GMT</td>
</tr>
<tr class="odd">
<td>ETag</td>
<td>请求变量的实体标签的当前值</td>
<td>ETag: &ldquo;737060cd8c284d8af7ad3082f209582d&rdquo;</td>
</tr>
<tr class="even">
<td>Expires</td>
<td>响应过期的日期和时间</td>
<td>Expires: Thu, 01 Dec 2010 16:00:00 GMT</td>
</tr>
<tr class="odd">
<td>Last-Modified</td>
<td>请求资源的最后修改时间</td>
<td>Last-Modified: Tue, 15 Nov 2010 12:45:26 GMT</td>
</tr>
<tr class="even">
<td>Location</td>
<td>用来重定向接收方到非请求URL的位置来完成请求或标识新的资源</td>
<td>Location: http://www.zcmhi.com/archives/94.html</td>
</tr>
<tr class="odd">
<td>Pragma</td>
<td>包括实现特定的指令，它可应用到响应链上的任何接收方</td>
<td>Pragma: no-cache</td>
</tr>
<tr class="even">
<td>Proxy-Authenticate</td>
<td>它指出认证方案和可应用到代理的该URL上的参数</td>
<td>Proxy-Authenticate: Basic</td>
</tr>
<tr class="odd">
<td>refresh</td>
<td>应用于重定向或一个新的资源被创造，在5秒之后重定向（由网景提出，被大部分浏览器支持）</td>
<td>Refresh: 5; url=http://www.atool.org/httptest.php</td>
</tr>
<tr class="even">
<td>Retry-After</td>
<td>如果实体暂时不可取，通知客户端在指定时间之后再次尝试</td>
<td>Retry-After: 120</td>
</tr>
<tr class="odd">
<td>Server</td>
<td>web服务器软件名称</td>
<td>Server: Apache/1.3.27 (Unix) (Red-Hat/Linux)</td>
</tr>
<tr class="even">
<td>Set-Cookie</td>
<td>设置Http Cookie</td>
<td>Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1</td>
</tr>
<tr class="odd">
<td>Trailer</td>
<td>指出头域在分块传输编码的尾部存在</td>
<td>Trailer: Max-Forwards</td>
</tr>
<tr class="even">
<td>Transfer-Encoding</td>
<td>文件传输编码</td>
<td>Transfer-Encoding:chunked</td>
</tr>
<tr class="odd">
<td>Vary</td>
<td>告诉下游代理是使用缓存响应还是从原始服务器请求</td>
<td>Vary: *</td>
</tr>
<tr class="even">
<td>Via</td>
<td>告知代理客户端响应是通过哪里发送的</td>
<td>Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)</td>
</tr>
<tr class="odd">
<td>Warning</td>
<td>警告实体可能存在的问题</td>
<td>Warning: 199 Miscellaneous warning</td>
</tr>
<tr class="even">
<td>WWW-Authenticate</td>
<td>表明客户端请求实体应该使用的授权方案</td>
<td>WWW-Authenticate: Basic</td>
</tr>
<tr class="odd">
<td>X-Powered-By</td>
<td>由语言解析器或者应用程序框架输出的，这个值的意义用于告知网站是用何种语言或框架编写的</td>
<td>X-Powered-By: ASP.NET</td>
</tr>
</tbody>
</table>
<p>4.响应行书写</p>
<p>版本协议+响应码+附加信息\r\n\r\n响应体</p>
<p>eg.</p>
<p>HTTP/1.1 200 OK\r\n\r\n响应体</p>
<p>响应码：</p>
<ul>
<li>1xx:提示信息，表示<strong>请求已</strong>经<strong>接收</strong></li>
<li>2XX:<strong>响应成功</strong></li>
<li>3xx:<strong>响应需要定向（重新记载链接第三方链接）</strong></li>
<li>4xx:<strong>客户端错误</strong></li>
<li>5xx:<strong>服务器端错误</strong></li>
</ul>
<p>常用响应码</p>
<ul>
<li><strong>200</strong>:成功</li>
<li><strong>404</strong>;请求<strong>内容不存在</strong></li>
<li><strong>401</strong>:没有访问<strong>权限</strong></li>
<li><strong>500</strong>:服务器<strong>未知错误</strong></li>
<li><strong>503</strong>: <strong>服务器</strong>暂时<strong>无法执行</strong></li>
</ul>
<p>三、Django</p>
<p>1.安装</p>
<div class="cnblogs_Highlighter">
<pre><code>pip3 install django==版本号
</pre>
</div>
<p>&nbsp;2.创建</p>
<ul>
<li>命令行创建工程：
<div class="cnblogs_Highlighter">
<pre><code>django-admin startproject 项目名称
</pre>
</div>
</li>
<li>pycharm直接创建Django项目</li>
</ul>
<p>3.目录结构</p>
<ul>
<li>project名的文件夹：
<ul>
<li>settings.py：配置文件主要设置一些路径</li>
<li>urls.py：路由映射关系，主要进行一些逻辑和网站的相关显示</li>
<li>wsgi.py：socket服务端文件</li>
</ul>
</li>
<li>manage.py：管理文件</li>
<li>templates：主要用来放HTML模板的地方</li>
<li>static：css、js等相关文件</li>
</ul>
<p>4.设置：</p>
<p>加载css、js相关文件配置：</p>
<p>创建static文件夹，将css、js等文件放入</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">STATIC_URL = '/static/'
STATICFILES_DIRS = (
os.path.join(BASE_DIR, 'static'),
)
#如果,少了加载css会报500的错误,如果么有配置STATICFILES_DIRS会报404的错误
</pre>
</div>
<p>&nbsp;</p>
<p>模块加载：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">MIDDLEWARE = [
'django.middleware.security.SecurityMiddleware',
'django.contrib.sessions.middleware.SessionMiddleware',
'django.middleware.common.CommonMiddleware',
#'django.middleware.csrf.CsrfViewMiddleware',
'django.contrib.auth.middleware.AuthenticationMiddleware',
'django.contrib.messages.middleware.MessageMiddleware',
'django.middleware.clickjacking.XFrameOptionsMiddleware',
]
</pre>
</div>
<p>&nbsp;</p>
<p>读取HTML文件配置：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">'DIRS': [os.path.join(BASE_DIR, 'templates')]
</pre>
</div>
<p>&nbsp;</p>
<p>非本机访问：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">ALLOWED_HOSTS = ['指定ip1','指定ip2']
ALLOWED_HOSTS = ['*'] #全部ip
</pre>
</div>
<p>4.启动</p>
<p>命令行：</p>
<p> python manage.py runserver ip:port</p>
<p>pycharm中：</p>
<p>修改Edit Configuration</p>
<p>&nbsp;</p>
<p>5.Django模板</p>
<p>块定义：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">{% block 名字定义 %}
{% endblock %}
</pre>
</div>
<p>&nbsp;导入模板</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">{% extends '模板的文件名称' %}
{% block 名字定义 %}
模板内添加的内容
{% endblock %}
</pre>
</div>
<p>&nbsp;6.Cookies</p>
<p>用于验证登录等信息</p>
<p>相关参数：</p>
<ul>
<li>
<p>key:cookie的key值</p>
</li>
<li>
<p>value：cookie的value值</p>
</li>
<li>
<p>max_age: 超时时间就是在浏览器缓存中保留多少时间 单位是s 例子：10s</p>
</li>
<li>
<p>expires：作用于max_age类似如果值输入一个数字代表几天,如果输入具体时间格式为2019-9-12代表这天失效</p>
</li>
<li>
<p>path /代表全部生效 ,/aa/表示只在aa所在的域生效</p>
</li>
<li>
<p>domain: 域名表示cookie只在某个域名生效</p>
</li>
<li>
<p>secure: 对于cookies里面数据进行加密,默认为 flase为http协议,加密为ture为https协议</p>
</li>
<li>
<p>httponly: true 代表不能使用js获取cookie <code>通过JS获得cookies我们可以在f12里输入document.cookie</code>获得</p>
</li>
</ul>
<p>Django设置Cookies</p>
<ul>
<li>obj.set_cookie(key, value)</li>
<li>set_signed_cookie(key, val, salt)</li>
</ul>
<p>7.Django APP分组</p>
<p>创建APP：</p>
<div class="cnblogs_Highlighter">
<pre><code>python manage.py startapp app名
</pre>
</div>
<p>app内文件：</p>
<ul>
<li><code>migrations</code>：模型操作的迁移文件</li>
<li><code>admin.py</code>：django admin的时候会用</li>
<li><code>apps.py</code>：注册文件</li>
<li><code>models.py</code>：写表生成的代码</li>
<li><code>tests.py</code>：测试文件</li>
<li><code>views.py</code>：视图文件,一般业务逻辑会写在其中</li>
<li><code>urls.py</code>：格式与主urls.py一样复制过来即可</li>
</ul>
<p>主urls.py：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from django.conf.urls import url, include
urlpatterns = [
    url(r'^test1/', include("test1.urls")),
    url(r'^test2/', include("test2.urls")),
    url(r'^test3/', include("test3.urls")),
]
</pre>
</div>
<p>分urls.py：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from django.conf.urls import url
from test1 import views
urlpatterns = [
    url(r'^get_test1/', views.get_test1) #其域名为/test1/get_test1/,而不是/get_test1/
]
</pre>
</div>
<p>&nbsp;路由分发：</p>
<p>urls.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">url(r'^test/(\w+)/(\w+)/', views.test),
url(r'^test1/(?P&lt;id&gt;\w+)/(?P&lt;name&gt;\w+)/', views.test1),
</pre>
</div>
<p>views.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def test(request, name, id):
    print(id, name)
    return HttpResponse('test')

def test1(request, name, id):
    print(id, name)
    return HttpResponse('test')
</pre>
</div>
<p>&nbsp;【注】</p>
<ul>
<li>如果没有?P的约束， 传参的时候， 会根据顺序来获取参数对应的值</li>
<li>而如果有约束的话， 传参的时候， 会固定的将获取的值传给所对应的的约束</li>
</ul>
<p>定制404 页面：</p>
<p>urls.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">url(r'^', views.notfound),
</pre>
</div>
<p>views.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def notfound(request)；
    return render(request, "404.html")
</pre>
</div>
<p>&nbsp;利用正则表达式以及name关键字反向路由</p>
<p>urls.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">url(r'^login.*?/', views.login, name='xxx'),
</pre>
</div>
<p>login.html</p>
<div class="cnblogs_Highlighter">
<pre class="brush:html;gutter:true;">form action="{% url "xxx" %}" method="post"&gt;
&lt;input type="text"&gt;
&lt;/form&gt;
</pre>
</div>
<p>&nbsp;【注】</p>
<p>当我们输入url 为loginXXXXXXXXXXXXXX的时候网页上form表单的url会自动变成login<br />
如果url(r'^login11', views.login, name='xxx'),上form表单的url会自动变成login11</p>
<p>8.FBV&amp;CBV</p>
<ul>
<li>FBV（function based views）：使用函数来处理业务逻辑</li>
<li>CBV（class bassed views）：使用类来处理业务逻辑</li>
</ul>
<p>eg.</p>
<p>urls.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">url(r'^login/', views.Login.as_view()), #类名.as_view()
</pre>
</div>
<p>views.py</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from django.views import View
class Login(View):
    def get(self, request):    #方法里必须有request来接受传过来的值不然会报错
        return render(request, "login.html") 

    def post(self, request):
        pass
</pre>
</div>
<p>当请求过来时，会优先判断请求方法，如果是GET就使用get函数，如果是POST就是用post函数</p>
<p>继承View类的时候，会自动对传来的参数进行判断</p>
<p>【注】</p>
<ul>
<li>form表单的方式， 只支持GET/POST</li>
<li>ajax的方式, 全部支持</li>
</ul>
<p>9.ORM</p>
<ul>
<li>创建项目</li>
<li>settings.py配置
<ul>
<li>在install_app中配置连接的app
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'app_mysql.apps.AppMysqlConfig', #这个是我们pycharm创建时候自动帮我们注册的就是app配置
    'app_mysql', #如果有新的或者命令行创建的app我们只要这这里面把app名称写上去即可
]
</pre>
</div>
</li>
<li>在database中配置数据库信息
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME':'库名',
        'USER':'mysql账号名称',
        'PASSWORD':'mysql密码',
        'HOST':'127.0.0.1',
    }
}
</pre>
</div>
</li>
</ul>
</li>
<li>__init__.py配置
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">import pymysql
pymysql.install_as_MySQLdb()
</pre>
</div>
</li>
<li>models.py配置
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from django.db import models

# Create your models here.
class test1(models.Model):
    ### 主键自增id不用写， 默认会加上
    name = models.CharField(max_length=30,null=True)

class test2(models.Model):
    name = models.CharField(max_length=30, null=True)
    bigsb = models.ForeignKey('sb',id) 


class test3(models.Model):
    name = models.CharField(max_length=30,null=True)
</pre>
</div>
</li>
<li>生成表单语句
<div class="cnblogs_Highlighter">
<pre><code>python manage.py makemigrations
python manmge.py migrate
</pre>
</div>
</li>
<li>增
<ul>
<li>单条数据
<div class="cnblogs_Highlighter">
<pre><code>方法一：models.表名.objects.create(字段1=值1,字段2=值2........)
方法二：dict = {'字段1':值,'字段2':值.........};models.表名.objects.create(**dict)
</pre>
</div>
</li>
<li>多条数据
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">info = [
     models.UserInfo(name='root1', age=34, ut_id=1),
     models.UserInfo(name='root2', age=35, ut_id=2),
     models.UserInfo(name='root3', age=36, ut_id=1),
     models.UserInfo(name='root4', age=37, ut_id=3),
     models.UserInfo(name='root5', age=32, ut_id=1),
]
models.UserInfo.objects.bulk_create(info)
</pre>
</div>
</li>
</ul>
</li>
<li>删
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">models.表名.objects.filter(满足的条件).delete()
</pre>
</div>
</li>
<li>改
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">models.表名.objects.filter(满足的条件).update(name='lll', age=23)
</pre>
</div>
</li>
<li>查
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">models.UserType.objects.all().values()
</pre>
</div>
</li>
</ul>
<p>有子键关系的查询：</p>
<ul>
<li>正向：
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># 方法1
models.A.objects.all().values('ud__id')
# 方法2
res = models.A.objects.all()
for a in res:
    print(a.ud.id)
</pre>
</div>
</li>
<li>反向：
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># 方法1
models.B.objects.all().values('A__id')
# 方法2
res = models.B.objects.all()
for b in res:
    print(b.a_set.id) #### 表名小写_set
</pre>
</div>
</li>
</ul>
<p>高级查询：</p>
<ul>
<li>字段名过滤
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">'''
filter满足条件的
exclude不满足条件
'''
#id等于3的
models.表名.objects.filter(id=3).values()
#id不等于3的
models.表名.objects.exclude(id=3).values()

'''
关于filter与exclude里面填写的参数
    等于:字段名=值
    大于:字段名__gt=值
    大于等于:字段名__gte=值
    小于:字段名__lt=值
    小于等于:字段名__lte=值
'''
</pre>
</div>
</li>
<li>成员 in not in
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">res = models.表名.objects.filter(字段名__in=[2,4,5]) # where id in (2,4,5)
res = models.表名.objects.exclude(字段名__in=[1,2]) # where id not in (1,2)
</pre>
</div>
</li>
<li>区间 between...and
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># where id between 4 and 8   [4,8]
res = models.表名.objects.filter(字段名__range=[4,8])
</pre>
</div>
</li>
<li>模糊查询 like
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># where name like 'a%'
res = models.表名.objects.filter(字段名__startswith="a")
res = models.表名.objects.filter(字段名__istartswith="a") #忽略大小写

# where name like '%a'
res = models.表名.objects.filter(字段名__endswith="a")
res = models.表名.objects.filter(字段名__iendswith="a") #忽略大小写

# where name like '%a%'
res = models.表名.objects.filter(字段名__contains="a")
res = models.表名.objects.filter(字段名__icontains="a") #忽略大小写
</pre>
</div>
</li>
<li>数据条数 count
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># select count(*) from userinfo where id&gt;3;
# select count(id) from userinfo where id&gt;3;
#用sql语句查询数据条数尽量不要查count(*)查主键会快很多
res = models.UserInfo.objects.filter(id__gt=3).count()
</pre>
</div>
</li>
<li>排序 order by
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">#升序
res = models.表名.objects.order_by('字段名称')

#降序
res = models.表名.objects.order_by('-字段名称')

#多个条件进行排序
res = models.表名.objects.order_by('字段1','字段2') #当字段1相同是会更具字段2进行排序
</pre>
</div>
</li>
<li>分组 group by
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># select id, sum(age) as s, username from userinfo group by username
from django.db.models import Count, Min, Max, Sum
res = models.UserInfo.objects.values("name").annotate(s=Sum('age'))

# select id, sum(age) as s, username from userinfo group by username having s &gt; 50;
res = models.UserInfo.objects.values("name").annotate(s=Sum('age')).filter(s__gt=50)
</pre>
</div>
</li>
<li>分页 limit
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># limit 1, 3 分页
res = models.UserInfo.objects.all()[1:4]
#因为获取对象是列表所有切片即可
</pre>
</div>
</li>
<li>last/first
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># 第一条:
res = models.表名.objects.first()
# 最后一条:
res = models.表名.objects.last()
</pre>
</div>
</li>
<li>only/defer
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">'''
只查某个字段:only('字段名称')

除某个字段以外的所有字段:defer('字段名')

注意:主键id不管怎么样都会查
'''
</pre>
</div>
</li>
<li>and/or
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;"># 只有and
#id等于3and名字等于a
models.表名.objects.filter(id=3,and name='a').values()
# 只有or
# Q
from django.db.models import Q
res = models.UserInfo.objects.filter(Q(id__gt=3) | Q(name='zekai')) #or用|链接
# 有and和or
# Q
from django.db.models import Q
res = models.UserInfo.objects.filter( Q(Q(id__gt=3) | Q(name='zekai')) &amp; Q(age=23) ) and用&amp;链接
</pre>
</div>
</li>
<li>F
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from django.db.models import F
models.UserInfo.objects.update(name=F('name')+1) #字段名称都加1
</pre>
</div>
</li>
<li>原生SQL 类似pycharm
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">from django.db import connection, connections
cursor = connection.cursor()  # cursor = connections['default'].cursor()
cursor.execute("""SELECT * from auth_user where id = %s""", [1])
row = cursor.fetchone()
print(row)
</pre>
</div>
</li>
<li>去重 distinct
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">models.UserInfo.objects.values("name", 'age').distinct() #前面values有多少个就对多少个值进行去除
</pre>
</div>
</li>
</ul>
<p>【注】</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">print(res.query) 查看上述代码生成的sql语句
</pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修用python写一个简单的文件上传' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>用python写一个简单的文件上传</center></div><div class='banquan'>原文出处:本文由博客园博主我是渣渣聪提供。<br/>
原文连接:https://www.cnblogs.com/missdx/p/11232771.html</div><br>
    <p>　　用Pycharm创建一个django项目。目录如下：</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/用python写一个简单的文件上传0.png" alt="" /></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('070171a7-5017-4cea-b680-53284501fd25')"><img id="code_img_closed_070171a7-5017-4cea-b680-53284501fd25" class="code_img_closed" src="./images/用python写一个简单的文件上传1.png" alt="" /><img id="code_img_opened_070171a7-5017-4cea-b680-53284501fd25" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('070171a7-5017-4cea-b680-53284501fd25',event)" src="./images/用python写一个简单的文件上传2.png" alt="" />
<div id="cnblogs_code_open_070171a7-5017-4cea-b680-53284501fd25" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> &lt;!DOCTYPE html&gt;
<span style="color: #008080;"> 2</span> &lt;html lang=<span style="color: #800000;">"</span><span style="color: #800000;">en</span><span style="color: #800000;">"</span>&gt;
<span style="color: #008080;"> 3</span> &lt;head&gt;
<span style="color: #008080;"> 4</span>     &lt;meta charset=<span style="color: #800000;">"</span><span style="color: #800000;">UTF-8</span><span style="color: #800000;">"</span>&gt;
<span style="color: #008080;"> 5</span>     &lt;title&gt;upload&lt;/title&gt;
<span style="color: #008080;"> 6</span> &lt;/head&gt;
<span style="color: #008080;"> 7</span> &lt;body&gt;
<span style="color: #008080;"> 8</span> {<span style="color: #008000;">#</span><span style="color: #008000;"> 上传文件的form表单必须要加上enctype="multipart/form-data" #}</span>
<span style="color: #008080;"> 9</span> &lt;form action=<span style="color: #800000;">"</span><span style="color: #800000;">/upload/</span><span style="color: #800000;">"</span> method=<span style="color: #800000;">"</span><span style="color: #800000;">post</span><span style="color: #800000;">"</span> enctype=<span style="color: #800000;">"</span><span style="color: #800000;">multipart/form-data</span><span style="color: #800000;">"</span>&gt;
<span style="color: #008080;">10</span>     &lt;input type=<span style="color: #800000;">"</span><span style="color: #800000;">file</span><span style="color: #800000;">"</span> name=<span style="color: #800000;">"</span><span style="color: #800000;">upload_files</span><span style="color: #800000;">"</span>&gt;
<span style="color: #008080;">11</span>     &lt;input type=<span style="color: #800000;">"</span><span style="color: #800000;">submit</span><span style="color: #800000;">"</span> value=<span style="color: #800000;">"</span><span style="color: #800000;">提交</span><span style="color: #800000;">"</span>&gt;
<span style="color: #008080;">12</span> &lt;/form&gt;
<span style="color: #008080;">13</span> &lt;/body&gt;
<span style="color: #008080;">14</span> &lt;/html&gt;</pre>
</div>
<span class="cnblogs_code_collapse">uploadFiles.html</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('c954defe-db22-4d8f-bfb5-bf8b590d55dd')"><img id="code_img_closed_c954defe-db22-4d8f-bfb5-bf8b590d55dd" class="code_img_closed" src="./images/用python写一个简单的文件上传1.png" alt="" /><img id="code_img_opened_c954defe-db22-4d8f-bfb5-bf8b590d55dd" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('c954defe-db22-4d8f-bfb5-bf8b590d55dd',event)" src="./images/用python写一个简单的文件上传2.png" alt="" />
<div id="cnblogs_code_open_c954defe-db22-4d8f-bfb5-bf8b590d55dd" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">from</span> django.shortcuts <span style="color: #0000ff;">import</span><span style="color: #000000;"> render,HttpResponse
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #008000;">#</span><span style="color: #008000;"> Create your views here.</span>
<span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span> <span style="color: #008000;">#</span><span style="color: #008000;"> CBV方式（class base views）</span>
<span style="color: #008080;"> 6</span> <span style="color: #0000ff;">from</span> django.views <span style="color: #0000ff;">import</span><span style="color: #000000;"> View
</span><span style="color: #008080;"> 7</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Upload(View):
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">def</span><span style="color: #000000;"> post(self,request):
</span><span style="color: #008080;"> 9</span>         <span style="color: #800000;">'''</span>
<span style="color: #008080;">10</span> <span style="color: #800000;">        保存上传文件前，数据需要存放在某个位置。默认当上传文件小于2.5M时，django会将上传文件的全部内容读进内存。从内存读取一次，写磁盘一次。
</span><span style="color: #008080;">11</span> <span style="color: #800000;">        但当上传文件很大时，django会把上传文件写到临时文件中，然后存放到系统临时文件夹中。
</span><span style="color: #008080;">12</span> <span style="color: #800000;">        :param request:
</span><span style="color: #008080;">13</span> <span style="color: #800000;">        :return:
</span><span style="color: #008080;">14</span>         <span style="color: #800000;">'''</span>
<span style="color: #008080;">15</span>         <span style="color: #008000;">#</span><span style="color: #008000;"> 从请求的FILES中获取上传文件的文件名，file为页面上type=files类型input的name属性值</span>
<span style="color: #008080;">16</span>         filename = request.FILES[<span style="color: #800000;">'</span><span style="color: #800000;">upload_files</span><span style="color: #800000;">'</span><span style="color: #000000;">].name
</span><span style="color: #008080;">17</span>         <span style="color: #008000;">#</span><span style="color: #008000;"> 在项目目录下新建一个文件</span>
<span style="color: #008080;">18</span>         with open(filename,<span style="color: #800000;">'</span><span style="color: #800000;">wb</span><span style="color: #800000;">'</span><span style="color: #000000;">) as f:
</span><span style="color: #008080;">19</span>             <span style="color: #008000;">#</span><span style="color: #008000;"> 从上传的文件对象中一点一点读</span>
<span style="color: #008080;">20</span>             <span style="color: #0000ff;">for</span> chunk <span style="color: #0000ff;">in</span> request.FILES[<span style="color: #800000;">'</span><span style="color: #800000;">upload_files</span><span style="color: #800000;">'</span><span style="color: #000000;">].chunks():
</span><span style="color: #008080;">21</span>                 <span style="color: #008000;">#</span><span style="color: #008000;"> 写入本地文件</span>
<span style="color: #008080;">22</span> <span style="color: #000000;">                f.write(chunk)
</span><span style="color: #008080;">23</span>         <span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">上传ok</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">24</span> 
<span style="color: #008080;">25</span>     <span style="color: #0000ff;">def</span><span style="color: #000000;"> get(self,request):
</span><span style="color: #008080;">26</span>         <span style="color: #0000ff;">return</span> render(request, <span style="color: #800000;">'</span><span style="color: #800000;">uploadFiles.html</span><span style="color: #800000;">'</span>)</pre>
</div>
<span class="cnblogs_code_collapse">views.py</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('c20ad310-3c25-4878-a964-9bd2926d0b56')"><img id="code_img_closed_c20ad310-3c25-4878-a964-9bd2926d0b56" class="code_img_closed" src="./images/用python写一个简单的文件上传1.png" alt="" /><img id="code_img_opened_c20ad310-3c25-4878-a964-9bd2926d0b56" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('c20ad310-3c25-4878-a964-9bd2926d0b56',event)" src="./images/用python写一个简单的文件上传2.png" alt="" />
<div id="cnblogs_code_open_c20ad310-3c25-4878-a964-9bd2926d0b56" class="cnblogs_code_hide">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #800000;">"""</span><span style="color: #800000;">day67 URL Configuration
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span> <span style="color: #800000;">The `urlpatterns` list routes URLs to views. For more information please see:
</span><span style="color: #008080;"> 4</span> <span style="color: #800000;">    https://docs.djangoproject.com/en/2.2/topics/http/urls/
</span><span style="color: #008080;"> 5</span> <span style="color: #800000;">Examples:
</span><span style="color: #008080;"> 6</span> <span style="color: #800000;">Function views
</span><span style="color: #008080;"> 7</span> <span style="color: #800000;">    1. Add an import:  from my_app import views
</span><span style="color: #008080;"> 8</span> <span style="color: #800000;">    2. Add a URL to urlpatterns:  path('', views.home, name='home')
</span><span style="color: #008080;"> 9</span> <span style="color: #800000;">Class-based views
</span><span style="color: #008080;">10</span> <span style="color: #800000;">    1. Add an import:  from other_app.views import Home
</span><span style="color: #008080;">11</span> <span style="color: #800000;">    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
</span><span style="color: #008080;">12</span> <span style="color: #800000;">Including another URLconf
</span><span style="color: #008080;">13</span> <span style="color: #800000;">    1. Import the include() function: from django.urls import include, path
</span><span style="color: #008080;">14</span> <span style="color: #800000;">    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
</span><span style="color: #008080;">15</span> <span style="color: #800000;">"""</span>
<span style="color: #008080;">16</span> <span style="color: #0000ff;">from</span> django.contrib <span style="color: #0000ff;">import</span><span style="color: #000000;"> admin
</span><span style="color: #008080;">17</span> <span style="color: #0000ff;">from</span> django.urls <span style="color: #0000ff;">import</span><span style="color: #000000;"> path
</span><span style="color: #008080;">18</span> <span style="color: #0000ff;">from</span> app01 <span style="color: #0000ff;">import</span><span style="color: #000000;"> views
</span><span style="color: #008080;">19</span> 
<span style="color: #008080;">20</span> urlpatterns =<span style="color: #000000;"> [
</span><span style="color: #008080;">21</span>     path(<span style="color: #800000;">'</span><span style="color: #800000;">upload/</span><span style="color: #800000;">'</span><span style="color: #000000;">,views.Upload.as_view() ),
</span><span style="color: #008080;">22</span> ]</pre>
</div>
<span class="cnblogs_code_collapse">urls.py</span></div>
<p>　　注意settings.py中的这一行要注释掉</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800000;">'</span><span style="color: #800000;">django.middleware.csrf.CsrfViewMiddleware</span><span style="color: #800000;">'</span>,</pre>
</div>
<p>　　点击运行，文件会上传到项目的根目录下面。</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
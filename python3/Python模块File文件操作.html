<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python模块File文件操作' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python模块File文件操作</center></div><div class='banquan'>原文出处:本文由博客园博主清水-殇提供。<br/>
原文连接:https://www.cnblogs.com/guohongwei/p/11792222.html</div><br>
    <h2 id="title-0">Python模块File简介</h2>
<p>Python提供了File模块进行文件的操作，他是Python的内置模块。我们在使用File模块的时候，必须先用Popen()函数打开一个文件，在使用结束需要close关闭文件。</p>
<h2 id="title-1">常用函数</h2>
<table class="reference">
<tbody>
<tr style="background-color: #24abda;"><th style="width: 10%;">
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">序号</span></p>
</th><th style="width: 15%;">
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">方法</span></p>
</th><th>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">描述</span></p>
</th></tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">1</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.close()</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">关闭文件。关闭后文件不能再进行读写操作。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">2</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.flush()</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">刷新文件内部缓冲，直接把内部缓冲区的数据立刻写入文件, 而不是被动的等待输出缓冲区写入。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">3</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.fileno()</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">返回一个整型的文件描述符(file descriptor FD 整型), 可以用在如os模块的read方法等一些底层操作上。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">4</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.isatty()</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">如果文件连接到一个终端设备返回 True，否则返回 False。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">5</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.next()</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">返回文件下一行。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">6</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.read([size])</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">从文件读取指定的字节数，如果未给定或为负则读取所有。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">7</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.readline([size])</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">读取整行，包括 &ldquo;\n&rdquo; 字符。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">8</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.readlines([sizehint])</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">读取所有行并返回列表，若给定sizeint&gt;0，返回总和大约为sizeint字节的行, 实际读取值可能比sizhint较大, 因为需要填充缓冲区。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">9</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.seek(offset[, whence])</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">设置文件当前位置</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">10</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.tell()</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">返回文件当前位置。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">11</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.truncate([size])</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">截取文件，截取的字节通过size指定，默认为当前文件位置。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">12</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.write(str)</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">将字符串写入文件，没有返回值。</span></p>
</td>
</tr>
<tr style="background-color: #7cce30;">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">13</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">file.writelines(sequence)</span></p>
</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">向文件写入一个序列字符串列表，如果需要换行则要自己加入每行的换行符。</span></p>
</td>
</tr>
</tbody>
</table>
<h2 id="title-2">File模块使用实例</h2>
<h3>1.打开和关闭文件</h3>
<ul>
<li>open()</li>
<li>close()</li>
</ul>
<p>有两种内建函数可以获取文件对象：open和file。他们的用法完全一样。下面只以open()为例子讲解。获取一个文件对象（打开文件）的语法如下：</p>
<p>&nbsp;<span class="cnblogs_code"><span style="color: #008080;">1</span> fileObj = open(filename,access_mode=<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span>,buffering=-1)</span>&nbsp;</p>
<p>&nbsp;filename不用说你也应该知道是你要打开文件的路径。<br />
access_mode用来标识文件打开的模式，默认为r(只读)。<br />
常用的模式如下表所示：</p>
<p>&nbsp;</p>
<table class="reference">
<tbody>
<tr style="background-color: #619a9e;" align="center" valign="middle"><th style="width: 10%;">
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">文件模式</span></p>

</th><th>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">解释</span></p>

</th></tr>
<tr style="background-color: #619a9e;" align="center" valign="middle">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">r</span></p>

</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">以只读方式打开</span></p>

</td>

</tr>
<tr style="background-color: #619a9e;" align="center" valign="middle">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">w</span></p>

</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">以写方式打开，文件不为空时清空文件;文件不存在时新建文件。</span></p>

</td>

</tr>
<tr style="background-color: #619a9e;" align="center" valign="middle">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">a</span></p>

</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">追加模式，没有则创建</span></p>

</td>

</tr>
<tr style="background-color: #619a9e;" align="center" valign="middle">
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">r+,w+,a+</span></p>

</td>
<td>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">以读写模式打开，参见w,a 另外还有一个b表示二进制模式访问，但是对于Linux或者unix系统来说这个模式没有任何意义，因为他们把所有文件都看作二进制文件，包括文本文件。</span></p>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">
第三个参数不经常用到，标识访问文件的缓冲方式，0代表不缓冲，1代表缓</span></p>
<p><span style="font-family: Microsoft YaHei; font-size: 12px;">
冲一行，-1代表使用系统默认缓冲方式。只要使用系统默认就好。</span></p>

</td>


</tr>


</tbody>

</table>
<p>一些例子：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> f = open(<span style="color: #800000;">'</span><span style="color: #800000;">/etc/passwd</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">2</span> f1 = open(<span style="color: #800000;">'</span><span style="color: #800000;">/etc/test</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span>)</pre>
</div>
<div id="crayon-5dbfceb4e4732624246273" class="crayon-syntax crayon-theme-sublime-text crayon-font-consolas crayon-os-pc print-yes notranslate" style="margin: 12px; font-size: 12px !important; line-height: 20px !important; height: auto;" data-settings=" minimize scroll-mouseover">
<p class="crayon-plain-wrap"><span style="font-size: 14px;">使用完文件后，一定要记得关闭文件，操作如下：</span></p>
</div>
<p>&nbsp;<span class="cnblogs_code"><span style="color: #008080;">1</span> f.close()</span>&nbsp;</p>
<h3>2.文件读取</h3>
<p><strong>file.read(size = -1)</strong></p>
<p>读取从当前文件游标起size个字节的文件内容。如果size=-1，则读取所有剩余字节。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> &gt;&gt;&gt; f = open(<span style="color: #800000;">'</span><span style="color: #800000;">/etc/passwd</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">2</span> &gt;&gt;&gt; f.read(100<span style="color: #000000;">)
</span><span style="color: #008080;">3</span> <span style="color: #800000;">'</span><span style="color: #800000;">root:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nol</span><span style="color: #800000;">'</span></pre>
</div>
<p><strong>file.readlines(size=-1)</strong></p>
<p>从文件中读取并返回一行（包括行结束符），或返回最大size个字符</p>
<p>&nbsp;<span class="cnblogs_code"><span style="color: #008080;">1</span>&gt;&gt;&gt; f.readline()</span>&nbsp;</p>
<p>&lsquo;ogin\n&rsquo;#和上面一个例子输出的最后拼起来就是 &lsquo;nologin&rsquo;，因为游标在l后面。</p>
<p>&nbsp;<span class="cnblogs_code"><span style="color: #008080;">1</span> &gt;&gt;&gt; f.readline(1<span style="color: #000000;">) </span></span></p>
<p><span class="cnblogs_code"><span style="color: #008080;">2</span> <span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span></span>&nbsp;</p>
<p><strong>file.readlines(sizhint=0)</strong></p>
<p>读取文件所有的行，并作为一个列表返回（包括行结束符），如果sizhint&gt;0则返回总和大约sizhint字节的行（具体由缓冲区大小决定）。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> <span style="color: #000000;">f.readlines()
</span><span style="color: #008080;">2</span> [<span style="color: #800000;">'</span><span style="color: #800000;">dm:x:3:4:adm:/var/adm:/sbin/nologin\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">sync:x:5:0:sync:/sbin:/bin/sync\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">halt:x:7:0:halt:/sbin:/sbin/halt\n</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin\n</span><span style="color: #800000;">'</span>, ......</pre>
</div>
<p>输出省略。</p>
<h3>3.文件写入</h3>
<p><strong>file.write(str)</strong></p>
<p>向文件中写入指定的字符串。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> &gt;&gt;&gt; f = file(<span style="color: #800000;">'</span><span style="color: #800000;">/root/test.py</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">w+</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">2</span> &gt;&gt;&gt; f.write(<span style="color: #800000;">"</span><span style="color: #800000;">print 'hello,world'</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">3</span> &gt;&gt;&gt;<span style="color: #000000;"> f.read()
</span><span style="color: #008080;">4</span> <span style="color: #800000;">''</span>
<span style="color: #008080;">5</span> &gt;&gt;&gt;<span style="color: #000000;"> f.close()
</span><span style="color: #008080;">6</span> &gt;&gt;&gt; file(<span style="color: #800000;">'</span><span style="color: #800000;">/root/test.py</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">).read()
</span><span style="color: #008080;">7</span> <span style="color: #800000;">"</span><span style="color: #800000;">print 'hello,world'</span><span style="color: #800000;">"</span></pre>
</div>
<p><strong>file.write(seq)</strong></p>
<p>向文件写入字符串序列seq。seq是任何返回字符串的可迭代对象。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">1</span> &gt;&gt;&gt; f = file(<span style="color: #800000;">'</span><span style="color: #800000;">/root/test.py</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">a+</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;">2</span> &gt;&gt;&gt; codelst = [<span style="color: #800000;">'</span><span style="color: #800000;">\n</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">import os\n</span><span style="color: #800000;">'</span>,<span style="color: #800000;">"</span><span style="color: #800000;">os.popen('ls').read()\n</span><span style="color: #800000;">"</span><span style="color: #000000;">]
</span><span style="color: #008080;">3</span> &gt;&gt;&gt;<span style="color: #000000;"> f.writelines(codelst)
</span><span style="color: #008080;">4</span> &gt;&gt;&gt;<span style="color: #000000;"> f.close()
</span><span style="color: #008080;">5</span> &gt;&gt;&gt; file(<span style="color: #800000;">'</span><span style="color: #800000;">/root/test.py</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">).read()
</span><span style="color: #008080;">6</span> <span style="color: #800000;">"</span><span style="color: #800000;">print 'hello,world'\nimport os\nos.popen('ls').read()\n</span><span style="color: #800000;">"</span></pre>
</div>
<p>注意，文件写入的时候，不会自动加上换行符，必须手动加上。</p>
<h3>4.文件移动</h3>
<p>学过C语言的同学，一定对fseek()函数不陌生，在Python中，seek()方法是fseek()的替代者。</p>
<p>seek(offset,whence=0)</p>
<p>方法可以将文件游标移动到文件的任意位置。其中offset代表需要移动的偏移字节数，whence表示要从哪个位置开始偏移：</p>
<p>0代表从文件开头开始算起，</p>
<p>1代表从当前位置开始算起，</p>
<p>2代表从文件末尾算起。</p>
<p>那我们如何知道当前文件游标在哪里呢？别担心，这里有个tell()方法可以返回当前文件游标的位置。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> &gt;&gt;&gt; f = file(<span style="color: #800000;">'</span><span style="color: #800000;">test.py</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 2</span> &gt;&gt;&gt; f.tell() <span style="color: #008000;">#</span><span style="color: #008000;">文件开头</span>
<span style="color: #008080;"> 3</span> <span style="color: #000000;">0
</span><span style="color: #008080;"> 4</span> &gt;&gt;&gt; f.seek(5)<span style="color: #008000;">#</span><span style="color: #008000;">从默认的文件头开始移动5个字节</span>
<span style="color: #008080;"> 5</span> &gt;&gt;&gt;<span style="color: #000000;"> f.tell()
</span><span style="color: #008080;"> 6</span> 5
<span style="color: #008080;"> 7</span> &gt;&gt;&gt; f.seek(5,1)<span style="color: #008000;">#</span><span style="color: #008000;">从当前游标处移动5个字节</span>
<span style="color: #008080;"> 8</span> &gt;&gt;&gt;<span style="color: #000000;"> f.tell()
</span><span style="color: #008080;"> 9</span> 10
<span style="color: #008080;">10</span> &gt;&gt;&gt; f.seek(1,2<span style="color: #000000;">)
</span><span style="color: #008080;">11</span> &gt;&gt;&gt;<span style="color: #000000;"> f.tell()
</span><span style="color: #008080;">12</span> 52</pre>
</div>
<h3>5.文件迭代</h3>
<p>在Python中，文件不仅仅是一个对象，而且是一个可迭代对象！我们可以利用如下迭代方式，轻松的访问和处理文件内容，而不必全部读出（readlines）后再迭代（性能上差了很多哦！）</p>
<p>&nbsp;<span class="cnblogs_code"><span style="color: #008080;">1</span> &gt;&gt;&gt; <span style="color: #0000ff;">for</span> eachline <span style="color: #0000ff;">in</span><span style="color: #000000;"> file: </span><span style="color: #008080;">2</span> ... <span style="color: #0000ff;">print</span>(eachline)</span> </p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
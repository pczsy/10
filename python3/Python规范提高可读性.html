<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python规范提高可读性' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python规范提高可读性</center></div><div class='banquan'>原文出处:本文由博客园博主秋官提供。<br/>
原文连接:https://www.cnblogs.com/xiaoguanqiu/p/11285511.html</div><br>
    <h3>PEP 8 规范</h3>
<p>　　PEP 是 Python Enhancement Proposal 的缩写，翻译过来叫&ldquo;Python 增强规范&rdquo;。</p>
<h4>缩进规范</h4>
<p>　　PEP 8 规范告诉我们，请选择四个空格的缩进，不要使用 Tab，更不要 Tab 和空格混着用。 第二个要注意的是，每行最大长度请限制在 79 个字符。</p>
<h4>空行规范</h4>
<p>　　PEP 8 规定，全局的类和函数的上方需要空两个空行，而类的函数之间需要空一个空行。</p>
<h4>空格规范</h4>
<ol>
<li>函数的参数列表中，调用函数的参数列表中会出现逗号，请注意逗号后要跟一个空格，这是英语的使用习惯，也能让每个参数独立阅读，更清晰。</li>
<li>冒号后面也要跟一个空格。</li>
<li>在#后、注释前加一个空格。</li>
<li>操作符，例如+，-，*，/，&amp;，|，=，==，!=，请在两边都保留空格。不过与此对应，括号内的两端并不需要空格。</li>
</ol>
<h4>换行规范</h4>
<p>　　控制每行的最大长度不超过 79 个字符，但是有时候，函数调用逻辑过长而不得不超过这个数字时按以下规范:</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> solve1(this_is_the_first_parameter, this_is_the_second_parameter, this_is_the_third_parameter,
           this_is_the_forth_parameter, this_is_the_fifth_parameter, this_is_the_sixth_parameter):
    </span><span style="color: #0000ff;">return</span> (this_is_the_first_parameter + this_is_the_second_parameter + this_is_the_third_parameter +<span style="color: #000000;">
            this_is_the_forth_parameter </span>+ this_is_the_fifth_parameter +<span style="color: #000000;"> this_is_the_sixth_parameter)


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> solve2(this_is_the_first_parameter, this_is_the_second_parameter, this_is_the_third_parameter,
           this_is_the_forth_parameter, this_is_the_fifth_parameter, this_is_the_sixth_parameter):
    </span><span style="color: #0000ff;">return</span> this_is_the_first_parameter + this_is_the_second_parameter + this_is_the_third_parameter +<span style="color: #000000;"> \
           this_is_the_forth_parameter </span>+ this_is_the_fifth_parameter +<span style="color: #000000;"> this_is_the_sixth_parameter


(top_secret_func(param1</span>=12345678, param2=12345678, param3=12345678, param4=12345678, param5=12345678<span style="color: #000000;">).check()
    .launch_nuclear_missile().wait())


top_secret_func(param1</span>=12345678, param2=12345678, param3=12345678, param4=12345678, param5=12345678<span style="color: #000000;">).check() \
    .launch_nuclear_missile().wait()</span></pre>
</div>
<p>　　1.通过括号来将过长的运算进行封装.</p>
<p>　　2.通过换行符来实现.</p>
<h4>文档规范</h4>
<ol>
<li>import 尽量放在开头.</li>
<li>不要使用 import 一次导入多个模块.</li>
<li>from module import func 这样的语句，请确保 func 在本文件中不会出现命名冲突。或者通过 from module import func as new_func 来进行重命名，从而避免冲突。</li>
</ol>
<h4>注释规范</h4>
<p>　　行注释并不是很推荐的方式。</p>
<h4>文档描述</h4>
<p>　　docstring 的写法，它是用三个双引号开始、三个双引号结尾。我们首先用一句话简单说明这个函数做什么，然后跟一段话来详细解释；再往后是参数列表、参数格式、返回值格式。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">class</span><span style="color: #000000;"> SpatialDropout2D(Dropout):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">Spatial 2D version of Dropout.
    This version performs the same function as Dropout, however it drops
    entire 2D feature maps instead of individual elements. If adjacent pixels
    within feature maps are strongly correlated (as is normally the case in
    early convolution layers) then regular dropout will not regularize the
    activations and will otherwise just result in an effective learning rate
    decrease. In this case, SpatialDropout2D will help promote independence
    between feature maps and should be used instead.
    Arguments:
        rate: float between 0 and 1. Fraction of the input units to drop.
        data_format: 'channels_first' or 'channels_last'.
            In 'channels_first' mode, the channels dimension
            (the depth) is at index 1,
            in 'channels_last' mode is it at index 3.
            It defaults to the `image_data_format` value found in your
            Keras config file at `~/.keras/keras.json`.
            If you never set it, then it will be "channels_last".
    Input shape:
        4D tensor with shape:
        `(samples, channels, rows, cols)` if data_format='channels_first'
        or 4D tensor with shape:
        `(samples, rows, cols, channels)` if data_format='channels_last'.
    Output shape:
        Same as input
    References:
        - [Efficient Object Localization Using Convolutional
          Networks](https://arxiv.org/abs/1411.4280)
  </span><span style="color: #800000;">"""</span>
    <span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span>(self, rate, data_format=None, **<span style="color: #000000;">kwargs):
        super(SpatialDropout2D, self).</span><span style="color: #800080;">__init__</span>(rate, **<span style="color: #000000;">kwargs)
        </span><span style="color: #0000ff;">if</span> data_format <span style="color: #0000ff;">is</span><span style="color: #000000;"> None:
            data_format </span>=<span style="color: #000000;"> K.image_data_format()
        </span><span style="color: #0000ff;">if</span> data_format <span style="color: #0000ff;">not</span> <span style="color: #0000ff;">in</span> {<span style="color: #800000;">'</span><span style="color: #800000;">channels_last</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">channels_first</span><span style="color: #800000;">'</span><span style="color: #000000;">}:
            </span><span style="color: #0000ff;">raise</span> ValueError(<span style="color: #800000;">'</span><span style="color: #800000;">data_format must be in </span><span style="color: #800000;">'</span>
                           <span style="color: #800000;">'</span><span style="color: #800000;">{"channels_last", "channels_first"}</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        self.data_format </span>=<span style="color: #000000;"> data_format
        self.input_spec </span>= InputSpec(ndim=4)</pre>
</div>
<h4>命名规范</h4>
<ol>
<li>变量使用小写，通过下划线串联起来，例如：data_format、input_spec、image_data_set。唯一可以使用单字符的地方是迭代，比如 for i in range(n) 这种，为了精简可以使用。如果是类的私有变量，请记得前面增加两个下划线。</li>
<li>常量，最好的做法是全部大写，并通过下划线连接，例如：WAIT_TIME、SERVER_ADDRESS、PORT_NUMBER。</li>
<li>函数名，同样也请使用小写的方式，通过下划线连接起来，例如：launch_nuclear_missile()、check_input_validation()。</li>
<li>类名，则应该首字母大写，然后合并起来，例如：class SpatialDropout2D()、class FeatureSet()。</li>
</ol>
<h3>代码分解技巧</h3>
<p>　　不写重复代码。</p>
<p>　　如：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">if</span><span style="color: #000000;"> i_am_rich:
    money </span>= 100<span style="color: #000000;">
    send(money)
</span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
    money </span>= 10<span style="color: #000000;">
    send(money)</span></pre>
</div>
<p>　　都有send函数，可改为:</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">if</span><span style="color: #000000;"> i_am_rich:
    money </span>= 100
<span style="color: #0000ff;">else</span><span style="color: #000000;">:
    money </span>= 10<span style="color: #000000;">
send(money)</span></pre>
</div>
<p>　　代码嵌套过深:</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> send(money):
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> is_server_dead:
        LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">server dead</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span>
    <span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> is_server_timed_out:
            LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">server timed out</span><span style="color: #800000;">'</span><span style="color: #000000;">)
            </span><span style="color: #0000ff;">return</span>
        <span style="color: #0000ff;">else</span><span style="color: #000000;">:
            result </span>=<span style="color: #000000;"> get_result_from_server()
            </span><span style="color: #0000ff;">if</span> result ==<span style="color: #000000;"> MONEY_IS_NOT_ENOUGH:
                LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">you do not have enough money</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                </span><span style="color: #0000ff;">return</span>
            <span style="color: #0000ff;">else</span><span style="color: #000000;">:
                </span><span style="color: #0000ff;">if</span> result ==<span style="color: #000000;"> TRANSACTION_SUCCEED:
                    LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">OK</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                    </span><span style="color: #0000ff;">return</span>
                <span style="color: #0000ff;">else</span><span style="color: #000000;">:
                    LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">something wrong</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                    </span><span style="color: #0000ff;">return</span></pre>
</div>
<p>　　可改为:</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> send(money):
    </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> is_server_dead:
        LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">server dead</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span>

    <span style="color: #0000ff;">if</span><span style="color: #000000;"> is_server_timed_out:
        LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">server timed out</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">

    result </span>=<span style="color: #000000;"> get_result_from_server()

    </span><span style="color: #0000ff;">if</span> result ==<span style="color: #000000;"> MONET_IS_NOT_ENOUGH:
        LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">you do not have enough money</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span>

    <span style="color: #0000ff;">if</span> result ==<span style="color: #000000;"> TRANSACTION_SUCCEED:
        LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">OK</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">

    LOG(</span><span style="color: #800000;">'</span><span style="color: #800000;">something wrong</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>　　以一个简单的二分搜索来举例说明。给定一个非递减整数数组，和一个 target，要求找到数组中最小的一个数 x，可以满足 x*x &gt; target。一旦不存在，则返回 -1。</p>
<p>　　代码实现如果如下所示，那么可以再以一个函数只干一件事情的原则再优化下。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> solve(arr, target):
    l, r </span>= 0, len(arr) - 1<span style="color: #000000;">
    ret </span>= -1
    <span style="color: #0000ff;">while</span> l &lt;=<span style="color: #000000;"> r:
        m </span>= (l + r) // 2
        <span style="color: #0000ff;">if</span> arr[m] * arr[m] &gt;<span style="color: #000000;"> target:
            ret </span>=<span style="color: #000000;"> m
            r </span>= m - 1
        <span style="color: #0000ff;">else</span><span style="color: #000000;">:
            l </span>= m + 1
    <span style="color: #0000ff;">if</span> ret == -1<span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> -1
    <span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> arr[ret]


</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6], 8<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6], 9<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6<span style="color: #000000;">], 0))
</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6], 40))</pre>
</div>
<p>　　优化如下：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> comp(x, target):
    </span><span style="color: #0000ff;">return</span> x * x &gt;<span style="color: #000000;"> target


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> binary_search(arr, target):
    l, r </span>= 0, len(arr) - 1<span style="color: #000000;">
    ret </span>= -1
    <span style="color: #0000ff;">while</span> l &lt;=<span style="color: #000000;"> r:
        m </span>= (l + r) // 2
        <span style="color: #0000ff;">if</span><span style="color: #000000;"> comp(arr[m], target):
            ret </span>=<span style="color: #000000;"> m
            r </span>= m - 1
        <span style="color: #0000ff;">else</span><span style="color: #000000;">:
            l </span>= m + 1
    <span style="color: #0000ff;">return</span><span style="color: #000000;"> ret


</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> solve(arr, target):
    id </span>=<span style="color: #000000;"> binary_search(arr, target)

    </span><span style="color: #0000ff;">if</span> id != -1<span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> arr[id]
    </span><span style="color: #0000ff;">return</span> -1


<span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6], 8<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6], 9<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6<span style="color: #000000;">], 0))
</span><span style="color: #0000ff;">print</span>(solve([1, 2, 3, 4, 5, 6], 40))</pre>
</div>
<p>　　类中属性很多时可以抽出相同特性的单独作为类，如：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">class</span><span style="color: #000000;"> Person:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self, name, sex, age, job_title, job_description, company_name):
        self.name </span>=<span style="color: #000000;"> name
        self.sex </span>=<span style="color: #000000;"> sex
        self.age </span>=<span style="color: #000000;"> age
        self.job_title </span>=<span style="color: #000000;"> job_title
        self.job_description </span>=<span style="color: #000000;"> description
        self.company_name </span>= company_name</pre>
</div>
<p>　　job_title , job_description , company_name 都与工作有关，表达是同一个意义实体，就可以抽出单独作为类:</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">class</span><span style="color: #000000;"> Person:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self, name, sex, age, job_title, job_description, company_name):
        self.name </span>=<span style="color: #000000;"> name
        self.sex </span>=<span style="color: #000000;"> sex
        self.age </span>=<span style="color: #000000;"> age
        self.job </span>=<span style="color: #000000;"> Job(job_title, job_description, company_name)

</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Job:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self, job_title, job_description, company_name):
        
        self.job_title </span>=<span style="color: #000000;"> job_title
        self.job_description </span>=<span style="color: #000000;"> description
        self.company_name </span>= company_name</pre>
</div>
<h3>参考</h3>
<p>　　极客时间《Python核心技术与实战》专栏</p>
<p>&nbsp;</p>
<p style="margin: 0px; padding: 0px; color: #333333; font-family: 'PingFang SC', 'Lantinghei SC', 'Microsoft Yahei', 'Hiragino Sans GB', 'Microsoft Sans Serif', 'WenQuanYi Micro Hei', Helvetica, sans-serif; font-size: 16px;">类</p>
<p style="margin: 0px; padding: 0px; color: #333333; font-family: 'PingFang SC', 'Lantinghei SC', 'Microsoft Yahei', 'Hiragino Sans GB', 'Microsoft Sans Serif', 'WenQuanYi Micro Hei', Helvetica, sans-serif; font-size: 16px;">极客时间版权所有: https://time.geekbang.org/column/article/104689</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
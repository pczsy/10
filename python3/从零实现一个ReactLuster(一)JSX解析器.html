<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®ä»é›¶å®ç°ä¸€ä¸ªReactLuster(ä¸€)JSXè§£æå™¨' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>ä»é›¶å®ç°ä¸€ä¸ªReactLuster(ä¸€)JSXè§£æå™¨</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»dejavudwhæä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/secoding/p/12080641.html</div><br>
    <h2 id="å‰è¨€">å‰è¨€</h2>
<p>è¿™æ˜¯ä¹‹å‰åœ¨æ˜é‡‘å‘çš„ä¸¤æ¡æ²¸ç‚¹ï¼Œæ‡’å¾—å†™äº†ï¼Œç›´æ¥å¤åˆ¶è¿‡æ¥ä½œä¸ºå‰è¨€äº†ã€‚ç„¶åè¿™ä¸ªé¡¹ç›®å¯èƒ½ä¹‹åè¿˜ä¼šç»§ç»­å†™ï¼Œå¢åŠ ä¸€äº›è·¯ç”±æˆ–è€…æ¨¡æ¿å¼•æ“çš„æŒ‡ä»¤ä»€ä¹ˆçš„ï¼Œä½†æ˜¯å†è¿‡æ²¡å¤šä¹…å¯’å‡å°±æœ‰å¤§å—æ—¶é—´äº†å°±å¯èƒ½ä¸æ‘¸è¿™ä¸ªé±¼å»å¼€å…¶å®ƒå‘äº†ï¼Œéšç¼˜å§ã€‚æ‰€ä»¥å…ˆå†™JSXçš„è§£æå™¨å§ï¼Œè¿™ä¸ªéƒ¨åˆ†ä¹Ÿæ¯”è¾ƒç‹¬ç«‹</p>
<p><a href="https://juejin.im/user/5b72ded8e51d45664c23a662">æ˜é‡‘æ²¸ç‚¹</a>é‡Œæœ‰ä¸€äº›ä»£ç æˆªå›¾ï¼Œå°±ä¸å‘åœ¨markdowné‡Œ</p>
<p>ç®—æ˜¯åˆ©ç”¨æœŸæœ«è€ƒè¿™æ®µç¢ç‰‡æ—¶é—´æ‘¸ä¸€ä¸ªæ°´é¡¹ç›®å§</p>
<p>é¡¹ç›®åœ°å€ï¼š</p>
<ol>
<li><p><a href="https://github.com/dejavudwh/jsx-parser">jsx-parser</a></p></li>
<li><p><a href="https://github.com/dejavudwh/luster">luster</a></p></li>
</ol>
<h3 id="section">12.21</h3>
<p>æœ€è¿‘å¿ƒæƒ…æ¯”è¾ƒä½è½ï¼Œæ‘¸é±¼ä¹Ÿæ‘¸åˆ°ææ…Œï¼Œç„¶åæ˜¨å¤©å°±æƒ³ç€éšä¾¿å†™ç‚¹ä¸œè¥¿å§ã€‚ç„¶åå°±å…ˆé€‰äº†ç”¨JavaScriptå†™ï¼Œå°±é¡ºä¾¿æƒ³åˆ°äº†Reactã€‚æ‰€ä»¥æœ‰äº†è¿™ä¸ªå°ç ´è½®å­ï¼Œä¸€ä¸ªå‰ç«¯ç®—æ˜¯viewå±‚çš„æ¡†æ¶å§ï¼Œç®—æ˜¯ä¸€ä¸ªä¹ä¸å¼±æ™ºç‰ˆçš„Reactå§ï¼Œåªæœ‰ä¸¤ç™¾å¤šè¡Œã€‚</p>
<p>ç„¶ååˆæƒ³ç€ç«Ÿç„¶éƒ½é€ è½®å­äº†ï¼Œé‚£å¹²è„†JSXè¯­æ³•çš„è½¬è¯‘ä¹Ÿä¸ç”¨babeläº†ï¼Œæ‰€ä»¥ä»Šå¤©å°±æ‘¸äº†ä¸€ä¸ªjsxçš„è§£æå™¨ï¼Œä¹Ÿåªæœ‰ä¸¤ç™¾å¤šè¡Œ</p>
<p>ç®—æ˜¯ä¸€ä¸ªå­¦ä¹ çš„è¿‡ç¨‹å§ï¼Œè™½ç„¶ä»¥åä¹Ÿä¸æ‰“ç®—å¹²å‰ç«¯ï¼Œä¹Ÿéƒ½çœ‹çœ‹</p>
<p>åæ­£ä¹Ÿå¿«æœŸæœ«è€ƒäº†ï¼Œæ²¡å¤§å—æ—¶é—´äº†ï¼Œå°±ç»§ç»­æ‘¸è¿™ä¸ªé¡¹ç›®å§ï¼Œå¯èƒ½ä¼šå†åŠ ä¸Šstateå’Œdom diffä¹‹ç±»çš„å§ï¼Œå†åšç‚¹åˆ›æ–°ï¼Ÿ</p>
<p>ä»£ç å¾ˆæ°´ï¼‰ä¸æ˜¯å‰ç«¯ï¼‰ç©å…·è€Œå·²ï¼‰å¤§ä½¬è½»å–·ï¼‰</p>
<h3 id="section-1">12.22</h3>
<p>ç»§ä¸Šä¸€æ¡ï¼Œè¿™ä¸ªä¹ä¸ç‰ˆReactæ˜¨å¤©åˆå¢åŠ äº†setStateå’Œdom-diffç®—æ³•ã€‚æˆåŠŸçš„å®ç°äº†åŠŸèƒ½ï¼Œç„¶åæŠŠä»£ç å†™æˆäº†ä¸€å¨ğŸ’©ï¼Œä¼°è®¡è¿˜æœ‰æˆ‘è¿˜æ²¡å‘ç°çš„bugã€‚æ‰€ä»¥ä¸‹é¢å¯èƒ½ä¼šç¨å¾®é‡æ„ä¸€ä¸‹ä»£ç ï¼Œç„¶åå†™ä¸€ä¸‹è·¯ç”±å’Œæ¨¡æ¿å¼•æ“çš„æŒ‡ä»¤ï¼Ÿ</p>
<p>è¿™ä¸¤å¤©å¯èƒ½å»æ‰¾æ‰¾æœ‰æ²¡æœ‰æ›´å¥½ç©çš„å¯ä»¥å†™ï¼Œä¸è¿‡è¿™ä¸¤å¤©æœ€å¤§çš„æ”¶è·å°±æ˜¯æ¸…æ¥šçš„äº†è§£äº†å·¥æ•´çš„ä»£ç å˜æˆğŸ’©å †çš„è¿‡ç¨‹</p>
<h2 id="jsxåˆ°javascriptå¯¹è±¡">Jsxåˆ°JavaScriptå¯¹è±¡</h2>
<blockquote>
<p>å…¶å®è¿™ä¸ªJavaScriptå¯¹è±¡å°±æ˜¯è™šæ‹Ÿdomï¼Œæœ€åæˆ‘ä»¬å†æ ¹æ®è¿™ä¸ªè™šæ‹Ÿdomè¿›è¡Œæ¸²æŸ“ï¼Œåé¢çš„dom-diffä¹Ÿæ˜¯æ ¹æ®è¿™ä¸ªæ•°æ®ç»“æ„æ¥è®¡ç®—çš„ã€‚æˆ‘ä»¬è§£æå™¨çš„ç›®æ ‡å°±æ˜¯æŠŠä¸‹é¢è¿™ä¸€æ®µJSXè½¬æ¢æˆç›¸åº”çš„JavaScriptå¯¹è±¡ã€‚</p>
</blockquote>
<pre><code><code>&lt;div name=&quot;{{jsx-parse}}&quot; class=&quot;{{fuck}}&quot; id=&quot;1&quot;&gt;
    Life is too difficult
    &lt;span name=&quot;life&quot; like=&quot;rape&quot;&gt;
        &lt;p&gt;Life is like rape&lt;/p&gt;
    &lt;/span&gt; 
    &lt;div&gt;
        &lt;span name=&quot;live&quot; do=&quot;{{gofuck}}&quot;&gt;
            &lt;p&gt;Looking away, everything is sad&lt;/p&gt;
        &lt;/span&gt; 
        &lt;Counter me=&quot;excellent&quot;&gt;
            I am awesome
        &lt;/Counter&gt;
    &lt;/div&gt;  
&lt;/div&gt;</code></pre>
<pre class="json"><code>{
  &quot;type&quot;: &quot;div&quot;,
  &quot;props&quot;: {
    &quot;childrens&quot;: [
      {
        &quot;type&quot;: &quot;span&quot;,
        &quot;props&quot;: {
          &quot;childrens&quot;: [
            {
              &quot;type&quot;: &quot;p&quot;,
              &quot;props&quot;: {
                &quot;childrens&quot;: [],
                &quot;text&quot;: &quot;Life is like rape&quot;
              }
            }
          ],
          &quot;name&quot;: &quot;life&quot;,
          &quot;like&quot;: &quot;rape&quot;
        }
      },
      {
        &quot;type&quot;: &quot;div&quot;,
        &quot;props&quot;: {
          &quot;childrens&quot;: [
            {
              &quot;type&quot;: &quot;span&quot;,
              &quot;props&quot;: {
                &quot;childrens&quot;: [
                  {
                    &quot;type&quot;: &quot;p&quot;,
                    &quot;props&quot;: {
                      &quot;childrens&quot;: [],
                      &quot;text&quot;: &quot;Looking away, everything is sad&quot;
                    }
                  }
                ],
                &quot;name&quot;: &quot;live&quot;,
                &quot;do&quot;: &quot;{{gofuck}}&quot;
              }
            },
            {
              &quot;type&quot;: &quot;Counter&quot;,
              &quot;props&quot;: {
                &quot;childrens&quot;: [],
                &quot;me&quot;: &quot;excellent&quot;,
                &quot;text&quot;: &quot;I am awesome&quot;
              }
            }
          ]
        }
      }
    ],
    &quot;name&quot;: &quot;{{jsx-parse}}&quot;,
    &quot;class&quot;: &quot;{{fuck}}&quot;,
    &quot;id&quot;: &quot;1&quot;,
    &quot;text&quot;: &quot;Life is too difficult&quot;
  }
}</code></pre>
<h2 id="è¯æ³•åˆ†æ">è¯æ³•åˆ†æ</h2>
<blockquote>
<p>å…¶å®è¿™ä¸ªè§£æå™¨ä¸€å…±ä¹Ÿå°±æ˜¯240å¤šè¡Œï¼Œå°±åªè¦ç®€å•è¯æ³•åˆ†æï¼Œç„¶åç›´æ¥é€’å½’ä¸‹é™ç”Ÿæˆäº†</p>
</blockquote>
<p>å¦‚æœç®€å•çš„åŒºåˆ†ï¼ŒJsxé‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¯´æˆhtmlå§ã€‚å°±æ˜¯å°±åªæœ‰ä¸¤ç§tokenï¼Œå¼€å§‹æ ‡ç­¾ã€ç»“æŸæ ‡ç­¾å’Œæ–‡æœ¬ï¼Œç„¶åå¼€å§‹æ ‡ç­¾é‡Œé¢æœ‰å„ç§å±æ€§ã€‚</p>
<pre class="js"><code>let token = {
    startTag: &#39;startTag&#39;,
    endTag: &#39;endTag&#39;,
    text: &#39;text&#39;,
    eof: &#39;eof&#39;
}</code></pre>
<p>è¯æ³•åˆ†æçš„ä¸»ä½“é€»è¾‘å°±åœ¨lex()æ–¹æ³•é‡Œï¼Œå…¶å®è¿™ä¸ªå¯¹äºä¹‹å‰å†™çš„Cè¯­è¨€çš„ç¼–è¯‘å™¨ï¼Œä¸€å¯¹æ¯”å°±éå¸¸ç®€å•ï¼Œæ²¡æœ‰ä»€ä¹ˆæƒ…å†µå¥½è€ƒè™‘çš„</p>
<p>åªæœ‰è¿™å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>å¦‚æœæ˜¯&lt;å¼€å¤´çš„è¯ï¼Œé‚£åªæœ‰ä¸¤ç§æƒ…å†µï¼Œè¦ä¹ˆæ˜¯å¼€å§‹æ ‡ç­¾ï¼Œè¦ä¹ˆæ˜¯ç»“æŸæ ‡ç­¾ï¼Œæ‰€ä»¥ç›´æ¥å†è¿›ä¸€æ­¥åˆ¤æ–­æœ‰æ²¡æœ‰æ–œæ å°±å¯ä»¥çŸ¥é“æ˜¯å¼€å§‹æ ‡ç­¾è¿˜æ˜¯ç»“æŸæ ‡ç­¾</li>
<li>åƒå›è½¦åˆ¶è¡¨ç¬¦è¿™äº›ç›´æ¥è·³è¿‡å°±å¯ä»¥äº†</li>
<li>å¦‚æœæ˜¯ç©ºæ ¼çš„è¯è¿˜éœ€è¦åˆ¤æ–­æ˜¯ä¸æ˜¯åœ¨å½“å‰çš„æ–‡æœ¬é‡Œ</li>
</ul>
<p>ç„¶åå°±äº¤ç”±å„ä¸ªå‡½æ•°å¤„ç†äº†</p>
<pre class="js"><code>lex() {
    let text = &#39;&#39;
    while (true) {
        let t = this.advance()
        let token = &#39;&#39;
        switch (t) {
            case &#39;&lt;&#39;:
                if (this.lookAhead() === &#39;/&#39;) {
                    token = this.handleEndTag()
                } else {
                    token = this.handleStartTag()
                }
                break
            case &#39;\n&#39;:
                break
            case &#39; &#39;:
                if (text != &#39;&#39;) {
                    text += t
                } else {
                    break
                }
            case undefined:
                if (this.pos &gt;= this.string.length) {
                    token = [this.token[&#39;eof&#39;], &#39;eof&#39;, []]
                }
                break
            default:
                text += t
                token = this.handleTextTag(text)
                break
        }
        this.string = this.string.slice(this.pos)
        this.pos = 0
        if (token != &#39;&#39;) {
            return token
        }
    }
}</code></pre>
<h3 id="å¤„ç†å¼€å§‹æ ‡ç­¾">å¤„ç†å¼€å§‹æ ‡ç­¾</h3>
<p>å¤„ç†å¼€å§‹æ ‡ç­¾ä¹Ÿéå¸¸ç®€å•ï¼Œæ¯”è¾ƒå¤æ‚çš„æ˜¯éœ€è¦å¤„ç†å¼€å§‹æ ‡ç­¾é‡Œçš„å±æ€§</p>
<ul>
<li>é¦–å…ˆæ˜¯å…ˆå¤„ç†æ ‡ç­¾å</li>
<li>ç„¶åæ˜¯å¤„ç†å¼€å§‹æ ‡ç­¾é‡Œçš„å±æ€§</li>
</ul>
<pre class="js"><code>handleStartTag() {
    let idx = this.string.indexOf(&#39;&gt;&#39;)
    if (idx == -1) {
        throw new Error(&#39;parse err! miss match &#39;&gt;&#39;&#39;)
    }
    let str = this.string.slice(this.pos, idx)
    let s = &#39;&#39;
    if (str.includes(&#39; &#39;)) {
        s = this.string.split(&#39; &#39;).filter((str) =&gt; {
            return str != &#39;&#39;
        })[0]
    } else {
        s = this.string.split(&#39;&gt;&#39;)[0]
    }
    let type = s.slice(1)
    this.pos += type.length
    let props = this.handlePropTag()
    this.advance()
    return [token.startTag, type, props]
}</code></pre>
<h3 id="å¤„ç†å¼€å§‹æ ‡ç­¾çš„å±æ€§">å¤„ç†å¼€å§‹æ ‡ç­¾çš„å±æ€§</h3>
<p>å¤„ç†å±æ€§ä¹Ÿå¾ˆç®€å•ï¼Œæ¯ä¸€ä¸ªå±æ€§çš„é”®å€¼å¯¹éƒ½æ˜¯ç”¨ç©ºæ ¼åˆ†éš”çš„ï¼Œæ‰€ä»¥ç›´æ¥ç”¨splitè·å–æ¯ä¸ªé”®å€¼å¯¹ï¼Œæœ€åè¿”å›ä¸€ä¸ªé”®å€¼å¯¹æ•°ç»„</p>
<p>è¿™é‡Œä¸Šé¢æ³¨æ„tokenè¿”å›çš„æ ¼å¼ï¼Œå¼€å§‹æ ‡ç­¾tokençš„è¿”å›æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯tokenç±»å‹ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯è¿™ä¸ªæ ‡ç­¾çš„ç±»å‹ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ å°±æ˜¯è¿™ä¸ªå¼€å§‹æ ‡ç­¾çš„å±æ€§</p>
<pre class="js"><code>handlePropTag() {
    let idx = this.string.indexOf(&#39;&gt;&#39;)
    if (idx == -1) {
        throw new Error(&#39;parse err! miss match &#39;&gt;&#39;&#39;)
    }
    let string = this.string.slice(this.pos, idx)
    let pm = []
    if (string != &#39; &#39;)  {
        let props = string.split(&#39; &#39;)
        pm = props.filter((props) =&gt; {
            return props != &#39;&#39;
        }).map((prop) =&gt; {
            let kv = prop.split(&#39;=&#39;)
            let o = {}
            o[kv[0]] = this.trimQuotes(kv[1])
            return o
        })
        this.pos += string.length
    }
    
    return pm
}</code></pre>
<h3 id="å¤„ç†ç»“æŸæ ‡ç­¾">å¤„ç†ç»“æŸæ ‡ç­¾</h3>
<p>ç»“æŸæ ‡ç­¾éå¸¸ç®€å•ï¼Œç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²çš„åˆ‡å‰²å°±å®Œäº‹äº†</p>
<pre class="js"><code>handleEndTag() {
    this.advance()
    let idx = this.string.indexOf(&#39;&gt;&#39;)
    let type = this.string.slice(this.pos, idx)
    this.pos += type.length
    if (this.advance() != &#39;&gt;&#39;) {
        throw new Error(&#39;parse err! miss match &#39;&gt;&#39;&#39;)
    }
    return [token.endTag, type, []]
}</code></pre>
<h3 id="å¤„ç†æ–‡æœ¬èŠ‚ç‚¹">å¤„ç†æ–‡æœ¬èŠ‚ç‚¹</h3>
<p>æ–‡æœ¬èŠ‚ç‚¹éœ€è¦ç¨å¾®å¤„ç†ä¸€ä¸‹ï¼Œéœ€è¦åˆ¤æ–­åé¢çš„æ˜¯ä¸æ˜¯&lt;æ¥åˆ¤æ–­æ–‡æœ¬æ˜¯ä¸æ˜¯ç»“æŸäº†</p>
<pre class="js"><code>handleTextTag(text) {
    let t = text.trim()
    if (this.lookAhead() == &#39;&lt;&#39;) {
        return [this.token[&#39;text&#39;], t, []]
    } else {
        return &#39;&#39;
    }
}</code></pre>
<h2 id="è¯­æ³•åˆ†æç”Ÿæˆjavascriptå¯¹è±¡">è¯­æ³•åˆ†æç”ŸæˆJavaScriptå¯¹è±¡</h2>
<blockquote>
<p>è¿™ä¸ªè¿‡ç¨‹å…¶å®å°±æ˜¯ä¸€ä¸ªé€’å½’ä¸‹é™çš„è¿‡ç¨‹ï¼Œå¦‚æœç¢°åˆ°è¯­æ³•ä¸æ­£ç¡®çš„æ—¶é—´æŠ›å‡ºå¼‚å¸¸å°±ç»“æŸäº†</p>
</blockquote>
<p>å…ˆå®šä¹‰ä¸€ä¸‹è¿™ä¸ªJavaScriptå¯¹è±¡çš„ç»“æ„ï¼Œå…¶å®å°±å’Œä¸Šé¢çš„jsonå¯¹è±¡æ˜¯ä¸€è‡´çš„</p>
<pre class="js"><code>class Jsx {
    constructor(type, props) {
        this.type = type
        this.props = props
    }
}</code></pre>
<h3 id="å…¥å£å‡½æ•°">å…¥å£å‡½æ•°</h3>
<ul>
<li>é¦–å…ˆå°±æ˜¯å…ˆæ‹¿åˆ°è¯æ³•åˆ†æä¼ è¿‡æ¥çš„tokençš„ä¸‰ä¸ªå±æ€§</li>
<li>ç„¶åå°±æ˜¯æ ¹æ®ä¸åŒçš„tokenç±»å‹è°ƒç”¨ä¸åŒçš„å¤„ç†å‡½æ•°</li>
</ul>
<pre class="js"><code>parse() {
    this.currentToken = this.lexer.lex()
    let type = this.currentToken[0]
    let tag = this.currentToken[1]
    let props = this.mergeObj(this.currentToken[2])
    let func = this.parseMap[type]
    if (func != undefined) {
        func(tag, props)
    } else {
        this.parseMap[&#39;error&#39;]()
    }

    if (this.tags.length &gt; 0) {
        throw new Error(&#39;parse error! Mismatched start and end tags&#39;)
    }

    return this.jsx
}</code></pre>
<h3 id="å¤„ç†å¼€å§‹æ ‡ç­¾-1">å¤„ç†å¼€å§‹æ ‡ç­¾</h3>
<ul>
<li>é¦–å…ˆå¼€å§‹å…ˆè¦åˆ¤æ–­è¿™ä¸ªtagsçš„é•¿åº¦ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬è½¬æ¢çš„JavaScriptå¯¹è±¡å…¶å®æ˜¯ä¸€ä¸ªåµŒå¥—ç»“æ„ï¼Œä½†æ˜¯å†…éƒ¨çš„ç»“æ„å¹¶ä¸æ˜¯å¾ˆä¸€è‡´ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚ï¼ˆè¿™é‡Œè¿™æ ·å†™ä¸å¤ªå¥½ï¼‰</li>
<li>æœ€åæŠŠè¿™ä¸ªæ ‡ç­¾åæ”¾åˆ°ä¸€ä¸ªæ ˆé‡Œï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå› ä¸ºjsxçš„æ ‡ç­¾æ˜¯å¯ä»¥æ— é™åµŒå¥—çš„ï¼Œæ‰€ä»¥éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ ˆæ¥åˆ¤æ–­å¼€å§‹ç»“æŸæ ‡ç­¾æ˜¯å¦åŒ¹é…ã€‚</li>
</ul>
<pre class="js"><code>parseStart(tag, props) {
    let len = this.tags.length
    let jsx = this.jsx
    if (len &gt;= 1) {
        for (let i = 0; i &lt; len; i++) {
            if (len &gt;= 2 &amp;&amp; i &gt;= 1) {
                jsx = jsx[jsx.length - 1][&#39;props&#39;][&#39;childrens&#39;]
            } else {
                jsx = jsx.props[&#39;childrens&#39;]
            }
        }
        this.currentJsx = new Jsx(tag, {
            &#39;childrens&#39;: []
        })
        Object.assign(this.currentJsx[&#39;props&#39;], props)
        jsx.push(this.currentJsx)
    } else {
        this.currentJsx = jsx = new Jsx(tag, {
            &#39;childrens&#39;: []
        })
        Object.assign(jsx[&#39;props&#39;], props)
        this.jsx = jsx
    }
    this.tags.push(tag)
    this.parse()
}</code></pre>
<h3 id="å¤„ç†ç»“æŸæ ‡ç­¾-1">å¤„ç†ç»“æŸæ ‡ç­¾</h3>
<p>ç»“æŸæ ‡ç­¾çš„å¤„ç†å°±éå¸¸ç®€å•äº†ï¼Œåªè¦å¼¹å‡ºå¯¹åº”çš„å‰ä¸€ä¸ªå¼€å§‹æ ‡ç­¾ï¼Œç”¨æ¥åé¢åˆ¤æ–­å¼€å§‹ç»“æŸæ ‡ç­¾æ˜¯å¦åŒ¹é…</p>
<pre class="js"><code>parseEnd(tag) {
    if (tag == this.tags[this.tags.length - 1]) {
        this.tags.pop()
    }
    this.parse()
}</code></pre>
<h3 id="å¤„ç†æ–‡æœ¬èŠ‚ç‚¹-1">å¤„ç†æ–‡æœ¬èŠ‚ç‚¹</h3>
<p>å¤„ç†æ–‡æœ¬èŠ‚ç‚¹å°±åªè¦ç®€å•çš„æŠŠå¯¹åº”çš„æ–‡æœ¬å†…å®¹æ”¾åˆ°å¯¹è±¡çš„childrenså±æ€§ä¸­å°±å¯ä»¥äº†</p>
<pre class="js"><code>parseText(tag) {
    this.currentJsx[&#39;props&#39;][&#39;text&#39;] = tag
    this.parse()
}</code></pre>
<h2 id="å°ç»“">å°ç»“</h2>
<p>åˆæ°´äº†ä¸€ç¯‡åšå®¢:)</p>
<p>è¿™ä¸ªç³»åˆ—çš„ä¸‹ä¸€ç¯‡å•¥æ—¶å€™å†™å‘¢ï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå…ˆå»æ‘¸ä¼šé±¼ã€‚çœ‹æ˜¯ä¸æ˜¯å»ç¨å¾®é‡æ„ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„ä»£ç ï¼Œå› ä¸ºä»ä¸€å¼€å§‹ç®€å•çš„åªæœ‰æ¸²æŸ“åŠŸèƒ½ï¼Œå†åˆ°åé¢åŠ å…¥ç±»ç»„ä»¶ã€setStateã€dom-diffåä»£ç å°±å˜æˆäº†XXXäº†ï¼Œè™½ç„¶å†™çš„æ—¶å€™çŸ¥é“è¿™æ ·ä¸å¥½ï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³å·æ‡’ï¼Œæ‰€ä»¥ç°åœ¨å°±çœ‹çœ‹èƒ½ä¸èƒ½æ”¹ä¸€æ”¹äº†</p>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修web框架' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>web框架</center></div><div class='banquan'>原文出处:本文由博客园博主小小咸鱼YwY提供。<br/>
原文连接:https://www.cnblogs.com/pythonywy/p/11315860.html</div><br>
    <h1 id="自我总结">08.07自我总结</h1>
<h2 id="一.web框架">一.web框架</h2>
<h3 id="web应用的本质">1.web应用的本质</h3>
<h4 id="socket网络编程">1.socket网络编程</h4>
<ul>
<li>架构：C/S架构</li>
<li>协议：TCP/UDP协议</li>
<li>传输层</li>
</ul>
<h4 id="web应用">2.web应用</h4>
<ul>
<li>架构：B/S架构</li>
<li>协议：Http协议</li>
<li>应用层</li>
</ul>
<h2 id="二.http协议组成">二.http协议组成</h2>
<p><code>请求头</code>\r\n\r\n<code>请求体</code></p>
<p><code>响应头</code>\r\n\r\n<code>响应体</code></p>
<h3 id="关于请求头里的常用相关参数">关于请求头里的常用相关参数</h3>
<p>浏览器支持的内容</p>
<ul>
<li><strong>Accept</strong> :告诉服务端 客户端接受什么类型的响应。</li>
<li><strong>Accept-Charset</strong>：浏览器可接受的字符集</li>
<li><strong>Accept-Encoding</strong>：浏览器能够进行解码的数据编码方式</li>
<li><strong>Accept-Language</strong>：浏览器所希望的语言种类</li>
</ul>
<p>重要的交互参数</p>
<ul>
<li><strong>Cookie</strong> :客户端的Cookie就是通过这个报文头属性传给服务端的后台</li>
<li><strong>Referer</strong> :表示这个请求是从哪个URL过来的</li>
<li><strong>Host</strong>:初始URL中的主机和端口</li>
<li><strong>Cache-Control</strong> 对缓存进行控制</li>
<li><strong>User-Agent:</strong>发起请求的来源</li>
</ul>
<p>其他参数</p>
<ul>
<li>If-Modified-Since：只有当所请求的内容在指定的日期之后又经过修改才返回它，否则返回304“Not Modified”应答；</li>
<li>Pragma：指定“no-cache”值表示服务器必须返回一个刷新后的文档，即使它是代理服务器而且已经有了页面的本地拷贝；</li>
<li>UA-Pixels，UA-Color，UA-OS，UA-CPU：由某些版本的IE浏览器所发送的非标准的请求头，表示屏幕大小、颜色深度、操作系统和CPU类型.</li>
<li>Authorization：授权信息，通常出现在对服务器发送的WWW-Authenticate头的应答中；</li>
<li>Connection：表示是否需要持久连接。如果Servlet看到这里的值为“Keep-Alive”，或者看到请求使用的是HTTP 1.1（HTTP 1.1默认进行持久连接），它就可以利用持久连接的优点，当页面包含多个元素时（例如Applet，图片），显著地减少下载所需要的时间。要实现这一点，Servlet需要在应答中发送一个Content-Length头，最简单的实现方法是：先把内容写入ByteArrayOutputStream，然后在正式写出内容之前计算它的大小；</li>
<li>Content-Length：表示请求消息正文的长度</li>
</ul>
<h3 id="关于响应头里的常用相关参数">关于响应头里的常用相关参数</h3>
<table>
<thead>
<tr class="header">
<th><strong>Header</strong></th>
<th><strong>解释</strong></th>
<th><strong>示例</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Accept-Ranges</td>
<td>表明服务器是否支持指定范围请求及哪种类型的分段请求</td>
<td>Accept-Ranges: bytes</td>
</tr>
<tr class="even">
<td>Age</td>
<td>从原始服务器到代理缓存形成的估算时间（以秒计，非负）</td>
<td>Age: 12</td>
</tr>
<tr class="odd">
<td>Allow</td>
<td>对某网络资源的有效的请求行为，不允许则返回405</td>
<td>Allow: GET, HEAD</td>
</tr>
<tr class="even">
<td>Cache-Control</td>
<td>告诉所有的缓存机制是否可以缓存及哪种类型</td>
<td>Cache-Control: no-cache</td>
</tr>
<tr class="odd">
<td>Content-Encoding</td>
<td>web服务器支持的返回内容压缩编码类型。</td>
<td>Content-Encoding: gzip</td>
</tr>
<tr class="even">
<td>Content-Language</td>
<td>响应体的语言</td>
<td>Content-Language: en,zh</td>
</tr>
<tr class="odd">
<td>Content-Length</td>
<td>响应体的长度</td>
<td>Content-Length: 348</td>
</tr>
<tr class="even">
<td>Content-Location</td>
<td>请求资源可替代的备用的另一地址</td>
<td>Content-Location: /index.htm</td>
</tr>
<tr class="odd">
<td>Content-MD5</td>
<td>返回资源的MD5校验值</td>
<td>Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ==</td>
</tr>
<tr class="even">
<td>Content-Range</td>
<td>在整个返回体中本部分的字节位置</td>
<td>Content-Range: bytes 21010-47021/47022</td>
</tr>
<tr class="odd">
<td>Content-Type</td>
<td>返回内容的MIME类型</td>
<td>Content-Type: text/html; charset=utf-8</td>
</tr>
<tr class="even">
<td>Date</td>
<td>原始服务器消息发出的时间</td>
<td>Date: Tue, 15 Nov 2010 08:12:31 GMT</td>
</tr>
<tr class="odd">
<td>ETag</td>
<td>请求变量的实体标签的当前值</td>
<td>ETag: “737060cd8c284d8af7ad3082f209582d”</td>
</tr>
<tr class="even">
<td>Expires</td>
<td>响应过期的日期和时间</td>
<td>Expires: Thu, 01 Dec 2010 16:00:00 GMT</td>
</tr>
<tr class="odd">
<td>Last-Modified</td>
<td>请求资源的最后修改时间</td>
<td>Last-Modified: Tue, 15 Nov 2010 12:45:26 GMT</td>
</tr>
<tr class="even">
<td>Location</td>
<td>用来重定向接收方到非请求URL的位置来完成请求或标识新的资源</td>
<td>Location: http://www.zcmhi.com/archives/94.html</td>
</tr>
<tr class="odd">
<td>Pragma</td>
<td>包括实现特定的指令，它可应用到响应链上的任何接收方</td>
<td>Pragma: no-cache</td>
</tr>
<tr class="even">
<td>Proxy-Authenticate</td>
<td>它指出认证方案和可应用到代理的该URL上的参数</td>
<td>Proxy-Authenticate: Basic</td>
</tr>
<tr class="odd">
<td>refresh</td>
<td>应用于重定向或一个新的资源被创造，在5秒之后重定向（由网景提出，被大部分浏览器支持）</td>
<td>Refresh: 5; url=http://www.atool.org/httptest.php</td>
</tr>
<tr class="even">
<td>Retry-After</td>
<td>如果实体暂时不可取，通知客户端在指定时间之后再次尝试</td>
<td>Retry-After: 120</td>
</tr>
<tr class="odd">
<td>Server</td>
<td>web服务器软件名称</td>
<td>Server: Apache/1.3.27 (Unix) (Red-Hat/Linux)</td>
</tr>
<tr class="even">
<td>Set-Cookie</td>
<td>设置Http Cookie</td>
<td>Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1</td>
</tr>
<tr class="odd">
<td>Trailer</td>
<td>指出头域在分块传输编码的尾部存在</td>
<td>Trailer: Max-Forwards</td>
</tr>
<tr class="even">
<td>Transfer-Encoding</td>
<td>文件传输编码</td>
<td>Transfer-Encoding:chunked</td>
</tr>
<tr class="odd">
<td>Vary</td>
<td>告诉下游代理是使用缓存响应还是从原始服务器请求</td>
<td>Vary: *</td>
</tr>
<tr class="even">
<td>Via</td>
<td>告知代理客户端响应是通过哪里发送的</td>
<td>Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)</td>
</tr>
<tr class="odd">
<td>Warning</td>
<td>警告实体可能存在的问题</td>
<td>Warning: 199 Miscellaneous warning</td>
</tr>
<tr class="even">
<td>WWW-Authenticate</td>
<td>表明客户端请求实体应该使用的授权方案</td>
<td>WWW-Authenticate: Basic</td>
</tr>
<tr class="odd">
<td>X-Powered-By</td>
<td>由语言解析器或者应用程序框架输出的，这个值的意义用于告知网站是用何种语言或框架编写的</td>
<td>X-Powered-By: ASP.NET</td>
</tr>
</tbody>
</table>
<h3 id="响应行书写">响应行书写</h3>
<p><code>版本协议</code>+<code>响应码</code>+<code>附加信息</code>\r\n\r\n<code>响应体</code></p>
<p>如:<code>HTTP/1.1 200 OK\r\n\r\n响应体</code></p>
<p>响应码</p>
<ul>
<li>1xx:提示信息，表示<strong>请求已</strong>经<strong>接收</strong></li>
<li>2XX:<strong>响应成功</strong></li>
<li>3xx:<strong>响应需要定向（重新记载链接第三方链接）</strong></li>
<li>4xx:<strong>客户端错误</strong></li>
<li>5xx:<strong>服务器端错误</strong></li>
</ul>
<p>常用响应码</p>
<ul>
<li><strong>200</strong>:成功</li>
<li><strong>404</strong>;请求<strong>内容不存在</strong></li>
<li><strong>401</strong>:没有访问<strong>权限</strong></li>
<li><strong>500</strong>:服务器<strong>未知错误</strong></li>
<li><strong>503</strong>: <strong>服务器</strong>暂时<strong>无法执行</strong></li>
</ul>
<h2 id="三.写web框架的三步骤">三.写web框架的三步骤</h2>
<ul>
<li>第一步:写socket服务端</li>
<li>第二步:路由系统：url ====》 函数</li>
<li>第三步:模板引擎渲染:自定义规则主要是将里面的内容进行替换有顶俗称html模板如果不在不引入地方的情况下修改的内容会@内容@放置给后面参数进行渲染,也可以使用第三方jinja2进行渲染</li>
</ul>
<p>按照上述步骤进行分类可以分成三类</p>
<ul>
<li>以上三步都不采用第三方例如--&gt;tornado</li>
<li>第一步引入第三方如--&gt; django (wsgiref/uwsgi)</li>
<li>第一步与第三步引用第三方如--&gt;flask</li>
</ul>
<h2 id="四.手写web框架简单案例">四.手写web框架简单案例</h2>
<pre><code><code>import socket
import re
server = socket.socket()
server.bind((&#39;127.0.0.1&#39;,8080))
server.listen(5)

while True:
    conn,adder = server.accept()
    a = conn.recv(8888)
    data = str(a,encoding=&#39;utf8&#39;)
    print(data)
    conn.send(bytes(&#39;HTTP/1.1 200 OK\r\n\r\n&#39;,encoding=&#39;utf8&#39;))
    conn.send(bytes(&#39;ywy&#39;,encoding=&#39;utf8&#39;))</code></pre>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
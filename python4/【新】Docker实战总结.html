<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修【新】Docker实战总结' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>【新】Docker实战总结</center></div><div class='banquan'>原文出处:本文由博客园博主LeoZhanggg提供。<br/>
原文连接:https://www.cnblogs.com/leozhanggg/p/12039953.html</div><br>
    <h1><span style="font-size: 18pt; font-family: 'Microsoft YaHei';"><strong><strong>&gt;&gt;&gt; 目录 &lt;&lt;&lt;</strong></strong></span></h1>
<ul>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker简介</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker优势</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker基本概念</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker安装使用</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker常用命令</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker镜像构建</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker本地仓库</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker图形管理工具Portainer</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker集群管理工具Swarm</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker运维流程图</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker配置管理</span></li>
<li><span style="font-size: 18px; color: #ff6600; font-family: 'Microsoft YaHei';">Docker后续问题</span></li>
<li><span style="font-family: 'Microsoft YaHei';"><span style="font-size: 18px; color: #ff6600;">Docker报错解决</span>&nbsp;</span></li>
</ul>
<h1><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></h1>
<h1><span style="font-family: 'Microsoft YaHei';">&gt;&gt;&gt; 正文 &lt;&lt;&lt;</span></h1>
<p align="center"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>一、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>简介</strong></span></h2>
<p><span style="color: #ff6600; font-family: 'Microsoft YaHei';">　　　Docker是一个开源的应用容器引擎，开发者可以打包自己的应用到容器里面，然后迁移到其他机器的docker应用中，可以实现快速部署。</span></p>
<p><span style="font-family: 'Microsoft YaHei';">　　　简单的理解，docker就是一个软件集装箱化平台，就像船只、火车、卡车运输集装箱而不论其内部的货物一样，软件容器充当软件部署的标准单元，其中可以包含不同的代码和依赖项。</span></p>
<p><span style="font-family: 'Microsoft YaHei';">　　　按照这种方式容器化软件，开发人员和 IT 专业人员只需进行极少修改或不修改，即可将其部署到不同的环境，如果出现的故障，也可以通过镜像，快速恢复服务。</span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结0.png" alt="" width="888" height="300" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>二、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>优势</strong></span></h2>
<h3><span style="font-family: 'Microsoft YaHei';"><strong>　　1.</strong><strong>&nbsp;　　</strong><strong>特性优势</strong></span></h3>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结1.png" alt="" width="801" height="191" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3 style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">2.　　资源优势</span></h3>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><img src="./images/【新】Docker实战总结2.png" alt="" /></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';"><strong>&nbsp;</strong></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>三、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>基本概念</strong></span></h2>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>Client</strong><strong>（客户端）</strong>：</span>是Docker的用户端，可以接受用户命令和配置标识，并与Docker daemon通信。</span></p>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>Images</strong><strong>（镜像）</strong>：</span>是一个只读模板，含创建Docker容器的说明，它与操作系统的安装光盘有点像。</span></p>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>Containers</strong><strong>（容器）</strong>：</span>镜像的运行实例，镜像与容器的关系类比面向对象中的类和对象。</span></p>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>Registry</strong><strong>（仓库）：</strong></span>是一个集中存储与分发镜像的服务。最常用的Registry是官方的Docker Hub 。</span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结3.png" alt="" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>四、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>安装使用</strong></span></h2>
<ul>
<li>
<h3><span style="color: #ff6600; font-family: 'Microsoft YaHei';">操作系统：CentOS 7</span></h3>
</li>
</ul>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';"><strong>1、安装依赖</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';">yum install -y yum-utils device-mapper-persistent-data lvm2</span></p>
</blockquote>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';"><strong>2、添加软件源</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><span style="color: #008000;">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo　</span><span style="font-size: 13px;">　<span style="color: #ff0000;"># 指定阿里云镜像源</span></span></span></p>
</blockquote>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';"><strong>3、安装docker-ce</strong><span style="font-size: 13px; color: #ff0000;">（对系统内核有一定要求，centos6不支持）</span></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><span style="color: #008000;">yum clean all &nbsp;yum makecache fast&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-size: 13px; color: #ff0000;">&nbsp;&nbsp;# 重新生成缓存</span></span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><strong>yum -y install docker-ce docker-ce-cli containerd.io</strong></span></p>
</blockquote>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';"><strong>4、设置自启并启动</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><strong>systemctl enable docker</strong></span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><strong>systemctl start docker</strong></span></p>
</blockquote>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';"><strong>5、查看版本</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker version</span></p>
</blockquote>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<img src="./images/【新】Docker实战总结4.png" alt="" /></span></p>
<p style="margin-left: 30px;">&nbsp;</p>
<p style="margin-left: 30px;">&nbsp;</p>
<ul>
<li>
<h3><span style="font-family: 'Microsoft YaHei';">&nbsp;</span><span style="font-family: 'Microsoft YaHei'; color: #ff6600;">运行示例：Nginx</span></h3>
</li>
</ul>
<h4 style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">1、搜索并下载镜像</span></h4>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker search nginx</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker pull nginx</span></p>
</blockquote>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结5.png" alt="" /></span></p>
<h4 style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">2、启动一个容器并映射端口到本地</span></h4>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><span style="color: #008000;">docker run -d -p 8080:80 --name Nginx nginx　</span>　<span style="color: #ff0000;">　<span style="font-size: 13px;">　# 参数详解见下文</span></span></span></p>
</blockquote>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结6.png" alt="" width="876" height="77" /></span></p>
<h4 style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">3、访问本地映射端口</span></h4>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结7.png" alt="" /></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>五、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>常用命令</strong></span></h2>
<h3><span style="font-family: 'Microsoft YaHei';">　　<strong>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>镜像控制</strong></span></h3>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>&nbsp;搜索镜像：</strong></span>docker&nbsp; search&nbsp; [OPTIONS]&nbsp; TERM</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>上传镜像：</strong></span>docker&nbsp; push&nbsp; [OPTIONS]&nbsp; NAME[:TAG]</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>下载镜像：</strong></span>docker&nbsp; pull&nbsp; [OPTIONS]&nbsp; NAME[:TAG]</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>提交镜像：</strong></span>docker&nbsp; commit [OPTIONS]&nbsp; CONTAINER&nbsp; NAME[:TAG]</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>构建镜像：</strong></span>docker&nbsp; build&nbsp; [OPTIONS]&nbsp; PATH</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>删除镜像：</strong></span>docker&nbsp; rmi [OPTIONS]&nbsp; IMAGE&nbsp; [IMAGE...]</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>增加镜像标签：</strong></span>docker&nbsp; tag&nbsp; SOURCE_IMAGE[:TAG]&nbsp; TARGET_IMAGE[:TAG]</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>查看所有镜像：</strong></span>docker&nbsp; images&nbsp; [OPTIONS]&nbsp; [REPOSITORY[:TAG]]</span></p>
</blockquote>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结8.png" alt="" width="791" height="149" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3><span style="font-family: 'Microsoft YaHei';"><strong>　　2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>容器控制</strong></span></h3>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>启动/重启容器：</strong></span>docker start/restart CONTAINER</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>停止/强停容器：</strong></span>docker stop/ kill CONTAINER</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>删除容器：</strong></span>docker rm [OPTIONS] CONTAINER [CONTAINER...]</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>重命名容器：</strong></span>docker rename CONTAINER CONTAINER_NEW</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>进入容器：</strong></span>docker attach CONTAINER</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>执行<strong>容器</strong>命令：</strong></span>docker exec CONTAINER COMMAND</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>查看容器日志：</strong></span>docker logs [OPTIONS] CONTAINER</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;"><strong>查看容器列表：</strong></span>docker ps [OPTIONS]</span></p>
</blockquote>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<img src="./images/【新】Docker实战总结9.png" alt="" width="924" height="100" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<strong>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>容器启动</strong></span></h3>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker&nbsp; run&nbsp; [OPTIONS]&nbsp; IMAGE&nbsp; [COMMAND]&nbsp; [ARG...]</span></p>
</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>-d :</strong>&nbsp;后台运行容器，并返回容器ID</span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>-i</strong><strong>：</strong>以交互模式运行容器，通常与 -t 同时使用</span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>-t</strong><strong>：</strong>为容器重新分配一个伪输入终端，通常与 -i 同时使用</span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>-v</strong><strong>：</strong>绑定挂载目录</span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>--name="mycontainer":</strong>&nbsp;为容器指定一个名称</span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>--net="bridge":</strong>&nbsp;指定容器的网络连接类型，支持如下：</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;&nbsp; 　　bridge / host / none / container:&lt;name|id&gt;</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';"><strong>-p/-P :</strong>端口映射，格式如图：</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;　　　　<img src="./images/【新】Docker实战总结10.png" alt="" width="414" height="276" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<strong>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>其他命令</strong></span></h3>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;">查看docker信息：</span>docker info</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;">docker命令帮助：</span>docker run --help</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;">复制文件到容器：</span>docker cp custom.conf Nginx:/etc/nginx/conf.d/</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;">更新容器启动项：</span>docker container update --restart=always nginx</span></p>
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';"><span style="color: #ff6600;">查看docker日志：</span>tail -f /var/log/messages</span></p>
</blockquote>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结11.png" alt="" /></span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;&nbsp;　　</span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&gt;&gt;&gt; 更多可以参考官网：<a href="https://docs.docker.com/engine/reference/commandline/cli/">https://docs.docker.com/engine/reference/commandline/cli/</a><a href="https://www.jianshu.com/p/8f38f198724e" target="_blank"><br /></a></span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><img src="./images/【新】Docker实战总结12.png" alt="" width="852" height="560" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>六、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>镜像构建</strong></span></h2>
<h3><span style="font-family: 'Microsoft YaHei';">　　<strong>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker commit</strong><span style="color: #ff6600;">（1运行2修改3保存）</span></span></h3>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>a）&nbsp;&nbsp; 运行容器</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker run -dit -p 8080:80 --name Nginx nginx</span></p>






</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>b）&nbsp;&nbsp; 修改容器</strong><span style="color: #ff0000; font-size: 13px;">（这里我只是做个演示，所以就复制一下文件，具体修改需要根据你实际情况）</span></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker cp custom.conf Nginx:/etc/nginx/conf.d/</span></p>






</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>c）&nbsp;&nbsp; 将容器保存为新的镜像</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker commit Nginx zwx/nginx</span></p>






</blockquote>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<img src="./images/【新】Docker实战总结13.png" alt="" /></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3 style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;<strong>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Dockerfile</strong><span style="color: #ff6600;">（1编写2构建）</span></span></h3>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>a）&nbsp;&nbsp; 编写Dockerfile文件</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">vim Dockerfile</span></p>






</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结14.png" alt="" /></span></p>
<p style="margin-left: 60px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';"><strong>b）&nbsp;&nbsp; 执行Dockerfile文件</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><span style="color: #008000;">docker build -t zwx/nginx&nbsp;<strong>.　　　　</strong><span style="color: #ff0000; font-size: 13px;"># 后面有个点，代表当前目录下dockerfile文件</span></span><strong><br /></strong></span></p>






</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<img src="./images/【新】Docker实战总结15.png" alt="" /></span></p>
<h3 style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;<strong>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Dockerfile&nbsp;</strong><strong>常用指令</strong></span></h3>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;<img src="./images/【新】Docker实战总结16.png" alt="" /></span></p>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';">　　&nbsp;&gt;&gt;&gt; 更多可以参考：<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/leozhanggg/p/11820214.html">【转载】Dockerfile文件详解</a></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>七、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>本地仓库</strong></span></h2>
<p><span style="font-family: 'Microsoft YaHei';"><strong>　　1、拉取镜像仓库</strong></span></p>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker search registry</span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker pull registry</span></p>






</blockquote>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>2、启动镜像服务</strong></span></p>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker run -dit \</span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">--name=Registry \　　　　<span style="color: #ff0000; font-size: 13px;"># 指定容器名称</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">-p 5000:5000 \　　　　　<span style="color: #ff0000;">　<span style="font-size: 13px;"># 仓库默认端口是5000，映射到宿主机，这样可以使用宿主机地址访问</span></span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">--restart=always \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff0000; font-size: 13px;">&nbsp;# 自动重启，这样每次docker重启后仓库容器也会自动启动</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">--privileged=true \&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #ff0000; font-size: 13px;"># 增加安全权限，一般可不加</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">-v /usr/local/my_registry:/var/lib/registry&nbsp; \　　　　<span style="color: #ff0000; font-size: 13px;"># 把仓库镜像数据保存到宿主机</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">registry</span></p>






</blockquote>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>3、注册https协议</strong>（需要通过本地仓库下载镜像，均需要配置）</span></p>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">vim /etc/docker/daemon.json　　　　　　　　<span style="font-size: 13px; color: #ff0000;"># 默认无此文件，需自行添加，有则追加一下内容。</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">&nbsp;&nbsp; { "insecure-registries":[" xx.xx.xx.xx:5000"] }　　<span style="color: #ff0000; font-size: 13px;">#&nbsp;指定ip地址或域名</span></span></p>






</blockquote>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>4、新增tag指明仓库地址</strong></span></p>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><span style="color: #008000;">docker&nbsp;<strong>tag</strong>&nbsp;zwx/nginx x.xx.xx.xx:5000/zwx/nginx　</span>　<span style="color: #ff0000;"># 如果构建时已经指定仓库地址，则可以省略</span></span></p>






</blockquote>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>5、上传镜像到本地仓库</strong></span></p>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker&nbsp;<strong>push</strong>&nbsp;x.xx.xx.xx:5000/zwx/nginx</span></p>






</blockquote>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>6、查看本地仓库</strong></span></p>
<blockquote style="margin-left: 30px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">curl -XGET http://x.xx.xx.xx:5000/v2/_catalog</span></p>






</blockquote>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp; &nbsp; &nbsp; &nbsp;<img src="./images/【新】Docker实战总结17.png" alt="" /></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　&gt;&gt;&gt; 更多可以参考：<a href="https://www.jianshu.com/p/8f38f198724e" target="_blank">docker 搭建本地私有仓库</a></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>八、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>与图形管理工具Portainer</strong></span></h2>
<h3><span style="font-family: 'Microsoft YaHei';">　　<strong>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>简介</strong></span></h3>
<p align="left"><span style="font-family: 'Microsoft YaHei';">　　　　Portainer是Docker的图形化管理工具，提供状态显示面板、应用模板快速部署、容器镜像网络数据卷的基本操作（包括上传下载镜像，创建容器等操作）、</span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">　　　　事件日志显示、容器控制台操作、Swarm集群和服务等集中管理和操作、登录用户管理和控制等功能。功能十分全面，基本能满足中小型单位对容器管理的全部需求。</span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　　　<img src="./images/【新】Docker实战总结18.png" alt="" width="997" height="408" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3 align="left"><span style="font-family: 'Microsoft YaHei';">　　<strong>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>安装使用</strong></span></h3>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>a） 搜索并下载镜像</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker search portainer</span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker pull portainer/portainer</span></p>






</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>b） 单机方式运行</strong></span></p>
<blockquote style="margin-left: 60px;">
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">docker run -d \</span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">-p 9000:9000 \　　　<span style="color: #ff0000; font-size: 13px;"># portainer默认端口是9000，映射到本地9000端口，通过本地地址访问</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">--restart=always \　　<span style="color: #ff0000; font-size: 13px;"># 设置自动重启</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">-v /var/run/docker.sock:/var/run/docker.sock \　　<span style="color: #ff0000; font-size: 13px;"># 单机必须指定docker.sock</span></span></p>
<p style="margin-left: 30px;" align="left"><span style="color: #008000; font-family: 'Microsoft YaHei';">--name Prtainer portainer/portainer</span></p>






</blockquote>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>c） 访问http://localhost:9000</strong></span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';">　<span style="font-size: 13px; color: #ff0000;">　首次登陆需要注册用户，给admin用户设置密码，然后单机版选择local连接即可。</span></span></p>
<p style="margin-left: 60px;" align="left"><span style="font-family: 'Microsoft YaHei';"><img src="./images/【新】Docker实战总结19.png" alt="" width="803" height="436" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p style="margin-left: 30px;" align="left"><span style="font-family: 'Microsoft YaHei';"><strong>d） 控制管理</strong></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">　　　　　<img src="./images/【新】Docker实战总结20.png" alt="" width="786" height="428" /></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">　　　　&nbsp;&nbsp;&gt;&gt;&gt; 更多可以参考：<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/river2005/p/8283700.html">Portainer介绍</a></span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>九、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>与集群管理工具Swarm</strong></span></h2>
<h3><span style="font-family: 'Microsoft YaHei';"><strong>　　</strong><strong>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>简介</strong></span></h3>
<p align="left"><span style="font-family: 'Microsoft YaHei';">　　　　Swarm是Docker官方提供的一款集群管理工具，其主要作用是把若干台Docker主机抽象为一个整体，并且通过一个入口统一管理这些Docker主机上的各种Docker资源。</span></p>
<p align="left"><span style="font-family: 'Microsoft YaHei';">　　　　<img src="./images/【新】Docker实战总结21.png" alt="" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<strong>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>安装使用</strong></span></h3>
<p><span style="font-family: 'Microsoft YaHei';">　　　　Swarm 在 Docker 1.12 版本之前属于一个独立的项目，在 Docker 1.12 版本发布之后，该项目合并到了 Docker 中，成为 Docker 的一个子命令。</span></p>
<p><span style="font-family: 'Microsoft YaHei';">　　　　</span></p>
<p><span style="font-family: 'Microsoft YaHei';"><strong>　　　　a)　　启动swarm集群只需要执行初始化命令即可：</strong></span></p>
<blockquote>
<pre><code><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">docker swarm <strong>init</strong> \　　　　　　　<span style="font-size: 13px; color: #ff0000;"># 默认初始化节点为管理节点</span></span><br /><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">--advertise-addr xx.xx.xx.xx \　　　<span style="font-size: 13px; color: #ff0000;">#指定使用的ip</span></span><br /><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">--listen-addr xx.xx.xx.xx:2377　　　<span style="color: #ff0000; font-size: 13px;">#指定监听ip和port，默认为2377</span></span></pre>
</blockquote>
<p><span style="font-family: 'Microsoft YaHei';">　　　　<img src="./images/【新】Docker实战总结22.png" alt="" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">　<strong>　　　b)&nbsp;　　设置manager节点</strong></span></p>
<blockquote>
<p><span style="color: #008000; font-family: 'Microsoft YaHei';">　　　<span style="font-size: 15px;">　docker swarm join-token&nbsp;<strong>manager</strong>　　　　<span style="font-size: 13px; color: #ff0000;">#获取管理节点token，放入下面命令</span></span></span></p>
<p style="margin-left: 60px;"><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">docker swarm join \</span><br /><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">--advertise-addr xx.xx.xx.xx \</span><br /><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">--listen-addr xx.xx.xx.xx:2377 \</span><br /><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei'; background-color: #ffff99;">--token SWMTKN-1-29ynh5uyfiiospy4fsm4pd4xucyji2rn0oj4b4ak4s7a37syf9-ajkrv2ctjr5cmxzuij75tbrmz \</span><br /><span style="color: #008000; font-size: 15px; font-family: 'Microsoft YaHei';">xx.xx.xx.xx:2377</span></p>






</blockquote>
<p><span style="font-family: 'Microsoft YaHei';">　<strong>　　　</strong></span></p>
<p><span style="font-family: 'Microsoft YaHei';"><strong>　　　　c)&nbsp;　　设置worker节点</strong></span></p>
<blockquote>
<p><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';">　　　　docker swarm join-token&nbsp;<strong>worker</strong>　　　　<span style="color: #ff0000; font-size: 13px;">#获取工作节点token，放入下面命令</span></span></p>
<p style="margin-left: 60px;"><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';">docker swarm join \</span><br /><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';">--advertise-addr xx.xx.xx.xx \</span><br /><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';">--listen-addr xx.xx.xx.xx:2377 \</span><br /><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei'; background-color: #ffff99;">--token SWMTKN-1-29ynh5uyfiiospy4fsm4pd4xucyji2rn0oj4b4ak4s7a37syf9-ajkrv2ctjr5cmxzuij75tbrmz \</span><br /><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';">xx.xx.xx.xx:2377</span></p>






</blockquote>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">　　　　<strong>c)&nbsp;　　查看节点</strong></span></p>
<blockquote>
<p style="margin-left: 60px;"><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';">&nbsp;<strong><code>docker node ls</code></strong></span></p>






</blockquote>
<p><span style="font-family: 'Microsoft YaHei';"><strong>　　　　<img src="./images/【新】Docker实战总结23.png" alt="" /></strong></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;　　　　<strong>d)&nbsp;　　创建服务</strong></span></p>
<div>
<blockquote>
<pre><code><span style="font-size: 15px; color: #008000; font-family: 'Microsoft YaHei';"><strong><code class="  language-css">docker service create [OPTIONS] IMAGE [COMMAND] [ARG...]</code></strong></span></pre>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--detach , -d</code>:&nbsp;</strong>&nbsp;指定容器运行于前台还是后台，默认为false</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--name</code>:&nbsp;</strong>&nbsp;服务名称</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--network</code>:&nbsp;</strong>&nbsp;网络连接</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--publish , -p</code>:&nbsp;</strong>&nbsp;端口映射</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--env , -e</code>:</strong>&nbsp; 设置环境变量</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--tty , -t</code>:</strong>&nbsp; 分配tty设备，该可以支持终端登录</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--mount</code>:&nbsp;</strong>&nbsp;文件挂载</span></p>
<p style="margin-left: 90px;"><span style="font-size: 13px; font-family: 'Microsoft YaHei';"><strong><code>--replicas</code>:&nbsp;</strong>&nbsp;指定任务数量</span></p>
</blockquote>
</div>
<p><span style="font-family: 'Microsoft YaHei';">　　&gt;&gt;&gt;更多参考：<a href="https://www.jianshu.com/p/028b40ca4f2a" target="_blank">Docker Swarm集群部署实践</a>&nbsp;&nbsp;　　<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/xiangsikai/p/9935814.html">Docker Swarm 常用命令</a></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h3><span style="font-family: 'Microsoft YaHei';">&nbsp; 　3<strong>.&nbsp; &nbsp; &nbsp;对比K8s究竟有何异同?</strong></span></h3>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei'; color: #ff6600;"><strong>a）出生不同</strong></span></p>
<p style="margin-left: 90px;"><span style="font-family: 'Microsoft YaHei';">Google根据其在Linux上容器管理经验，改造到docker管理上，就是kubernetes。他的在许多方面表现良好,最重要的是构造于Google多年的宝贵经验只上。</span><br /><span style="font-family: 'Microsoft YaHei';">kubernetes并不是为了docker写的,kubernetes把集群带到了一个全新的高度，代价是学习曲线比较陡。docker-swarm 使用了一个不同的方式,它是docker原生的集群工具。</span><br /><span style="font-family: 'Microsoft YaHei';">最方便的部分是它暴露了docker标准的编程接口，意味着你之前一直在使用的任何与docker沟通的工具（docker CLI,&nbsp; docker compose等），都可以无缝的在docker swarm上使用。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei'; color: #ff6600;"><strong>b）安装配置不同</strong></span></p>
<p style="margin-left: 90px;"><span style="font-family: 'Microsoft YaHei';">安装设置swarm非常简单，简单明了并且很灵活。我们需要做的就是安装一个服务发现工具，然后在所有的节点上安装swarm容器。</span><br /><span style="font-family: 'Microsoft YaHei';">相比较而言，kubernetes的安装就有点复杂晦涩了。不同的操作系统上安装都不同。每个操作系统都有自己的独立安装指令。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei'; color: #ff6600;"><strong>c）运行方式不同</strong></span></p>
<p style="margin-left: 90px;"><span style="font-family: 'Microsoft YaHei';">使用Swarm和使用容器没有什么不同。比如，你习惯于使用Docker CLI（命令行接口），你可以继续使用几乎相同的命令。</span><br /><span style="font-family: 'Microsoft YaHei';">如果你习惯于使用Docker Componse来运行容器，你可以继续在Swarm集群中使用。不管你之前习惯于怎么使用容器，你仍旧可以使用，只是在更大级别的集群中使用。</span><br /><span style="font-family: 'Microsoft YaHei';">Kubernetes要求你去学习它自己的CLI（命令行接口）和配置。你不能使用你之前创建的docker-compose.yml配置，你必须要去新建与Kubernetes对应的配置。</span><br /><span style="font-family: 'Microsoft YaHei';">你也不能使用之前学习的Docker CLI（命令行接口）。你必须要去学习 Kubernetes CLI（命令行接口）</span></p>
<p style="margin-left: 90px;"><span style="font-family: 'Microsoft YaHei'; background-color: #ffff99;">最后，当需要在Docker Swarm 和 Kubernetes做出选择时，可以考虑如下几点：</span><br /><span style="font-family: 'Microsoft YaHei';">你是否想依赖于Docker自己来解决集群的问题。如果是，选择Swarm。如果某些功能在Docker中不支持，那它也非常可能在Swarm中找不到，因为Swarm是依赖于Docker API的。</span><br /><span style="font-family: 'Microsoft YaHei';">另外一方面，如果你想要一个工具可以解决Docker的限制，Kubernetes将是不错的选择。Kubernetes不是基于Docker，而是基于Google多年对于管理容器的经验。它是按照自己的方式来行事。</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>十、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>运维流程图</strong></span></h2>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;　　<img src="./images/【新】Docker实战总结24.png" alt="" /></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>十一、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>配置管理</strong></span></h2>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><strong>1.　　用了容器以后，还需要配置管理吗？</strong></span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">起初我们跟Docker官方一样，属于理想主义派。天真的认为容器就应该是inmutable的，当需要配置变更的时候，重新构建镜像重新部署。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">基于这一思路，我们在cSphere中添加了个镜像自动构建模块，用户可以配置代码仓库的地址。</span><br /><span style="font-family: 'Microsoft YaHei';">服务的配置文件保存于Git或者SVN库中，需要配置变更时，向版本库中Push一下，自动通过hook触发镜像构建，并自动完成线上容器的重建。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">通过这套系统，用户可以非常方便的批量更新线上的服务，并不局限于配置文件的变更，代码的变更也天生支持。</span><br /><span style="font-family: 'Microsoft YaHei';">经过实际使用，这套系统能够很好的满足开发和测试环境的需求，提升工作效率。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei'; background-color: #ffff99;">但是，在生产环境中使用的时候，我们发现这种流程其实并不那么完美，主要表现在：</span><br /><span style="font-family: 'Microsoft YaHei';">镜像构建和部署虽然自动化了，但构建是针对VCS中的某个仓库的，改一行配置就得整体重新构建一下，在更新容器时还需要把镜像重新分发到所有机器上，配置变更速度太慢。</span><br /><span style="font-family: 'Microsoft YaHei';">这种方式的配置变更会涉及到服务的重启，这在生产环境某些场景下是不可接受的 ，有可能引起短暂的服务中断。</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><strong>2.　　应用配置文件应该需要做到什么？</strong></span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei';">Docker应用配置文件能够保持能够支持针对不同环境作出更改。另外配置文件支持在线更改，重启就生效。一般分为以下两种方式。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei'; color: #ff6600;"><strong>a） Docker环境变量</strong></span></p>
<p style="margin-left: 90px;"><span style="font-family: 'Microsoft YaHei';">需要在制作镜像的时候就需要提前想好，有哪些参数是部署容器的时候会经常更改，</span><br /><span style="font-family: 'Microsoft YaHei';">然后把这些参数抽出来做成容器的环境变量，然后在部署的容器的时候填入不同的参数即可。</span><br /><span style="font-family: 'Microsoft YaHei';">但是如果后续发现有一些参数不同场景下部署的时候也会修改，那就需要再重新制作镜像了。</span></p>
<p style="margin-left: 60px;"><span style="font-family: 'Microsoft YaHei'; color: #ff6600;"><strong>b）应用配置文件</strong></span></p>
<p style="margin-left: 90px;"><span style="font-family: 'Microsoft YaHei';">上述的管理方式不太灵活，灵活的管理方式是将配置文件和镜像剥离开，这样就不会被镜像给绑定了。</span></p>
<p style="margin-left: 90px;"><span style="color: #ff0000; font-family: 'Microsoft YaHei';">注：最新版本可以参考docker config命令管理</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';"><strong>十二、&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>Docker</strong><strong>后续问题</strong></span></h2>
<ul>
<li style="list-style-type: none;">
<ul>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; 集群环境</span></li>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; 网络安全</span></li>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; 存储管理</span></li>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; 日志收集</span></li>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; 实时监控</span></li>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; 性能调优</span></li>
<li><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">&nbsp;&nbsp; &hellip;&hellip;</span></li>

</ul>

</li>






</ul>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<h2><span style="font-family: 'Microsoft YaHei';">十三、Docker报错解决</span></h2>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><a class="entrylistItemTitle" href="https://www.cnblogs.com/leozhanggg/p/11730189.html">【解决】Got permission denied while trying to connect to the Docker daemon socket at......dial unix /var/run/docker.sock: permission denied</a></span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">&nbsp;<a class="entrylistItemTitle" href="https://www.cnblogs.com/leozhanggg/p/12031433.html">【解决】error pulling image configuration: Get https:// ...... x509: certificate has expired or is not yet valid</a></span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><a class="entrylistItemTitle" href="https://www.cnblogs.com/leozhanggg/p/12023531.html">【解决】image ... could not be accessed on a registry to record its digest.</a>&nbsp;</span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><a class="entrylistItemTitle" href="https://www.cnblogs.com/leozhanggg/p/12023456.html">【解决】http: server gave HTTP response to HTTPS client</a></span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';"><a class="entrylistItemTitle" href="https://www.cnblogs.com/leozhanggg/p/12023429.html">【解决】OCI runtime exec failed......executable file not found in $PATH": unknown</a></span></p>
<p style="margin-left: 30px;"><span style="font-family: 'Microsoft YaHei';">更多报错解决方案持续更新中：<a class="entrylistItemTitle" href="https://www.cnblogs.com/leozhanggg/p/11796810.html">【解决】Docker Errors</a></span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p><span style="font-family: 'Microsoft YaHei';">&nbsp;</span></p>
<p class="postTitle"><span style="font-family: 'Microsoft YaHei';"><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆<strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong></strong></strong></strong><strong>☆<strong>☆<strong><strong><strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong></strong></strong></strong><strong>☆</strong><strong><br /></strong></strong></strong></span></p>
<p class="postTitle"><span style="font-family: 'Microsoft YaHei';"><strong>如果想<strong>更详细，</strong>更深入了解Docker，推荐 &gt;&gt;&gt;&nbsp;<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/codelove/p/10030439.html">Docker最全教程&mdash;&mdash;从理论到实战(一)</a></strong></span></p>
<p><span style="font-family: 'Microsoft YaHei';"><strong>如果转载请注明原文地址，谢谢 &gt;&gt;&gt;</strong>&nbsp;&nbsp;<a class="ng-star-inserted" href="https://www.cnblogs.com/leozhanggg/p/12039953.html" target="_blank">https://www.cnblogs.com/leozhanggg/p/12039953.html</a></span></p>
<p><span style="font-family: 'Microsoft YaHei';"><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆<strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong></strong></strong></strong><strong>☆<strong>☆<strong><strong><strong><strong><strong><strong>☆</strong><strong>☆</strong><strong>☆</strong></strong></strong></strong></strong></strong></strong></strong><strong>☆<strong>☆</strong></strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><br /></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
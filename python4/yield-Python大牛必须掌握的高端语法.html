<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修yield-Python大牛必须掌握的高端语法' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>yield-Python大牛必须掌握的高端语法</center></div><div class='banquan'>原文出处:本文由博客园博主地球守卫者提供。<br/>
原文连接:https://www.cnblogs.com/huangguifeng/p/11431033.html</div><br>
    <p><span style="font-family: 宋体;">小白：大牛哥，刚才看到有一个函数不使用</span>return<span style="font-family: 宋体;">返回结果，而是使用</span><span style="font-family: Calibri;">yield</span><span style="font-family: 宋体;">关键字返回结果</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">看不太明白，</span>Python<span style="font-family: 宋体;">中</span><span style="font-family: Calibri;">yield</span><span style="font-family: 宋体;">关键字的用途是什么</span>,<span style="font-family: 宋体;">它有什么作用</span>呀<span style="font-family: 宋体;">？</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛</span>: <span style="font-family: 宋体;">要想理解</span>yield<span style="font-family: 宋体;">的作用，你必须了解什么是生成器</span><span style="font-family: Calibri;">(generators)</span><span style="font-family: 宋体;">，</span>了解生成器之前(generators)你需要先去了解什么是<span style="font-family: 宋体;">可迭代对象</span>(iterables)<span style="font-family: 宋体;">。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛：小白啊，今天你大牛哥我刚好有空，给你说道说道这个</span>yield<span style="font-family: 宋体;">的作用。让你开开眼界，看看我大牛都是怎么写出牛逼代码的。</span></p>
<p>&nbsp;</p>
<p>小白：好呀好呀！！！</p>
<p>&nbsp;</p>
<p>大牛：我们先来看看什么是<strong>可迭代对象</strong><strong>(iterables)</strong>。</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">当你创建了一个列表，你可以遍历这个列表读取它的每一个元素，逐个读取列表元素</span>的过程<span style="font-family: 宋体;">称为迭代</span>(iteration)<span style="font-family: 宋体;">。</span></p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法0.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">上面代码中</span> mylist <span style="font-family: 宋体;">就是可迭代对象</span><span style="font-family: Calibri;">(iterables),</span><span style="font-family: 宋体;">使用列表推导式生成的对象也是可迭代对象</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">向这种可以使用</span>for ... in .. <span style="font-family: 宋体;">语法去迭代的对象都是可迭代对象。</span></p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法1.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛：小白，明白什么是可迭代对象了吗？你来说一说</span>Python<span style="font-family: 宋体;">里面有那些常见的可迭代对象。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">小白：明白了。可以使用</span>for...in...<span style="font-family: 宋体;">获取里面元素的对象就是可迭代对象，像字典，列表，元组，字符串都是可迭代对象。大牛哥我说的没错吧！</span></p>
<p><span style="font-family: 宋体;">大牛：给你</span>32<span style="font-family: 宋体;">个赞！！不错，一点就通。知道什么是可迭代对象后继续来看</span><strong><span style="font-family: 宋体;">生成器</span>(generators)</strong>。</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">生成器是迭代器</span>(iterators)<span style="font-family: 宋体;">，但是只能迭代一次，生成器不会将所有值存储在内存中，而是实时的生成这些值：</span></p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法2.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">将列推导式的</span> [] <span style="font-family: 宋体;">改成了 </span><span style="font-family: Calibri;">() </span><span style="font-family: 宋体;">其他并没有做任何改变，但是</span><span style="font-family: Calibri;">mygenerators</span><span style="font-family: 宋体;">已经不是列表，而是生成器。生成器迭代一次之后就不能再次迭代。</span><span style="font-family: 宋体;">计算出</span>0<span style="font-family: 宋体;">，然后并不保存结果和状态继续计算出</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，最后计算出</span><span style="font-family: Calibri;">4</span><span style="font-family: 宋体;">，逐一生成。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">这只是创建生成器的一种方式，另外一种方式就是我们今天的主角</span>yield<span style="font-family: 宋体;">关键字。</span></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法3.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>yield <span style="font-family: 宋体;">是一个类似 </span><span style="font-family: Calibri;">return </span><span style="font-family: 宋体;">的关键字。</span>当我们调用这个函数的时候并不是返回计算的结果，而是返回一个生成器。只有迭代这个生成器的时候才会计算结果。</p>
<p>&nbsp;</p>
<p>for i in mygenerator:<span style="font-family: 宋体;">第一次循环的时候函数执行到</span><span style="font-family: Calibri;">yield</span><span style="font-family: 宋体;">关键字位置，返回 </span><span style="font-family: Calibri;">i*i</span><span style="font-family: 宋体;">的值，然后将函数挂起</span><span style="font-family: Calibri;">(</span><span style="font-family: 宋体;">保存函数执行的状态</span><span style="font-family: Calibri;">)</span><span style="font-family: 宋体;">。</span><span style="font-family: Calibri;">for i in mygenerator:</span><span style="font-family: 宋体;">第二次循环的继续执行刚才的函数</span><span style="font-family: Calibri;">(</span><span style="font-family: 宋体;">挂起的位置</span><span style="font-family: Calibri;">)</span><span style="font-family: 宋体;">，也就是执行生成器里面的</span><span style="font-family: Calibri;">for</span><span style="font-family: 宋体;">循环，返回</span><span style="font-family: Calibri;">i*i</span><span style="font-family: 宋体;">的值，然后再次将函数挂起。直到生成器里没有值可以返回就结束。</span></p>
<p>&nbsp;</p>
<p>yield <span style="font-family: 宋体;">可以返回值，但是不会结束函数的执行，如果函数后面还有代码，同样是可以执行的。</span></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法4.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">上面的函数其实没有什么作用，只是用来演示生成器用法。生成器在那些地方会用到呢？</span></p>
<p><span style="font-family: 宋体;">比如需要创建一个非常大的列表直接使用列表推导式可能会导致内存被耗尽，这代码是创建不了列表，电脑内存不足以保存这个列表。</span></p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法5.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">但是用生成器可以创建成功，需要使用的时候再从生成器中取出。</span></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法6.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">对比下面这两段代码：求</span>1-10<span style="font-family: 宋体;">的偶数</span></p>
<p><span style="font-family: 宋体;">大部分人的写法是这样的</span></p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法7.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛的写法是这样子的</span></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="./images/yield-Python大牛必须掌握的高端语法8.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">同样的功能，但是用生成器要简便很多。</span></p>
<p>&nbsp;</p>
<p>yield&nbsp;<span style="font-family: 宋体;">的</span><span style="font-family: Arial;">好处：</span></p>
<p>&nbsp;</p>
<p>1.不会将所有数据取出来存入内存中；而是返回了一个对象；可以通过对象获取数据；用多少取多少，可以节省内<span style="font-family: 宋体;">存</span><span style="font-family: Arial;">空间。</span></p>
<p>2.除了能返回一个值，还不会终止循环的运行</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛：咳咳！一口气讲了这么多，差点就要把大牛我累挂了。小白同学，听明白了吗？</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">小白：哦，原来</span>yield<span style="font-family: 宋体;">是这么个用法。谢谢大牛哥！经大牛哥这么一说，我发现以前我写的代码很多都可以用</span><span style="font-family: Arial;">yield</span><span style="font-family: 宋体;">写成生成器啊！就拿你上面求偶数例子吧，采用</span><span style="font-family: Arial;">yield</span><span style="font-family: 宋体;">的写法效率是否比普通写法高呢？</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛：效率肯定比较高的，看下面的对比</span></p>
<p>&nbsp;</p>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="568">
<p class="pre"><strong>def </strong><strong>test</strong><strong>():</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>for </strong><strong>i </strong><strong>in </strong><strong>range</strong><strong>(</strong><strong>1</strong><strong>, </strong><strong>11000000</strong><strong>):</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>if </strong><strong>i % </strong><strong>2 </strong><strong>== </strong><strong>0</strong><strong>:</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>yield </strong><strong>i</strong><strong><br /></strong><strong>def </strong><strong>test1</strong><strong>():</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;result = []</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>for </strong><strong>i </strong><strong>in </strong><strong>range</strong><strong>(</strong><strong>1</strong><strong>, </strong><strong>11000000</strong><strong>):</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>if </strong><strong>i % </strong><strong>2 </strong><strong>== </strong><strong>0</strong><strong>:</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(i)</strong><strong><br /></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong><strong>return </strong><strong>result</strong></p>
<p>&nbsp;</p>

</td>

</tr>

</tbody>

</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>0.8925411701202393&nbsp;&nbsp;&nbsp;# <span style="font-family: 宋体;">生成器写法耗时</span></p>
<p>1.1444191932678223&nbsp;&nbsp;&nbsp;# <span style="font-family: 宋体;">普通写法耗时</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">小白：哇！老板就经常嫌弃我写的代码执行效率低，每次我都是拿</span>Python<span style="font-family: 宋体;">本身执行效率就比较低的理由去搪塞老板，原来还可以在这些细节上做优化的。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">小白：听大牛哥一席话，胜读一本</span>Python<span style="font-family: 宋体;">核心编程。老板叫我回去改</span><span style="font-family: Arial;">BUG</span><span style="font-family: 宋体;">了 </span><span style="font-family: Arial;">emememem</span><span style="font-family: 宋体;">。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛：坐看庭前花开花落，笑看天边云卷云舒。泡一杯咖啡，坐等下班。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">产品经理：大牛，你写的代码又出</span>BUG<span style="font-family: 宋体;">了，还不赶紧回来看看。你是不想下班了吧！</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">大牛：哎，来了，来了。</span></p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
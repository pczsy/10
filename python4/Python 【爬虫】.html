<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python 【爬虫】' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python 【爬虫】</center></div><div class='banquan'>原文出处:本文由博客园博主CH-TNT提供。<br/>
原文连接:https://www.cnblogs.com/CH-TNT/p/11438422.html</div><br>
    <p><span style="font-family: 黑体; font-size: 16px;">爬虫的工作原理</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">首先，爬虫可以模拟浏览器去向服务器发出请求；</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">其次，等服务器响应后，爬虫程序还可以代替浏览器帮我们解析数据；</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">接着，爬虫可以根据我们设定的规则批量提取相关数据，而不需要我们去手动提取；</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">最后，爬虫可以批量地把数据存储到本地</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 16px;">爬虫的步骤</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;<img src="./images/Python 【爬虫】0.png" alt="" /></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">第0步：获取数据。爬虫程序会根据我们提供的网址，向服务器发起请求，然后返回数据。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">第1步：解析数据。爬虫程序会把服务器返回的数据解析成我们能读懂的格式。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">第2步：提取数据。爬虫程序再从中提取出我们需要的数据。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">第3步：储存数据。爬虫程序把这些有用的数据保存起来，便于你日后的使用和分析。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;"><img src="./images/Python 【爬虫】1.png" alt="" /></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;<img src="./images/Python 【爬虫】2.png" alt="" /></span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#######################################################################</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Mac pip3 install requests</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Win pip install requests</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">requests库可以帮我们下载网页源代码、文本、图片，甚至是音频</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">import requests</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#引入requests库</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">res = requests.get('URL')</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#requests.get是在调用requests库中的get()方法，它向服务器发送了一个请求，括号里的参数是你需要的数据所在的网址，然后服务器对请求作出了响应。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#我们把这个响应返回的结果赋值在变量res上。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;"><img src="./images/Python 【爬虫】3.png" alt="" /></span></p>
<p><span style="font-family: 黑体; font-size: 16px;">##############################################################</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Response对象的常用属性</span></p>
<p><span style="font-family: 黑体; font-size: 16px;"><img src="./images/Python 【爬虫】4.png" alt="" /></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">response.status_code</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">print(变量.status_code)</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">用来检查请求是否正确响应，如果响应状态码为200，即代表请求成功</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">response.content</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">把Response对象的内容以二进制数据的形式返回，适用于图片、音频、视频的下载</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">import requests</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">res = requests.get('https://res.pandateacher.com/2018-12-18-10-43-07.png')</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#发出请求，并把返回的结果放在变量res中</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">pic=res.content</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#把Reponse对象的内容以二进制数据的形式返回</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">photo = open('ppt.jpg','wb')</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#新建了一个文件ppt.jpg，这里的文件没加路径，它会被保存在程序运行的当前目录下。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#图片内容需要以二进制wb读写。你在学习open()函数时接触过它。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">photo.write(pic)</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#获取pic的二进制内容</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">photo.close()</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#关闭文件</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">response.text</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">把Response对象的内容以字符串的形式返回，适用于文字、网页源代码的下载</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">import requests</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#引用requests库</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">res = requests.get('https://localprod.pandateacher.com/python-manuscript/crawler-html/sanguo.md')</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#下载《三国演义》第一回，我们得到一个对象，它被命名为res</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">novel=res.text</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#把Response对象的内容以字符串的形式返回</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">print(novel[:800])</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#现在，可以打印小说了，但考虑到整章太长，只输出800字看看就好。在关于列表的知识那里，你学过[:800]的用法。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">k = open('《三国演义》.txt', 'a+')</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">k.write(novel)</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">k.close()</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">response.encoding</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#语法：res.encoding=''</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">import requests</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#引用requests库</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">res = requests.get('https://localprod.pandateacher.com/python-manuscript/crawler-html/sanguo.md')</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#下载《三国演义》第一回，我们得到一个对象，它被命名为res</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">res.encoding='utf-8'</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#定义Reponse对象的编码为utf-8。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">novel=res.text</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#把Response对象的内容以字符串的形式返回</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">print(novel[:800])</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#打印小说的前800个字。</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">定义Response对象的编码</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">遇上文本的乱码问题，才考虑用res.encoding</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">目标数据本身是什么编码是未知的。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">用requests.get()发送请求后，我们会取得一个Response对象，其中，requests库会对数据的编码类型做出自己的判断。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">但是！这个判断有可能准确，也可能不准确。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">如果它判断准确的话，我们打印出来的response.text的内容就是正常的、没有乱码的，那就用不到res.encoding；</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">如果判断不准确，就会出现一堆乱码，那我们就可以去查看目标数据的编码，然后再用res.encoding把编码定义成和目标数据一致的类型即可。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;<img src="./images/Python 【爬虫】5.png" alt="" /></span></p>
<p>&nbsp;</p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;####################################################################</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Robots协议</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&ldquo;网络爬虫排除标准&rdquo;（Robots exclusion protocol），这个协议用来告诉爬虫，哪些页面是可以抓取的，哪些不可以。</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">#查看robots协议 网站的域名后加上/robots.txt</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">User-agent: &nbsp;Baiduspider #百度爬虫</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/article #允许访问 /article.htm</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/oshtml #允许访问 /oshtml.htm</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/ershou #允许访问 /ershou.htm</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: /$ #允许访问根目录，即淘宝主页</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Disallow: &nbsp;/product/ #禁止访问/product/</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Disallow: &nbsp;/ #禁止访问除 Allow 规定页面之外的其他所有页面</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">​</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">User-Agent: &nbsp;Googlebot #谷歌爬虫</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/article</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/oshtml</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/product #允许访问/product/</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/spu</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/dianpu</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/oversea</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/list</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: &nbsp;/ershou</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Allow: /$</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Disallow: &nbsp;/ #禁止访问除 Allow 规定页面之外的其他所有页面</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">​</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&hellip;&hellip; # 文件太长，省略了对其它爬虫的规定，想看全文的话，点击上面的链接</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">​</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">User-Agent: &nbsp;* #其他爬虫</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">Disallow: &nbsp;/ #禁止访问所有页面</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">爬取时，先看看网站的Robots协议是否允许你去爬取</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">限制好爬虫的速度</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
<p><span style="font-family: 黑体; font-size: 16px;">&nbsp;</span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python学习日记(十) 生成器和迭代器' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python学习日记(十) 生成器和迭代器</center></div><div class='banquan'>原文出处:本文由博客园博主Fantac提供。<br/>
原文连接:https://www.cnblogs.com/Fantac/p/11343409.html</div><br>
    <p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">使用dir()我们可以知道这个数据类型的内置函数有什么方法:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">print</span><span style="color: #000000;">(dir(int))　　
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(dir(bool))
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(dir([]))
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(dir({}))
</span><span style="color: #0000ff;">print</span>(dir(set))</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;"><strong>1.迭代器</strong></span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">iterable：可迭代的</span></p>
<p><span style="font-family: 'Microsoft YaHei';"><span style="font-size: 18px;">迭代就是将数据能够一个一个按顺序取出来</span></span></p>
<div class="cnblogs_code">
<pre><code>s = <span style="color: #800000;">'</span><span style="color: #800000;">abc</span><span style="color: #800000;">'</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(s))      <span style="color: #008000;">#</span><span style="color: #008000;">True</span>
li = [1,2<span style="color: #000000;">]
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(li))     <span style="color: #008000;">#</span><span style="color: #008000;">True</span>
b =<span style="color: #000000;"> False
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(b))      <span style="color: #008000;">#</span><span style="color: #008000;">False</span>
i = 123
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(i))      <span style="color: #008000;">#</span><span style="color: #008000;">False</span>
dic =<span style="color: #000000;"> {}
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(dic))    <span style="color: #008000;">#</span><span style="color: #008000;">True</span>
set1 =<span style="color: #000000;"> set()
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(set1))   <span style="color: #008000;">#</span><span style="color: #008000;">True</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">上面数据类型返回为真说明它是可以迭代的,反之是不可迭代的</span></p>
<p><span style="font-family: 'Microsoft YaHei';"><strong><span style="font-size: 18px;">可迭代协议:</span></strong></span></p>
<p><strong><span style="font-family: 宋体; font-size: 18px;">就是内部要有一个__iter__()来满足要求</span></strong></p>
<p><span style="font-family: 宋体; font-size: 18px;">当一个具有可迭代的数据执行__iter__()它将返回一个迭代器的内存地址</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">abc</span><span style="color: #800000;">'</span>.<span style="color: #800080;">__iter__</span>()) <span style="color: #008000;">#</span><span style="color: #008000;">&lt;str_iterator object at 0x005401F0&gt;</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">这里的iterator的意思是<strong>迭代器</strong></span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;"><strong>迭代器协议:</strong></span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">现在有一个列表我们来看看它本身和在执行了__iter__()之后的方法有什么不同:</span></p>
<div class="cnblogs_code">
<pre><code>li = [1,2,3,<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #0000ff;">print</span>(dir(li))  <span style="color: #008000;">#</span><span style="color: #008000;">['__add__', '__class__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__iadd__', '__imul__', '__init__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__', '__rmul__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'append', 'clear', 'copy', 'count', 'extend', 'index', 'insert', 'pop', 'remove', 'reverse', 'sort']</span>
<span style="color: #0000ff;">print</span>(dir(li.<span style="color: #800080;">__iter__</span>()))   <span style="color: #008000;">#</span><span style="color: #008000;">['__class__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__iter__', '__le__', '__length_hint__', '__lt__', '__ne__', '__new__', '__next__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setstate__', '__sizeof__', '__str__', '__subclasshook__']</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">求两者的差集</span><span style="color: #800000;">'''</span>
<span style="color: #0000ff;">print</span>(set(dir(li.<span style="color: #800080;">__iter__</span>())) - set(dir(li)))   <span style="color: #008000;">#</span><span style="color: #008000;">{'__length_hint__', '__setstate__', '__next__'}</span></pre>
</div>
<pre><code><span style="font-family: 宋体; font-size: 18px;">__length_hint__（）的作用是求元素的长度</span></pre>
<pre><code><span style="font-family: 宋体; font-size: 18px;">__setstate__（）的作用是指定索引值从哪里开始迭代</span></pre>
<pre><code><span style="font-family: 宋体; font-size: 18px;"><strong>__next__（）的作用可以让值一个一个的取出</strong></span><br /><br /><span style="font-family: 宋体; font-size: 18px;">在之前用到的for循环我们就是用__next__（）这种方法进行取值,现在我们可以模拟for来写一个函数:<br /></span></pre>
<div class="cnblogs_code">
<pre><code>li = [1,2,3,<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> getItem(li):
    iterator </span>= li.<span style="color: #800080;">__iter__</span><span style="color: #000000;">()
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
         </span><span style="color: #0000ff;">print</span>(iterator.<span style="color: #800080;">__next__</span><span style="color: #000000;">())
getItem(li)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 1</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 2</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 3</span><span style="color: #008000;">
#</span><span style="color: #008000;"> a</span><span style="color: #008000;">
#</span><span style="color: #008000;">StopIteration 如果找不到元素就会报错</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">如何处理掉这个异常?</span></p>
<div class="cnblogs_code">
<pre><code>li = [1,2,3,<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">]
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> getItem(li):
    iterator </span>= li.<span style="color: #800080;">__iter__</span><span style="color: #000000;">()
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;">:
            </span><span style="color: #0000ff;">print</span>(iterator.<span style="color: #800080;">__next__</span><span style="color: #000000;">())
        </span><span style="color: #0000ff;">except</span><span style="color: #000000;"> StopIteration:
            </span><span style="color: #0000ff;">break</span><span style="color: #000000;">
getItem(li)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 1</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 2</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 3</span><span style="color: #008000;">
#</span><span style="color: #008000;"> a</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">迭代器遵循迭代器协议:必须要有__iter__()和__next__()</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">迭代器的好处:</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">　<span style="font-family: 宋体;">　a.从容器类型中一个一个的取值,会把所有的值都取到</span></span></p>
<p><span style="font-family: 宋体; font-size: 18px;">　　b.节省内存的空间</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">　　　　　</span><span style="font-family: 宋体; font-size: 18px;">迭代器并不会在内存中占用一大块内存,而是随着循环每次生成一个,每一次使用__next__()来给值</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;"><strong>range():</strong></span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">print</span>(range(10000000))  <span style="color: #008000;">#</span><span style="color: #008000;">range(0, 10000000)</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">实际上range()在调用的时候并没有真正生成这么多的值,如果真的生成的话那么内存可能会溢出</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__iter__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(range(10)))     <span style="color: #008000;">#</span><span style="color: #008000;">True   </span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">__next__</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> dir(range(10)))     <span style="color: #008000;">#</span><span style="color: #008000;">False</span>
<span style="color: #0000ff;">from</span> collections <span style="color: #0000ff;">import</span><span style="color: #000000;"> Iterable
</span><span style="color: #0000ff;">from</span> collections <span style="color: #0000ff;">import</span><span style="color: #000000;"> Iterator
</span><span style="color: #0000ff;">print</span>(isinstance(range(10),Iterable))    <span style="color: #008000;">#</span><span style="color: #008000;">True  是一个可迭代对象</span>
<span style="color: #0000ff;">print</span>(isinstance(range(10),Iterator))    <span style="color: #008000;">#</span><span style="color: #008000;">False 在执行后得到的结果并不是一个迭代器</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;"><strong>迭代器总结:</strong></span></p>
<p><span style="font-family: 宋体; font-size: 18px;">1.可以被for循环的都是可迭代的</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">2.可迭代的内部都有__iter__()方法</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">3.只要是迭代器一定可以迭代</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">4.可迭代的变量.__iter__()方法可以得到一个迭代器<br /></span></p>
<p><span style="font-family: 宋体; font-size: 18px;">5.迭代器中的__next__()方法可以一个一个的获取值</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">6.for循环实际上就是在使用迭代器</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei';"><strong><span style="font-size: 18px;">2.生成器</span></strong></span></p>
<p><span style="font-family: 'Microsoft YaHei';"><span style="font-size: 18px;">生成器函数</span></span></p>
<p><span style="font-family: 宋体;"><span style="font-size: 18px;">本质上就是我们自己写的函数,只要含有yield关键字的函数就是生成器函数,yield不能和return共用且需要写在函数内部</span></span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span> generator():        <span style="color: #008000;">#</span><span style="color: #008000;">生成器函数</span>
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">yield</span> 5<span style="color: #000000;">
ret </span>= generator()       <span style="color: #008000;">#</span><span style="color: #008000;">ret是一个生成器</span>
<span style="color: #0000ff;">print</span>(ret)              <span style="color: #008000;">#</span><span style="color: #008000;">&lt;generator object generator at 0x00503F00&gt;</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">生成器函数每次执行的时候会得到一个生成器作为返回值</span></p>
<p><strong><span style="font-family: 宋体; font-size: 18px;">如果要返回函数值:</span></strong></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span> generator():        <span style="color: #008000;">#</span><span style="color: #008000;">生成器函数</span>
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">yield</span> 5
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">b</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">yield</span> 4<span style="color: #000000;">
g </span>= generator()        <span style="color: #008000;">#g</span><span style="color: #008000;">是一个生成器</span>
<span style="color: #0000ff;">print</span>(g)               <span style="color: #008000;">#</span><span style="color: #008000;">&lt;generator object generator at 0x00503F00&gt;</span>
ret = g.<span style="color: #800080;">__next__</span><span style="color: #000000;">()
</span><span style="color: #0000ff;">print</span>(ret)              <span style="color: #008000;">#</span><span style="color: #008000;">a</span>
                        <span style="color: #008000;">#</span><span style="color: #008000;">5</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">---------</span><span style="color: #800000;">'</span><span style="color: #000000;">)
ret </span>= g.<span style="color: #800080;">__next__</span><span style="color: #000000;">()
</span><span style="color: #0000ff;">print</span>(ret)              <span style="color: #008000;">#</span><span style="color: #008000;">b</span>
                        <span style="color: #008000;">#</span><span style="color: #008000;">4</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">执行顺序:</span></p>
<p><img src="./images/Python学习日记(十) 生成器和迭代器0.png" alt="" width="917" height="483" /></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">使用for循环遍历生成器:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span> generator():        <span style="color: #008000;">#</span><span style="color: #008000;">生成器函数</span>
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">yield</span> 5
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">b</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">yield</span> 4
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">c</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">yield</span> 6<span style="color: #000000;">
g </span>= generator()       <span style="color: #008000;">#g</span><span style="color: #008000;">是一个生成器</span>
<span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g:
    </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(i)    
</span><span style="color: #008000;">#</span><span style="color: #008000;"> a</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 5</span><span style="color: #008000;">
#</span><span style="color: #008000;"> b</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 4</span><span style="color: #008000;">
#</span><span style="color: #008000;"> c</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 6</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">send():</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">send()和__next__()都有获取下一个值的功能,但send()在获取下一个值的时候可以给上一个yield的位置传递一个数据,让用户进行接收</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">send()在使用时需注意在第一次使用生成器时需用__next__()获取下一个值并且最后一个yield不能接受外部的值</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span> generator():         <span style="color: #008000;">#</span><span style="color: #008000;">生成器函数</span>
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>)           <span style="color: #008000;">#</span><span style="color: #008000;">1</span>
    content = <span style="color: #0000ff;">yield</span> 1    <span style="color: #008000;">#</span><span style="color: #008000;">2</span>
    <span style="color: #0000ff;">print</span>(content,<span style="color: #800000;">'</span><span style="color: #800000;">= 1</span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">3</span>
    <span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">b</span><span style="color: #800000;">'</span>)           <span style="color: #008000;">#</span><span style="color: #008000;">4</span>
    content2 = <span style="color: #0000ff;">yield</span> 2   <span style="color: #008000;">#</span><span style="color: #008000;">5</span>
    <span style="color: #0000ff;">print</span>(content2,<span style="color: #800000;">'</span><span style="color: #800000;">= 2</span><span style="color: #800000;">'</span>)<span style="color: #008000;">#</span><span style="color: #008000;">6</span>
    <span style="color: #0000ff;">yield</span> 3              <span style="color: #008000;">#</span><span style="color: #008000;">7</span>
<span style="color: #000000;">
g </span>= generator()          <span style="color: #008000;">#</span><span style="color: #008000;">生成器g</span>
ret = g.<span style="color: #800080;">__next__</span>()       <span style="color: #008000;">#</span><span style="color: #008000;">执行1和2的右边语句</span>
<span style="color: #0000ff;">print</span>(ret)               <span style="color: #008000;">#</span><span style="color: #008000;">返回yield的值1</span>
ret = g.send(<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>)        <span style="color: #008000;">#</span><span style="color: #008000;">传递给yield一个值'a'让content接收，然后执行3,4语句</span>
<span style="color: #0000ff;">print</span>(ret)               <span style="color: #008000;">#</span><span style="color: #008000;">返回yield的值2</span>
ret = g.send(<span style="color: #800000;">'</span><span style="color: #800000;">b</span><span style="color: #800000;">'</span>)        <span style="color: #008000;">#</span><span style="color: #008000;">传递给yield一个值'b'让content2接收，然后执行6语句 yield再返回一个值3</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(ret)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> a</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 1</span><span style="color: #008000;">
#</span><span style="color: #008000;"> a = 1</span><span style="color: #008000;">
#</span><span style="color: #008000;"> b</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 2</span><span style="color: #008000;">
#</span><span style="color: #008000;"> b = 2</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 3</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">移动平均值例子:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span> average():          <span style="color: #008000;">#</span><span style="color: #008000;">定义一个平均值的生成器函数</span>
    sum =<span style="color: #000000;"> 0
    count </span>=<span style="color: #000000;"> 0
    avg </span>=<span style="color: #000000;"> 0
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
        num </span>= <span style="color: #0000ff;">yield</span><span style="color: #000000;"> avg
        sum </span>+=<span style="color: #000000;"> num
        count </span>+= 1<span style="color: #000000;">
        avg </span>= sum/<span style="color: #000000;">count

avg_g </span>= average()       <span style="color: #008000;">#</span><span style="color: #008000;">取得生成器</span>
avg_g.<span style="color: #800080;">__next__</span><span style="color: #000000;">()
avg1 </span>= avg_g.send(int(input()))     <span style="color: #008000;">#</span><span style="color: #008000;">10</span>
avg1 = avg_g.send(int(input()))     <span style="color: #008000;">#</span><span style="color: #008000;">20</span>
<span style="color: #0000ff;">print</span>(avg1)                         <span style="color: #008000;">#</span><span style="color: #008000;">15</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">预激装饰器的生成器</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> wrapper(func):
    </span><span style="color: #0000ff;">def</span> inner(*args,**<span style="color: #000000;">kwargs):
        g </span>= func(*args,**<span style="color: #000000;">kwargs)
        g.</span><span style="color: #800080;">__next__</span><span style="color: #000000;">()
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> g
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> inner
@wrapper                </span><span style="color: #008000;">#</span><span style="color: #008000;">wrapper = wrapper(func)</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> avgerage():
    sum </span>=<span style="color: #000000;"> 0
    count </span>=<span style="color: #000000;"> 0
    avg </span>=<span style="color: #000000;"> 0
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
        num </span>= <span style="color: #0000ff;">yield</span><span style="color: #000000;"> avg
        sum </span>+=<span style="color: #000000;"> num
        count </span>+= 1<span style="color: #000000;">
        avg </span>= sum/<span style="color: #000000;">count
avg_g </span>=<span style="color: #000000;"> avgerage()
</span><span style="color: #0000ff;">print</span>(avg_g.send(10<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(avg_g.send(20<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(avg_g.send(30))</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">yiled form</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">如何将字符串一个一个的去返回？</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">一般方法:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> generator():
    a </span>= <span style="color: #800000;">'</span><span style="color: #800000;">abcde</span><span style="color: #800000;">'</span><span style="color: #000000;">
    b </span>= <span style="color: #800000;">'</span><span style="color: #800000;">efdgh</span><span style="color: #800000;">'</span>
    <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> a:
        </span><span style="color: #0000ff;">yield</span><span style="color: #000000;"> i
    </span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> b:
        </span><span style="color: #0000ff;">yield</span><span style="color: #000000;"> i
g </span>=<span style="color: #000000;"> generator()
</span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g:
    </span><span style="color: #0000ff;">print</span>(i)</pre>
</div>
<p><span style="font-size: 18px; font-family: 宋体;">用yiled form:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> generator():
    a </span>= <span style="color: #800000;">'</span><span style="color: #800000;">abcde</span><span style="color: #800000;">'</span><span style="color: #000000;">
    b </span>= <span style="color: #800000;">'</span><span style="color: #800000;">efdgh</span><span style="color: #800000;">'</span>
    <span style="color: #0000ff;">yield</span> <span style="color: #0000ff;">from</span><span style="color: #000000;"> a
    </span><span style="color: #0000ff;">yield</span> <span style="color: #0000ff;">from</span><span style="color: #000000;"> b
g </span>=<span style="color: #000000;"> generator()
</span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g:
    </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(i)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> a</span><span style="color: #008000;">
#</span><span style="color: #008000;"> b</span><span style="color: #008000;">
#</span><span style="color: #008000;"> c</span><span style="color: #008000;">
#</span><span style="color: #008000;"> d</span><span style="color: #008000;">
#</span><span style="color: #008000;"> e</span><span style="color: #008000;">
#</span><span style="color: #008000;"> e</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f</span><span style="color: #008000;">
#</span><span style="color: #008000;"> d</span><span style="color: #008000;">
#</span><span style="color: #008000;"> g</span><span style="color: #008000;">
#</span><span style="color: #008000;"> h</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">监听文件例子:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> tail(filename):
    f </span>= open(filename,encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
        line </span>=<span style="color: #000000;"> f.readline()
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> line.strip():
             </span><span style="color: #0000ff;">yield</span><span style="color: #000000;"> line.strip()
g </span>= tail(<span style="color: #800000;">'</span><span style="color: #800000;">tail</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g:
    </span><span style="color: #0000ff;">if</span> <span style="color: #800000;">'</span><span style="color: #800000;">python</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span><span style="color: #000000;"> i:
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">******</span><span style="color: #800000;">'</span><span style="color: #000000;">,i)   
</span><span style="color: #008000;">#</span><span style="color: #008000;"> ****** python</span><span style="color: #008000;">
#</span><span style="color: #008000;"> ****** asd python</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">3.推导式</span></strong></p>
<p><span style="font-family: 宋体;"><span style="font-size: 18px;">优点:基本不消耗内存</span></span></p>
<p><span style="font-family: 宋体;"><span style="font-size: 18px;">语法:以列表推导式为例</span></span></p>
<p><span style="font-family: 宋体;"><span style="font-size: 18px;">　　　(1)遍历元素进行挨个处理:</span></span><span style="font-family: 宋体;"><span style="font-size: 18px;">[每一个元素或者是和元素相关的操作 for 元素 in 可迭代数据类型]　　</span></span></p>
<p><strong><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">　　　</span></strong><span style="font-family: 宋体; font-size: 18px;">(2)筛选功能:[满足条件的元素的相关操作 for 元素 in 可迭代数据类型 if 元素相关的条件]</span></p>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">1.列表推导式</span></p>
<div class="cnblogs_code">
<pre><code>li = [i*i <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span> range(5<span style="color: #000000;">)]
</span><span style="color: #0000ff;">print</span>(li)   <span style="color: #008000;">#</span><span style="color: #008000;">[0, 1, 4, 9, 16]</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 宋体; font-size: 18px;">找到50以内能被5整除的数:</span></p>
<div class="cnblogs_code">
<pre><code>li = [i <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span> range(50) <span style="color: #0000ff;">if</span> i % 5 ==<span style="color: #000000;"> 0]
</span><span style="color: #0000ff;">print</span>(li)   <span style="color: #008000;">#</span><span style="color: #008000;">[0, 5, 10, 15, 20, 25, 30, 35, 40, 45]</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">找到两个列表中都含有一个'x'的元素</span></p>
<div class="cnblogs_code">
<pre><code>names = [[<span style="color: #800000;">'</span><span style="color: #800000;">xasd</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">12sa</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">xa</span><span style="color: #800000;">'</span>],[<span style="color: #800000;">'</span><span style="color: #800000;">564</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">566</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">x233</span><span style="color: #800000;">'</span><span style="color: #000000;">]]
li </span>= [name <span style="color: #0000ff;">for</span> lst <span style="color: #0000ff;">in</span> names <span style="color: #0000ff;">for</span> name <span style="color: #0000ff;">in</span> lst <span style="color: #0000ff;">if</span> name.count(<span style="color: #800000;">'</span><span style="color: #800000;">x</span><span style="color: #800000;">'</span>) == 1<span style="color: #000000;">]
</span><span style="color: #0000ff;">print</span>(li)   <span style="color: #008000;">#</span><span style="color: #008000;">['xasd', 'xa', 'x233']</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">2.生成器推导式</span></p>
<div class="cnblogs_code">
<pre><code>g = (i*2 <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span> [1,5,6,7<span style="color: #000000;">])
</span><span style="color: #0000ff;">print</span>(g)    <span style="color: #008000;">#</span><span style="color: #008000;">&lt;generator object &lt;genexpr&gt; at 0x006E4F00&gt;</span>
<span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g:
    </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(i)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 2</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 10</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 12</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 14</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">3.字典推导式</span></p>
<p><span style="font-family: 宋体; font-size: 18px;"><span style="font-family: 'Microsoft YaHei';"><span style="font-family: 宋体;">将字典的键值互换</span></span></span></p>
<div class="cnblogs_code">
<pre><code>dict = {<span style="color: #800000;">'</span><span style="color: #800000;">key1</span><span style="color: #800000;">'</span> : <span style="color: #800000;">'</span><span style="color: #800000;">value1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">key2</span><span style="color: #800000;">'</span> : <span style="color: #800000;">'</span><span style="color: #800000;">value2</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">key3</span><span style="color: #800000;">'</span> : <span style="color: #800000;">'</span><span style="color: #800000;">value3</span><span style="color: #800000;">'</span><span style="color: #000000;">}
</span><span style="color: #0000ff;">print</span>(dict)         <span style="color: #008000;">#</span><span style="color: #008000;">{'key3': 'value3', 'key2': 'value2', 'key1': 'value1'}</span>
new_dict = {dict[i] : i <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> dict}
</span><span style="color: #0000ff;">print</span>(new_dict)     <span style="color: #008000;">#</span><span style="color: #008000;">{'value2': 'key2', 'value1': 'key1', 'value3': 'key3'}</span>&nbsp;</pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">合并大小写对应的value值,再将键都统一成小写</span></p>
<div class="cnblogs_code">
<pre><code>dict = {<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span> : 1,<span style="color: #800000;">'</span><span style="color: #800000;">b</span><span style="color: #800000;">'</span> : 2,<span style="color: #800000;">'</span><span style="color: #800000;">A</span><span style="color: #800000;">'</span> : 3,<span style="color: #800000;">'</span><span style="color: #800000;">c</span><span style="color: #800000;">'</span> : 4<span style="color: #000000;">}
new_dict </span>= {k.lower() : dict.get(k.lower(),0) + dict.get(k.upper(),0) <span style="color: #0000ff;">for</span> k <span style="color: #0000ff;">in</span> dict}    <span style="color: #008000;">#</span><span style="color: #008000;">如果没有找到这个值就返回0</span>
<span style="color: #0000ff;">print</span>(new_dict) <span style="color: #008000;">#</span><span style="color: #008000;">{'c': 4, 'b': 2, 'a': 4}</span></pre>
</div>
<p><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">4.集合推导式</span></p>
<p><span style="font-family: 宋体; font-size: 18px;">具有去重复的功能</span></p>
<div class="cnblogs_code">
<pre><code>set = {x**2 <span style="color: #0000ff;">for</span> x <span style="color: #0000ff;">in</span> range(-5,6<span style="color: #000000;">)}
</span><span style="color: #0000ff;">print</span>(set)  <span style="color: #008000;">#</span><span style="color: #008000;">{0, 1, 4, 9, 16, 25}</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><span style="font-family: 'Microsoft YaHei'; font-size: 18px;">4.相关面试题</span></strong></p>
<p><span style="font-family: 宋体; font-size: 18px;">例一:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> generator():
    </span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span> range(4<span style="color: #000000;">):
        </span><span style="color: #0000ff;">yield</span><span style="color: #000000;"> i

g </span>=<span style="color: #000000;"> generator()
g1 </span>= (i <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g)
g2 </span>= (i <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g1)
</span><span style="color: #0000ff;">print</span>(list(g1))         <span style="color: #008000;">#</span><span style="color: #008000;">[0, 1, 2, 3]       </span>
<span style="color: #0000ff;">print</span>(list(g2))         <span style="color: #008000;">#</span><span style="color: #008000;">[]       因为g2是往g1去拿值,但是g1已经从g用for循环遍历完了值,所以g2是一个空的列表</span></pre>
</div>
<p><span style="font-family: 宋体; font-size: 18px;">例二:</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> add(n,i):
    </span><span style="color: #0000ff;">return</span> n+<span style="color: #000000;">i
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> test():
    </span><span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span> range(4):  <span style="color: #008000;">#</span><span style="color: #008000;">0 1 2 3</span>
        <span style="color: #0000ff;">yield</span><span style="color: #000000;"> i
g </span>=<span style="color: #000000;"> test()
</span><span style="color: #0000ff;">for</span> n <span style="color: #0000ff;">in</span> [1,10<span style="color: #000000;">]:
    g </span>= (add(n,i) <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> g)
</span><span style="color: #800000;">'''</span><span style="color: #800000;">
n = 1
g = (add(n,i) for i in g)   这里的代码因为跑过了 就不执行
n = 10
g = (add(n,i) for i in (add(n,i) for i in test()))
所以
g = (add(10,i) for i in (add(10,i) for i in [0,1,2,3]))
g = (add(10,i) for i in (10,11,12,13)
g = (20,21,22,23)
</span><span style="color: #800000;">'''</span>
<span style="color: #0000ff;">print</span>(list(g))           <span style="color: #008000;">#</span><span style="color: #008000;">[20, 21, 22, 23]     当没有调用的时候上面的代码都不会执行</span></pre>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
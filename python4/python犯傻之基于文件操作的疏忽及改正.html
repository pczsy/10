<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修python犯傻之基于文件操作的疏忽及改正' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>python犯傻之基于文件操作的疏忽及改正</center></div><div class='banquan'>原文出处:本文由博客园博主小拖拉滴赵某某提供。<br/>
原文连接:https://www.cnblogs.com/zrh918/p/11708008.html</div><br>
    <p><span style="font-size: 18px;"><strong>题目：</strong></span></p>
<p style="margin-left: 30px;">基于文件实现用户登录程序，提示用户输入用户名和密码，检查用户名是否存在，以及用户名密码是否正确</p>
<p style="margin-left: 30px;">保存密码的文件叫user.txt，内容：</p>
<p style="margin-left: 30px;"><img src="./images/python犯傻之基于文件操作的疏忽及改正0.png" alt="" /></p>
<p style="margin-left: 30px;"><strong>&nbsp; |&nbsp; 作分隔符</strong></p>
<p><strong><br /><span style="font-size: 18px; background-color: #ffcc00;">阶段一：</span></strong></p>
<p style="margin-left: 30px;">自己第一次的答案：</p>
<div class="cnblogs_code" style="margin-left: 60px;">
<pre><code><span style="font-size: 16px;"><span style="color: #008080;"> 1</span> list_1 =<span style="color: #000000;"> []
</span><span style="color: #008080;"> 2</span> with open(<span style="color: #800000;">"</span><span style="color: #800000;">user.txt</span><span style="color: #800000;">"</span>,mode=<span style="color: #800000;">"</span><span style="color: #800000;">r+</span><span style="color: #800000;">"</span>,encoding=<span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span><span style="color: #000000;">) as count:
</span><span style="color: #008080;"> 3</span>     user = input(<span style="color: #800000;">"</span><span style="color: #800000;">用户名：</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>     passwd = input(<span style="color: #800000;">"</span><span style="color: #800000;">密码：</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> count:
</span><span style="color: #008080;"> 6</span>         val_1 = i.strip().split(<span style="color: #800000;">"</span><span style="color: #800000;">|</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        list_1.append(val_1[0])
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">if</span> user <span style="color: #0000ff;">in</span><span style="color: #000000;"> list_1:
</span><span style="color: #008080;"> 9</span>         <span style="color: #0000ff;">for</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> count:
</span><span style="color: #008080;">10</span>             val = line.strip().split(<span style="color: #800000;">"</span><span style="color: #800000;">|</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">11</span>             <span style="color: #0000ff;">if</span> user ==<span style="color: #000000;"> val[0] :
</span><span style="color: #008080;">12</span>                 <span style="color: #0000ff;">if</span> passwd == val[1<span style="color: #000000;">]:
</span><span style="color: #008080;">13</span>                     <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">登陆成功</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">14</span>                 <span style="color: #0000ff;">else</span><span style="color: #000000;">:
</span><span style="color: #008080;">15</span>                     <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">密码错误</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">16</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;">:
</span><span style="color: #008080;">17</span>         <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">无此用户名</span><span style="color: #800000;">"</span>)</span></pre>
</div>
<p style="margin-left: 60px;">输出结果：</p>
<p style="margin-left: 60px;">（1）可以顺利运行检查用户名不存在的程序</p>
<p style="margin-left: 60px;"><img src="./images/python犯傻之基于文件操作的疏忽及改正1.png" alt="" width="276" height="140" /></p>
<p style="margin-left: 60px;">&nbsp;（2）但是当输入正确的用户名和答案的时候，出现了问题</p>
<p style="margin-left: 60px;"><img src="./images/python犯傻之基于文件操作的疏忽及改正2.png" alt="" width="361" height="117" /></p>
<p><span style="color: #ff0000; background-color: #ffff00;"><strong>心里os： 明明我输入的用户名和密码是正确的为什么没有print正确的结果，而是没有任何值呢，我****，到底哪里出现了问题</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00;"><strong>我检查了半天，还是没有检查出来，就开始心烦气躁，开始怀疑自己是不是不适合编程。</strong></span></p>
<p><strong>等到冷静下来的时候，原来才发现是指针出现了问题，第5行的for循环完成以后，指针已经是在最后的位置了，所以当第9行继续遍历时，就没有内容了。</strong></p>
<p>oh，我天，我想杀死自己，这明明就是自己不细心导致的呀，最后只能说自己是第一次写文件的操作，可以理解来掩盖过去。</p>
<p><span style="background-color: #ffcc00; font-size: 18px;"><strong>阶段二：</strong></span></p>
<p style="margin-left: 60px;">之后我进行了改正，并对<strong>11-15行</strong>进行了自认为的优化，下面是优化后的代码：</p>
<div class="cnblogs_code" style="margin-left: 60px;">
<pre><code><span style="font-size: 16px;"><span style="color: #008080;"> 1</span> list_1 =<span style="color: #000000;"> []
</span><span style="color: #008080;"> 2</span> with open(<span style="color: #800000;">"</span><span style="color: #800000;">user.txt</span><span style="color: #800000;">"</span>,mode=<span style="color: #800000;">"</span><span style="color: #800000;">r+</span><span style="color: #800000;">"</span>,encoding=<span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span><span style="color: #000000;">) as count:
</span><span style="color: #008080;"> 3</span>     user = input(<span style="color: #800000;">"</span><span style="color: #800000;">用户名：</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>     passwd = input(<span style="color: #800000;">"</span><span style="color: #800000;">密码：</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> count:
</span><span style="color: #008080;"> 6</span>         val_1 = i.strip().split(<span style="color: #800000;">"</span><span style="color: #800000;">|</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        list_1.append(val_1[0])
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">if</span> user <span style="color: #0000ff;">in</span><span style="color: #000000;"> list_1:
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">        count.seek(0)
</span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">for</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> count:
</span><span style="color: #008080;">11</span>             val = line.strip().split(<span style="color: #800000;">"</span><span style="color: #800000;">|</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">if</span> user == val[0] <span style="color: #0000ff;">and</span> passwd == val[1]:<span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">登陆成功</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">13</span>             <span style="color: #0000ff;">else</span><span style="color: #000000;">:
</span><span style="color: #008080;">14</span>                 <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">密码错误</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">15</span>                 <span style="color: #0000ff;">break</span>
<span style="color: #008080;">16</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;">:
</span><span style="color: #008080;">17</span>         <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">无此用户名</span><span style="color: #800000;">"</span>)</span></pre>
</div>
<p style="margin-left: 60px;">我在第9行将指针调整了，然后对12--15行的判断用户名密码是否正确做了优化，下面看看输出结果</p>
<p style="margin-left: 60px;">输出结果：</p>
<p style="margin-left: 60px;">（1）可以顺利运行检查用户名不存在的程序</p>
<p style="margin-left: 60px;"><img src="./images/python犯傻之基于文件操作的疏忽及改正3.png" alt="" /></p>
<p style="margin-left: 60px;">&nbsp;（2）但当我输入正确的用户名密码时，打脸时刻来了</p>
<p style="margin-left: 60px;"><img src="./images/python犯傻之基于文件操作的疏忽及改正4.png" alt="" /></p>
<p><span style="background-color: #ffcc00; color: #ff0000;">&nbsp;<strong>心里os：我明明输入正确的用户密码为啥又出错了，哎呀我烦死了，啥嘛，为了一个简单的题浪费我一个多小时，哎，气死我了</strong></span></p>
<p>等待我心情平复之后，仔细审阅发现，原来是自己第13行的else级别不对，因为在题目中可以看到user.txt第一行数据是</p>
<p><span style="color: #ff0000;">用户名|密码</span></p>
<p>所以第10行的for循环之后，第一个出现的是&nbsp; <span style="color: #ff0000;">用户名|密码</span>&nbsp; 这个数据，我输入的又是zrh_ 1 后面第12行的语句中有一个 and 语句</p>
<p>and具有惰性求值，我输入user不等于 <span style="color: #ff0000;">用户名<span style="color: #000000;">，就会执行第13行的else了，于是乎便出现了问题</span></span></p>
<p><strong><span style="color: #ff0000; font-size: 18px; background-color: #ffcc00;"><span style="color: #000000;">阶段三：</span></span></strong></p>
<p style="margin-left: 60px;"><span style="color: #ff0000;"><span style="color: #000000;">改正之后做了可行性的代码优化</span></span></p>
<div class="cnblogs_code" style="margin-left: 60px;">
<pre><code><span style="font-size: 16px;"><span style="color: #008080;"> 1</span> list_1 =<span style="color: #000000;"> []
</span><span style="color: #008080;"> 2</span> with open(<span style="color: #800000;">"</span><span style="color: #800000;">user.txt</span><span style="color: #800000;">"</span>,mode=<span style="color: #800000;">"</span><span style="color: #800000;">r+</span><span style="color: #800000;">"</span>,encoding=<span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span><span style="color: #000000;">) as count:
</span><span style="color: #008080;"> 3</span>     user = input(<span style="color: #800000;">"</span><span style="color: #800000;">用户名：</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 4</span>     passwd = input(<span style="color: #800000;">"</span><span style="color: #800000;">密码：</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 5</span>     <span style="color: #0000ff;">for</span> i <span style="color: #0000ff;">in</span><span style="color: #000000;"> count:
</span><span style="color: #008080;"> 6</span>         val_1 = i.strip().split(<span style="color: #800000;">"</span><span style="color: #800000;">|</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        list_1.append(val_1[0])
</span><span style="color: #008080;"> 8</span>     <span style="color: #0000ff;">if</span> user <span style="color: #0000ff;">in</span><span style="color: #000000;"> list_1:
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">        count.seek(0)
</span><span style="color: #008080;">10</span>         <span style="color: #0000ff;">for</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> count:
</span><span style="color: #008080;">11</span>             val = line.strip().split(<span style="color: #800000;">"</span><span style="color: #800000;">|</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">12</span>             <span style="color: #0000ff;">if</span> user ==<span style="color: #000000;"> val[0]:
</span><span style="color: #008080;">13</span>                 <span style="color: #0000ff;">if</span> passwd == val[1]:<span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">登陆成功</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">14</span>                 <span style="color: #0000ff;">else</span>:<span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">密码错误</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008080;">15</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;">:
</span><span style="color: #008080;">16</span>         <span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">无此用户名</span><span style="color: #800000;">"</span>)</span></pre>
</div>
<p>ok，这个题到此结束</p>
<p><span style="font-size: 18px; background-color: #ffcc00;"><strong>感悟：以后遇到问题要心平气和的排查问题，千万不要怀疑自己不适合干编程</strong></span></p>
<p><span style="font-size: 18px; background-color: #ffcc00;"><strong>牢记文件操作时的指针位置对程序的影响，牢记for循环后的else的逻辑</strong></span></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
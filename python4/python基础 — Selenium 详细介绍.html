<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修python基础 — Selenium 详细介绍' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>python基础 — Selenium 详细介绍</center></div><div class='banquan'>原文出处:本文由博客园博主羊肉串552提供。<br/>
原文连接:https://www.cnblogs.com/chen-jun552/p/11714039.html</div><br>
    <h2>一、Selenium+Python环境搭建及配置</h2>
<h3>1.1 selenium 介绍</h3>
<p>selenium 是一个 web 的自动化测试工具，不少学习功能自动化的同学开始首选 selenium ，因为它相比 QTP 有诸多有点：</p>
<ul>
<li>免费，也不用再为破解 QTP 而大伤脑筋</li>
<li>小巧，对于不同的语言它只是一个包而已，而 QTP 需要下载安装1个多 G 的程序。</li>
<li>这也是最重要的一点，不管你以前更熟悉 C、 java、ruby、python、或都是 C# ，你都可以通过 selenium 完成自动化测试，而 QTP 只支持 VBS</li>
<li>支持多平台：windows、linux、MAC ，支持多浏览器：ie、ff、safari、opera、chrome</li>
<li>支持分布式测试用例的执行，可以把测试用例分布到不同的测试机器的执行，相当于分发机的功能。</li>
</ul>
<p>官方文档：</p>
<ul>
<li><a href="https://selenium-python.readthedocs.io/index.html" rel="nofollow" target="_blank">https://selenium-python.readthedocs.io/index.html</a></li>
<li><a href="https://seleniumhq.github.io/selenium/docs/api/py/api.html" rel="nofollow" target="_blank">https://seleniumhq.github.io/selenium/docs/api/py/api.html</a></li>
</ul>
<h3>1.2 selenium+Python环境配置</h3>
<p>前提条件：已安装好Python开发环境（推荐安装Python3.5及以上版本）</p>
<p>安装步骤：</p>
<ol>
<li>
<p>安装selenium<br />Win：<code>pip install selenium</code><br />Mac:<code>pip3 install selenium</code></p>

</li>
<li>
<p>安装webdriver<br />各大浏览器webdriver地址可参见：<a href="https://docs.seleniumhq.org/download/" rel="nofollow" target="_blank">https://docs.seleniumhq.org/download/</a><br />Firefox：<a href="https://github.com/mozilla/geckodriver/releases/" rel="nofollow" target="_blank">https://github.com/mozilla/geckodriver/releases/</a><br />Chrome：<a href="https://sites.google.com/a/chromium.org/chromedriver/" rel="nofollow" target="_blank">https://sites.google.com/a/chromium.org/chromedriver/</a>&nbsp;或者<br /><a href="http://chromedriver.storage.googleapis.com/index.html" rel="nofollow" target="_blank">http://chromedriver.storage.googleapis.com/index.html</a><br />IE：<a href="http://selenium-release.storage.googleapis.com/index.html" rel="nofollow" target="_blank">http://selenium-release.storage.googleapis.com/index.html</a><br />注：webdriver需要和对应的浏览器版本以及selenium版本对应</p>

</li>

</ol>
<table>
<thead>
<tr><th>Webdriver版本</th><th>支持的Chrome版本</th></tr>

</thead>
<tbody>
<tr>
<td>v2.41</td>
<td>v67-69</td>

</tr>
<tr>
<td>v2.40</td>
<td>v66-68</td>

</tr>
<tr>
<td>v2.39</td>
<td>v66-68</td>

</tr>
<tr>
<td>v2.38</td>
<td>v65-67</td>

</tr>
<tr>
<td>v2.37</td>
<td>v64-66</td>

</tr>
<tr>
<td>v2.36</td>
<td>v63-65</td>

</tr>
<tr>
<td>v2.35</td>
<td>v62-64</td>

</tr>
<tr>
<td>v2.34</td>
<td>v61-63</td>

</tr>
<tr>
<td>v2.33</td>
<td>v60-62</td>

</tr>

</tbody>

</table>
<ol start="3">
<li>webdriver安装路径<br />Win：<code>复制webdriver到Python安装目录下</code><br />Mac：<code>复制webdriver到/usr/local/bin目录下</code></li>

</ol>
<h2>二、元素定位及浏览器基本操作</h2>
<h3>2.1 启动浏览器</h3>
<h4>2.1.1 普通方式启动</h4>
<p>启动Chrome浏览器：</p>
<pre><code><code class="python  language-python"><span class="token keyword">from selenium <span class="token keyword">import webdriver

browser <span class="token operator">= webdriver<span class="token punctuation">.Chrome<span class="token punctuation">(<span class="token punctuation">)
browser<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">'http://www.baidu.com/'<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></code></pre>
<p>启动Firefox浏览器：</p>
<pre><code><code class="python  language-python"><span class="token keyword">from selenium <span class="token keyword">import webdriver

browser <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
browser<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">'http://www.baidu.com/'<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></code></pre>
<p>启动IE浏览器：</p>
<pre><code><code class="python  language-python"><span class="token keyword">from selenium <span class="token keyword">import webdriver

browser <span class="token operator">= webdriver<span class="token punctuation">.Ie<span class="token punctuation">(<span class="token punctuation">)
browser<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">'http://www.baidu.com/'<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></code></pre>
<h4>2.1.2 Headless方式启动</h4>
<p>Headless Chrome 是 Chrome 浏览器的无界面形态，可以在不打开浏览器的前提下，使用所有 Chrome 支持的特性运行你的程序。相比于现代浏览器，Headless Chrome 更加方便测试 web 应用，获得网站的截图，做爬虫抓取信息等。相比于较早的 PhantomJS，SlimerJS 等，Headless Chrome 则更加贴近浏览器环境。</p>
<p>Headless Chrome 对Chrome版本要求：<br />官方文档中介绍，mac和linux环境要求chrome版本是59+，而windows版本的chrome要求是60+，同时chromedriver要求2.30+版本。</p>
<pre><code><code class="Python  language-python"><span class="token keyword">from selenium <span class="token keyword">import webdriver
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.common<span class="token punctuation">.by <span class="token keyword">import By
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.support<span class="token punctuation">.ui <span class="token keyword">import WebDriverWait
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.support <span class="token keyword">import expected_conditions <span class="token keyword">as EC
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.common<span class="token punctuation">.action_chains <span class="token keyword">import ActionChains
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.common<span class="token punctuation">.keys <span class="token keyword">import Keys

chrome_options <span class="token operator">= webdriver<span class="token punctuation">.ChromeOptions<span class="token punctuation">(<span class="token punctuation">)
<span class="token comment"># 使用headless无界面浏览器模式
chrome_options<span class="token punctuation">.add_argument<span class="token punctuation">(<span class="token string">'--headless'<span class="token punctuation">) <span class="token operator">//增加无界面选项
chrome_options<span class="token punctuation">.add_argument<span class="token punctuation">(<span class="token string">'--disable-gpu'<span class="token punctuation">) <span class="token operator">//如果不加这个选项，有时定位会出现问题

<span class="token comment"># 启动浏览器，获取网页源代码
browser <span class="token operator">= webdriver<span class="token punctuation">.Chrome<span class="token punctuation">(chrome_options<span class="token operator">=chrome_options<span class="token punctuation">)
mainUrl <span class="token operator">= <span class="token string">"https://www.taobao.com/"
browser<span class="token punctuation">.get<span class="token punctuation">(mainUrl<span class="token punctuation">)
<span class="token keyword">print<span class="token punctuation">(<span class="token string-interpolation"><span class="token string">f"browser text = <span class="token interpolation"><span class="token punctuation">{browser<span class="token punctuation">.page_source<span class="token punctuation">}<span class="token string">"<span class="token punctuation">)
browser<span class="token punctuation">.quit<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h4>2.1.3 加载配置启动浏览器</h4>
<p>Selenium操作浏览器是不加载任何配置的，下面是关于加载Chrome配置的方法：</p>
<blockquote>
<p>用Chrome地址栏输入<a href="chrome://version/" rel="nofollow" target="_blank">chrome://version/</a>，查看自己的&ldquo;个人资料路径&rdquo;，然后在浏览器启动时，调用这个配置文件，代码如下：</p>
</blockquote>
<pre><code><code class="Python  language-python"><span class="token comment">#coding=utf-8
<span class="token keyword">from selenium <span class="token keyword">import webdriver
option <span class="token operator">= webdriver<span class="token punctuation">.ChromeOptions<span class="token punctuation">(<span class="token punctuation">)
option<span class="token punctuation">.add_argument<span class="token punctuation">(<span class="token string">'--user-data-dir=C:\Users\Administrator\AppData\Local\Google\Chrome\User Data'<span class="token punctuation">) <span class="token comment">#设置成用户自己的数据目录
driver<span class="token operator">=webdriver<span class="token punctuation">.Chrome<span class="token punctuation">(chrome_options<span class="token operator">=option<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>而加载Firefox配置的方法有些不同：</p>
<blockquote>
<p>打开Firefox点右上角设置&gt;？（帮助）&gt;故障排除信息&gt;显示文件夹，打开后把路径复制下来就可以了</p>
</blockquote>
<pre><code><code class="Python  language-python"><span class="token comment"># coding=utf-8
<span class="token keyword">from selenium <span class="token keyword">import webdriver
<span class="token comment"># 配置文件地址
profile_directory <span class="token operator">= <span class="token string">r'C:\Users\xxx\AppData\Roaming\Mozilla\Firefox\Profiles\1x41j9of.default'
<span class="token comment"># 加载配置配置
profile <span class="token operator">= webdriver<span class="token punctuation">.FirefoxProfile<span class="token punctuation">(profile_directory<span class="token punctuation">)
<span class="token comment"># 启动浏览器配置
driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(profile<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<hr />
<h3>2.2 元素定位</h3>
<p>对象的定位应该是自动化测试的核心，要想操作一个对象，首先应该识别这个对象。一个对象就是一个人一样，他会有各种的特征（属性），如比我们可以通过一个人的身份证号，姓名，或者他住在哪个街道、楼层、门牌找到这个人。那么一个对象也有类似的属性，我们可以通过这个属性找到这对象。</p>
<p>webdriver 提供了一系列的对象定位方法，常用的有以下几种：</p>
<ul>
<li>id定位：find_element_by_id()</li>
<li>name定位：find_element_by_name()</li>
<li>class定位：find_element_by_class_name()</li>
<li>link定位：find_element_by_link_text()</li>
<li>partial link定位：find_element_by_partial_link_text()</li>
<li>tag定位：find_element_by_tag_name()</li>
<li>xpath定位：find_element_by_xpath()</li>
<li>css定位：find_element_by_css_selector()</li>
</ul>
<pre><code><code class="python  language-python"><span class="token comment">#coding=utf-8
<span class="token keyword">from selenium <span class="token keyword">import webdriver
browser<span class="token operator">=webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
browser<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">"http://www.baidu.com"<span class="token punctuation">)
<span class="token comment">#########百度输入框的定位方式##########
<span class="token comment">#通过id方式定位
browser<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"kw"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"selenium"<span class="token punctuation">)
<span class="token comment">#通过name方式定位
browser<span class="token punctuation">.find_element_by_name<span class="token punctuation">(<span class="token string">"wd"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"selenium"<span class="token punctuation">)
<span class="token comment">#通过tag name方式定位
browser<span class="token punctuation">.find_element_by_tag_name<span class="token punctuation">(<span class="token string">"input"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"selenium"<span class="token punctuation">)
<span class="token comment">#通过class name方式定位
browser<span class="token punctuation">.find_element_by_class_name<span class="token punctuation">(<span class="token string">"s_ipt"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"selenium"<span class="token punctuation">)
<span class="token comment">#通过CSS方式定位
browser<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">"#kw"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"selenium"<span class="token punctuation">)
<span class="token comment">#通过xpath方式定位
browser<span class="token punctuation">.find_element_by_xpath<span class="token punctuation">(<span class="token string">"//input[@id='kw']"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"selenium"<span class="token punctuation">)
<span class="token comment">############################################
browser<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"su"<span class="token punctuation">)<span class="token punctuation">.click<span class="token punctuation">(<span class="token punctuation">)
time<span class="token punctuation">.sleep<span class="token punctuation">(<span class="token number">3<span class="token punctuation">)
browser<span class="token punctuation">.quit<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h4>2.2.1 class含有空格时解决方法：</h4>
<p>在实际进行元素定位时，经常发现class name是有多个class组合的复合类，中间以空格隔开。如果直接进行定位会出现报错，可以通过以下方式处理：</p>
<ul>
<li>class属性唯一但是有空格，选择空格两边唯一的那一个</li>
<li>若空格隔开的class不唯一可以通过索引进行定位<br />self.driver.find_elements_by_class_name('table-dragColumn')[0].click()</li>
<li>通过css方法进行定位（空格以&lsquo;.&rsquo;代替）</li>

</ul>
<pre><code><code class="python  language-python"><span class="token comment">#前面加（.）空格地方用点（.）来代替
self<span class="token punctuation">.driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">'.dtb-style-1.table-dragColumns'<span class="token punctuation">)<span class="token punctuation">.click<span class="token punctuation">(<span class="token punctuation">)
<span class="token comment">#包含整个类
self<span class="token punctuation">.driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">'class="dtb-style-1 table-dragColumns'<span class="token punctuation">)<span class="token punctuation">.click<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>参考代码：</p>
<pre><code><code class="python  language-python"><span class="token comment"># coding:utf-8
<span class="token keyword">from selenium <span class="token keyword">import webdriver
driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
driver<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">"http://mail.126.com/"<span class="token punctuation">)
driver<span class="token punctuation">.implicitly_wait<span class="token punctuation">(<span class="token number">20<span class="token punctuation">)
 
driver<span class="token punctuation">.switch_to<span class="token punctuation">.frame<span class="token punctuation">(<span class="token string">"x-URS-iframe"<span class="token punctuation">)
<span class="token comment"># 方法一：取单个class属性
driver<span class="token punctuation">.find_element_by_class_name<span class="token punctuation">(<span class="token string">"dlemail"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"yoyo"<span class="token punctuation">)
driver<span class="token punctuation">.find_element_by_class_name<span class="token punctuation">(<span class="token string">"dlpwd"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"12333"<span class="token punctuation">)
 
<span class="token comment"># 方法二：定位一组取下标定位（乃下策）
driver<span class="token punctuation">.find_elements_by_class_name<span class="token punctuation">(<span class="token string">"j-inputtext"<span class="token punctuation">)<span class="token punctuation">[<span class="token number">0<span class="token punctuation">]<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"yoyo"<span class="token punctuation">)
driver<span class="token punctuation">.find_elements_by_class_name<span class="token punctuation">(<span class="token string">"j-inputtext"<span class="token punctuation">)<span class="token punctuation">[<span class="token number">1<span class="token punctuation">]<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"12333"<span class="token punctuation">)
 
<span class="token comment"># 方法三：css定位
driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">".j-inputtext.dlemail"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"yoyo"<span class="token punctuation">)
driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">".j-inputtext.dlpwd"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"123"<span class="token punctuation">)
 
<span class="token comment"># 方法四：取单个class属性也是可以的
driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">".dlemail"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"yoyo"<span class="token punctuation">)
driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">".dlpwd"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"123"<span class="token punctuation">)
 
<span class="token comment"># 方法五：直接包含空格的CSS属性定位大法
driver<span class="token punctuation">.find_element_by_css_selector<span class="token punctuation">(<span class="token string">"[class='j-inputtext dlemail']"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"yoyo"<span class="token punctuation">)

</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<hr />
<h3>2.3 selenium三种等待方式</h3>
<p>有时候为了保证脚本运行的稳定性，需要脚本中添加等待时间。</p>
<h4>2.3.1 强制等待</h4>
<p>第一种也是最简单粗暴的一种办法就是强制等待sleep(xx)，需要引入&ldquo;time&rdquo;模块，这种叫强制等待，不管你浏览器是否加载完了，程序都得等待3秒，3秒一到，继续执行下面的代码，作为调试很有用，有时候也可以在代码里这样等待，不过不建议总用这种等待方式，太死板，严重影响程序执行速度。</p>
<pre><code><code class="python  language-python"><span class="token comment"># -*- coding: utf-8 -*-
<span class="token keyword">from selenium <span class="token keyword">import webdriver
<span class="token keyword">import time

driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
driver<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">'http://baidu.com'<span class="token punctuation">)

time<span class="token punctuation">.sleep<span class="token punctuation">(<span class="token number">3<span class="token punctuation">)  <span class="token comment"># 强制等待3秒再执行下一步

<span class="token keyword">print<span class="token punctuation">(driver<span class="token punctuation">.current_url<span class="token punctuation">)
driver<span class="token punctuation">.quit<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h4>2.3.2 隐性等待</h4>
<p>第二种办法叫隐性等待，通过添加 implicitly_wait() 方法就可以方便的实现智能等待；implicitly_wait(30) 的用法应该比 time.sleep() 更智能，后者只能选择一个固定的时间的等待，前者可以 在一个时间范围内智能的等待。</p>
<pre><code><code class="python  language-python"><span class="token comment"># -*- coding: utf-8 -*-
<span class="token keyword">from selenium <span class="token keyword">import webdriver

driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
driver<span class="token punctuation">.implicitly_wait<span class="token punctuation">(<span class="token number">30<span class="token punctuation">)  <span class="token comment"># 隐性等待，最长等30秒
driver<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">'http://baidu.com'<span class="token punctuation">)

<span class="token keyword">print<span class="token punctuation">(driver<span class="token punctuation">.current_url<span class="token punctuation">)
driver<span class="token punctuation">.quit<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>隐形等待是设置了一个最长等待时间，如果在规定时间内网页加载完成，则执行下一步，否则一直等到时间截止，然后执行下一步。注意这里有一个弊端，那就是程序会一直等待整个页面加载完成，也就是一般情况下你看到浏览器标签栏那个小圈不再转，才会执行下一步，但有时候页面想要的元素早就在加载完成了，但是因为个别js之类的东西特别慢，我仍得等到页面全部完成才能执行下一步，我想等我要的元素出来之后就下一步怎么办？有办法，这就要看selenium提供的另一种等待方式&mdash;&mdash;显性等待wait了。<br />需要特别说明的是：隐性等待对整个driver的周期都起作用，所以只要设置一次即可，我曾看到有人把隐性等待当成了sleep在用，走哪儿都来一下&hellip;</p>
<h4>2.3.3 显性等待</h4>
<p>第三种办法就是显性等待，WebDriverWait，配合该类的until()和until_not()方法，就能够根据判断条件而进行灵活地等待了。它主要的意思就是：程序每隔xx秒看一眼，如果条件成立了，则执行下一步，否则继续等待，直到超过设置的最长时间，然后抛出TimeoutException。</p>
<p>wait模块的WebDriverWait类是显性等待类，先看下它有哪些参数与方法：</p>
<blockquote>
<p>selenium.webdriver.support.wait.WebDriverWait（类）</p>

</blockquote>
<p>init</p>
<pre class="line-numbers  language-ruby"><code class="  language-ruby">driver<span class="token punctuation">: 传入<span class="token constant">WebDriver实例，即我们上例中的driver
timeout<span class="token punctuation">: 超时时间，等待的最长时间（同时要考虑隐性等待时间）
poll_frequency<span class="token punctuation">: 调用<span class="token keyword">until或until_not中的方法的间隔时间，默认是<span class="token number">0.5秒
ignored_exceptions<span class="token punctuation">: 忽略的异常，如果在调用<span class="token keyword">until或until_not的过程中抛出这个元组中的异常，则不中断代码，继续等待，如果抛出的是这个元组外的异常，则中断代码，抛出异常。默认只有<span class="token constant">NoSuchElementException。
</span></span></span></span></span></span></span></span></span></code></pre>
<p>until</p>
<pre class="line-numbers  language-php"><code class="  language-php">method<span class="token punctuation">: 在等待期间，每隔一段时间（__init__中的poll_frequency）调用这个传入的方法，直到返回值不是<span class="token boolean constant">False
message<span class="token punctuation">: 如果超时，抛出TimeoutException，将message传入异常
</span></span></span></code></pre>
<p>until_not</p>
<pre class="line-numbers  language-ruby"><code class="  language-ruby">与<span class="token keyword">until相反，<span class="token keyword">until是当某元素出现或什么条件成立则继续执行，
until_not是当某元素消失或什么条件不成立则继续执行，参数也相同，不再赘述。
</span></span></code></pre>
<p>看了以上内容基本上很清楚了，调用方法如下：</p>
<blockquote>
<p>WebDriverWait(driver, 超时时长, 调用频率, 忽略异常).until(可执行方法, 超时时返回的信息)</p>
</blockquote>
<p>这里需要特别注意的是until或until_not中的可执行方法method参数，很多人传入了WebElement对象，如下：</p>
<blockquote>
<p>WebDriverWait(driver, 10).until(driver.find_element_by_id('kw')) # 错误</p>
</blockquote>
<p>这是错误的用法，这里的参数一定要是可以调用的，即这个对象一定有&nbsp;call() 方法，否则会抛出异常：</p>
<blockquote>
<p>TypeError: 'xxx' object is not callable</p>
</blockquote>
<p>在这里，你可以用selenium提供的&nbsp;expected_conditions&nbsp;模块中的各种条件，也可以用WebElement的&nbsp;is_displayed()&nbsp;、is_enabled()、**is_selected() **方法，或者用自己封装的方法都可以。</p>
<pre><code><code class="Python  language-python"><span class="token comment">#coding=utf-8
<span class="token keyword">from selenium <span class="token keyword">import webdriver
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.common<span class="token punctuation">.by <span class="token keyword">import By
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.support <span class="token keyword">import expected_conditions <span class="token keyword">as EC
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.support<span class="token punctuation">.wait <span class="token keyword">import WebDriverWait

base_url <span class="token operator">= <span class="token string">"http://www.baidu.com"
driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
driver<span class="token punctuation">.implicitly_wait<span class="token punctuation">(<span class="token number">5<span class="token punctuation">)
<span class="token triple-quoted-string string">'''隐式等待和显示等待都存在时，超时时间取二者中较大的'''
locator <span class="token operator">= <span class="token punctuation">(By<span class="token punctuation">.ID<span class="token punctuation">,<span class="token string">'kw'<span class="token punctuation">)
driver<span class="token punctuation">.get<span class="token punctuation">(base_url<span class="token punctuation">)

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.title_is<span class="token punctuation">(<span class="token string">u"百度一下，你就知道"<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断title,返回布尔值'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.title_contains<span class="token punctuation">(<span class="token string">u"百度一下"<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断title，返回布尔值'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.presence_of_element_located<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.ID<span class="token punctuation">,<span class="token string">'kw'<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素是否被加到了dom树里，并不代表该元素一定可见，如果定位到就返回WebElement'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.visibility_of_element_located<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.ID<span class="token punctuation">,<span class="token string">'su'<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素是否被添加到了dom里并且可见，可见代表元素可显示且宽和高都大于0'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.visibility_of<span class="token punctuation">(driver<span class="token punctuation">.find_element<span class="token punctuation">(by<span class="token operator">=By<span class="token punctuation">.ID<span class="token punctuation">,value<span class="token operator">=<span class="token string">'kw'<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断元素是否可见，如果可见就返回这个元素'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.presence_of_all_elements_located<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.CSS_SELECTOR<span class="token punctuation">,<span class="token string">'.mnav'<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断是否至少有1个元素存在于dom树中，如果定位到就返回列表'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.visibility_of_any_elements_located<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.CSS_SELECTOR<span class="token punctuation">,<span class="token string">'.mnav'<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断是否至少有一个元素在页面中可见，如果定位到就返回列表'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.text_to_be_present_in_element<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.XPATH<span class="token punctuation">,<span class="token string">"//*[@id='u1']/a[8]"<span class="token punctuation">)<span class="token punctuation">,<span class="token string">u'设置'<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断指定的元素中是否包含了预期的字符串，返回布尔值'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.text_to_be_present_in_element_value<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.CSS_SELECTOR<span class="token punctuation">,<span class="token string">'#su'<span class="token punctuation">)<span class="token punctuation">,<span class="token string">u'百度一下'<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断指定元素的属性值中是否包含了预期的字符串，返回布尔值'''

<span class="token comment">#WebDriverWait(driver,10).until(EC.frame_to_be_available_and_switch_to_it(locator))
<span class="token triple-quoted-string string">'''判断该frame是否可以switch进去，如果可以的话，返回True并且switch进去，否则返回False'''
<span class="token comment">#注意这里并没有一个frame可以切换进去

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.invisibility_of_element_located<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.CSS_SELECTOR<span class="token punctuation">,<span class="token string">'#swfEveryCookieWrap'<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素在是否存在于dom或不可见,如果可见返回False,不可见返回这个元素'''
<span class="token comment">#注意#swfEveryCookieWrap在此页面中是一个隐藏的元素

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.element_to_be_clickable<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.XPATH<span class="token punctuation">,<span class="token string">"//*[@id='u1']/a[8]"<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">.click<span class="token punctuation">(<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素中是否可见并且是enable的，代表可点击'''
driver<span class="token punctuation">.find_element_by_xpath<span class="token punctuation">(<span class="token string">"//*[@id='wrapper']/div[6]/a[1]"<span class="token punctuation">)<span class="token punctuation">.click<span class="token punctuation">(<span class="token punctuation">)
<span class="token comment">#WebDriverWait(driver,10).until(EC.element_to_be_clickable((By.XPATH,"//*[@id='wrapper']/div[6]/a[1]"))).click()

<span class="token comment">#WebDriverWait(driver,10).until(EC.staleness_of(driver.find_element(By.ID,'su')))
<span class="token triple-quoted-string string">'''等待某个元素从dom树中移除'''
<span class="token comment">#这里没有找到合适的例子

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.element_to_be_selected<span class="token punctuation">(driver<span class="token punctuation">.find_element<span class="token punctuation">(By<span class="token punctuation">.XPATH<span class="token punctuation">,<span class="token string">"//*[@id='nr']/option[1]"<span class="token punctuation">)<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素是否被选中了,一般用在下拉列表'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.element_selection_state_to_be<span class="token punctuation">(driver<span class="token punctuation">.find_element<span class="token punctuation">(By<span class="token punctuation">.XPATH<span class="token punctuation">,<span class="token string">"//*[@id='nr']/option[1]"<span class="token punctuation">)<span class="token punctuation">,<span class="token boolean">True<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素的选中状态是否符合预期'''

WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.element_located_selection_state_to_be<span class="token punctuation">(<span class="token punctuation">(By<span class="token punctuation">.XPATH<span class="token punctuation">,<span class="token string">"//*[@id='nr']/option[1]"<span class="token punctuation">)<span class="token punctuation">,<span class="token boolean">True<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断某个元素的选中状态是否符合预期'''
driver<span class="token punctuation">.find_element_by_xpath<span class="token punctuation">(<span class="token string">".//*[@id='gxszButton']/a[1]"<span class="token punctuation">)<span class="token punctuation">.click<span class="token punctuation">(<span class="token punctuation">)

instance <span class="token operator">= WebDriverWait<span class="token punctuation">(driver<span class="token punctuation">,<span class="token number">10<span class="token punctuation">)<span class="token punctuation">.until<span class="token punctuation">(EC<span class="token punctuation">.alert_is_present<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">)
<span class="token triple-quoted-string string">'''判断页面上是否存在alert,如果有就切换到alert并返回alert的内容'''
<span class="token keyword">print instance<span class="token punctuation">.text
instance<span class="token punctuation">.accept<span class="token punctuation">(<span class="token punctuation">)

driver<span class="token punctuation">.close<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<hr />
<h3>2.4 浏览器操作</h3>
<h4>2.4.1 浏览器最大化、最小化</h4>
<h1>将浏览器最大化显示</h1>
<p><code>browser.maximize_window()</code></p>
<h1>将浏览器最小化显示</h1>
<p><code>browser.minimize_window()</code></p>
<h4>2.4.2 浏览器设置窗口大小</h4>
<h1>设置浏览器宽480、高800显示</h1>
<p><code>browser.set_window_size(480, 800)</code></p>
<h4>2.4.3 浏览器前进后退</h4>
<h1>前进</h1>
<p><code>browser.forword()</code></p>
<h1>后退</h1>
<p><code>browser.back()</code></p>
<hr />
<h3>2.5 操作测试对象</h3>
<p>一般来说，webdriver 中比较常用的操作对象的方法有下面几个：</p>
<ul>
<li>click&mdash;&mdash;点击对象</li>
<li>send_keys&mdash;&mdash;在对象上模拟按键输入</li>
<li>clear&mdash;&mdash;清除对象的内容，如果可以的话</li>
<li>submit&mdash;&mdash;提交对象的内容，如果可以的话</li>
<li>text&mdash;&mdash;用于获取元素的文本信息</li>
</ul>
<hr />
<h3>2.6 键盘事件</h3>
<blockquote>
<p>要想调用键盘按键操作需要引入 keys 包：<br /><code>from selenium.webdriver.common.keys import Keys</code>通过 send_keys()调用按键：<br /><code>send_keys(Keys.TAB) # TAB</code><br /><code>send_keys(Keys.ENTER) # 回车</code></p>

</blockquote>
<p>参考代码：</p>
<pre><code><code class="python  language-python"><span class="token comment">#coding=utf-8 
<span class="token keyword">from selenium <span class="token keyword">import webdriver 
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.common<span class="token punctuation">.keys <span class="token keyword">import Keys <span class="token comment">#需要引入 keys 包
<span class="token keyword">import os<span class="token punctuation">,time

driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">) 
driver<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">"http://passport.kuaibo.com/login/?referrer=http%3A%2F%2Fwebcloud .kuaibo.com%2F"<span class="token punctuation">)

time<span class="token punctuation">.sleep<span class="token punctuation">(<span class="token number">3<span class="token punctuation">) 
driver<span class="token punctuation">.maximize_window<span class="token punctuation">(<span class="token punctuation">) <span class="token comment"># 浏览器全屏显示

driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"user_name"<span class="token punctuation">)<span class="token punctuation">.clear<span class="token punctuation">(<span class="token punctuation">) 
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"user_name"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"fnngj"<span class="token punctuation">)

<span class="token comment">#tab 的定位相相于清除了密码框的默认提示信息，等同上面的 clear() 
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"user_name"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(Keys<span class="token punctuation">.TAB<span class="token punctuation">) 
time<span class="token punctuation">.sleep<span class="token punctuation">(<span class="token number">3<span class="token punctuation">) 
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"user_pwd"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(<span class="token string">"123456"<span class="token punctuation">)

<span class="token comment">#通过定位密码框，enter（回车）来代替登陆按钮
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"user_pwd"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(Keys<span class="token punctuation">.ENTER<span class="token punctuation">)

<span class="token comment">#也可定位登陆按钮，通过 enter（回车）代替 click() 
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"login"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(Keys<span class="token punctuation">.ENTER<span class="token punctuation">) 
time<span class="token punctuation">.sleep<span class="token punctuation">(<span class="token number">3<span class="token punctuation">)

driver<span class="token punctuation">.quit<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>键盘组合键的用法：</p>
<pre><code><code class="python  language-python"><span class="token comment">#ctrl+a 全选输入框内容 
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"kw"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(Keys<span class="token punctuation">.CONTROL<span class="token punctuation">,<span class="token string">'a'<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></code></pre>
<pre><code><code class="python  language-python"><span class="token comment">#ctrl+x 剪切输入框内容 
driver<span class="token punctuation">.find_element_by_id<span class="token punctuation">(<span class="token string">"kw"<span class="token punctuation">)<span class="token punctuation">.send_keys<span class="token punctuation">(Keys<span class="token punctuation">.CONTROL<span class="token punctuation">,<span class="token string">'x'<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></code></pre>
<hr />
<h3>2.7 鼠标事件</h3>
<p>鼠标事件一般包括鼠标右键、双击、拖动、移动鼠标到某个元素上等等。<br />需要引入ActionChains类。<br />引入方法：<br /><code>from selenium.webdriver.common.action_chains import ActionChains</code></p>
<pre class="line-numbers  language-undefined"><code class="  language-undefined">ActionChains 常用方法：
perform()  执行所有ActionChains 中存储的行为；
context_click()  右击；
double_click()   双击；
drag_and_drop()  拖动；
move_to_element()  鼠标悬停。
</code></pre>
<p>鼠标双击示例：</p>
<pre><code><code class="python  language-python"><span class="token comment">#定位到要双击的元素
 qqq <span class="token operator">=driver<span class="token punctuation">.find_element_by_xpath<span class="token punctuation">(<span class="token string">"xxx"<span class="token punctuation">) 
<span class="token comment">#对定位到的元素执行鼠标双击操作 
 ActionChains<span class="token punctuation">(driver<span class="token punctuation">)<span class="token punctuation">.double_click<span class="token punctuation">(qqq<span class="token punctuation">)<span class="token punctuation">.perform<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<p>鼠标拖放示例：</p>
<pre><code><code class="Python  language-python"><span class="token comment">#定位元素的原位置 
element <span class="token operator">= driver<span class="token punctuation">.find_element_by_name<span class="token punctuation">(<span class="token string">"source"<span class="token punctuation">) 
<span class="token comment">#定位元素要移动到的目标位置 
target <span class="token operator">= driver<span class="token punctuation">.find_element_by_name<span class="token punctuation">(<span class="token string">"target"<span class="token punctuation">)
<span class="token comment">#执行元素的移动操作 
ActionChains<span class="token punctuation">(driver<span class="token punctuation">)<span class="token punctuation">.drag_and_drop<span class="token punctuation">(element<span class="token punctuation">, target<span class="token punctuation">)<span class="token punctuation">.perform<span class="token punctuation">(<span class="token punctuation">)
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<hr />
<h3>2.8 多层框架/层级定位</h3>
<p>定位元素过程中经常会遇到找不到元素的问题，出现该问题一般都是以下因素导致：</p>
<ul>
<li>元素定位方法不对</li>
<li>页面存在iframe或内嵌窗口</li>
<li>页面超时</li>
</ul>
<p>webdriver 提供了一个 switch_to_frame 方法，可以很轻松的来解决这个问题。<br />用法：</p>
<pre><code><code class="python  language-python"><span class="token comment">#先找到到 ifrome1（id = f1）
browser<span class="token punctuation">.switch_to_frame<span class="token punctuation">(<span class="token string">"f1"<span class="token punctuation">)
</span></span></span></span></span></code></pre>
<p>同样的，如果是内嵌窗口：<br /><code>browser.switch_to_window("f1")</code></p>
<hr />
<h3>2.9 Expected Conditions解析</h3>
<p>Expected Conditions的使用场景有2种：</p>
<ul>
<li>直接在断言中使用</li>
<li>与WebDriverWait配合使用，动态等待页面上元素出现或者消失</li>

</ul>
<p>相关方法：</p>
<ul>
<li><code>title_is</code>: 判断当前页面的title是否精确等于预期</li>
<li><code>title_contains</code>： 判断当前页面的title是否包含预期字符串</li>
<li><code>presence_of_element_located</code>：判断某个元素是否被加到了dom树里，并不代表该元素一定可见</li>
<li><code>visibility_of_element_located</code>：判断某个元素是否可见.可见代表元素非隐藏，并且元素的宽和高都不等于0</li>
<li><code>visibility_of</code>：跟上面的方法做一样的事情，只是上面的方法要传入locator，这个方法直接传定位到的element就好了</li>
<li><code>presence_of_all_elements_located</code>：判断是否至少有1个元素存在于dom树中。举个例子，如果页面上有n个元素的class都是'column-md-3'，那么只要有1个元素存在，这个方法就返回True</li>
<li><code>text_to_be_present_in_element</code>：判断某个元素中的text是否包含了预期的字符串</li>
<li><code>text_to_be_present_in_element_value</code>：判断某个元素中的value属性是否包含了预期的字符串</li>
<li><code>frame_to_be_available_and_switch_to_it</code>：判断该frame是否可以switch进去，如果可以的话，返回True并且switch进去，否则返回False</li>
<li><code>invisibility_of_element_located</code>：判断某个元素中是否不存在于dom树或不可见</li>
<li><code>element_to_be_clickable</code>：判断某个元素中是否可见并且是enable的，这样的话才叫clickable</li>
<li><code>staleness_of</code>：等某个元素从dom树中移除，注意，这个方法也是返回True或False</li>
<li><code>element_to_be_selected</code>：判断某个元素是否被选中了,一般用在下拉列表</li>
<li><code>element_selection_state_to_be</code>：判断某个元素的选中状态是否符合预期</li>
<li><code>element_located_selection_state_to_be</code>：跟上面的方法作用一样，只是上面的方法传入定位到的element，而这个方法传入locator</li>
<li><code>alert_is_present</code>：判断页面上是否存在alert，这是个老问题，很多同学会问到</li>

</ul>
<p>示例：<br />判断title：title_is()、title_contains()</p>
<ol>
<li>首先导入expected_conditions模块</li>
<li>由于这个模块名称比较长，所以为了后续的调用方便，重新命名为EC了（有点像数据库里面多表查询时候重命名）</li>
<li>打开博客首页后判断title,返回结果是True或False</li>

</ol>
<pre><code><code class="python  language-python"><span class="token comment"># coding:utf-8
<span class="token keyword">from selenium <span class="token keyword">import webdriver
<span class="token keyword">from selenium<span class="token punctuation">.webdriver<span class="token punctuation">.support <span class="token keyword">import expected_conditions <span class="token keyword">as EC
driver <span class="token operator">= webdriver<span class="token punctuation">.Firefox<span class="token punctuation">(<span class="token punctuation">)
driver<span class="token punctuation">.get<span class="token punctuation">(<span class="token string">"http://baidu.com"<span class="token punctuation">)
<span class="token comment"># 判断title完全等于
title <span class="token operator">= EC<span class="token punctuation">.title_is<span class="token punctuation">(<span class="token string">u'百度'<span class="token punctuation">)
<span class="token keyword">print title<span class="token punctuation">(driver<span class="token punctuation">)

<span class="token comment"># 判断title包含
title1 <span class="token operator">= EC<span class="token punctuation">.title_contains<span class="token punctuation">(<span class="token string">u'百度'<span class="token punctuation">)
<span class="token keyword">print title1<span class="token punctuation">(driver<span class="token punctuation">)

<span class="token comment"># 另外一种写法
r1 <span class="token operator">= EC<span class="token punctuation">.title_is<span class="token punctuation">(<span class="token string">u'百度'<span class="token punctuation">)<span class="token punctuation">(driver<span class="token punctuation">)
r2 <span class="token operator">= EC<span class="token punctuation">.title_contains<span class="token punctuation">(<span class="token string">u'百度'<span class="token punctuation">)<span class="token punctuation">(driver<span class="token punctuation">)
<span class="token keyword">print r1
<span class="token keyword">print r2
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<hr />
<h2>三、Selenium速查表</h2>
<h3>3.1 Python Webdriver Exception速查表</h3>
<p>webdriver在使用过程中可能会出现各种异常，我们需要了解该异常并知道如何进行异常处理。</p>
<table>
<thead>
<tr><th>异常</th><th>描述</th></tr>
</thead>
<tbody>
<tr>
<td>WebDriverException</td>
<td>所有webdriver异常的基类，当有异常且不属于下列异常时抛出</td>
</tr>
<tr>
<td>InvalidSwitchToTargetException</td>
<td>下面两个异常的父类，当要switch的目标不存在时抛出</td>
</tr>
<tr>
<td>NoSuchFrameException</td>
<td>当你想要用switch_to.frame()切入某个不存在的frame时抛出</td>
</tr>
<tr>
<td>NoSuchWindowException</td>
<td>当你想要用switch_to.window()切入某个不存在的window时抛出</td>
</tr>
<tr>
<td>NoSuchElementException</td>
<td>元素不存在，一般由find_element与find_elements抛出</td>
</tr>
<tr>
<td>NoSuchAttributeException</td>
<td>一般你获取不存在的元素属性时抛出，要注意有些属性在不同浏览器里是有不同的属性名的</td>
</tr>
<tr>
<td>StaleElementReferenceException</td>
<td>指定的元素过时了，不在现在的DOM树里了，可能是被删除了或者是页面或iframe刷新了</td>
</tr>
<tr>
<td>UnexpectedAlertPresentException</td>
<td>出现了意料之外的alert，阻碍了指令的执行时抛出</td>
</tr>
<tr>
<td>NoAlertPresentException</td>
<td>你想要获取alert，但实际没有alert出现时抛出</td>
</tr>
<tr>
<td>InvalidElementStateException</td>
<td>下面两个异常的父类，当元素状态不能进行想要的操作时抛出</td>
</tr>
<tr>
<td>ElementNotVisibleException</td>
<td>元素存在，但是不可见，不可以与之交互</td>
</tr>
<tr>
<td>ElementNotSelectableException</td>
<td>当你想要选择一个不可被选择的元素时抛出</td>
</tr>
<tr>
<td>InvalidSelectorException</td>
<td>一般当你xpath语法错误的时候抛出这个错</td>
</tr>
<tr>
<td>InvalidCookieDomainException</td>
<td>当你想要在非当前url的域里添加cookie时抛出</td>
</tr>
<tr>
<td>UnableToSetCookieException</td>
<td>当driver无法添加一个cookie时抛出</td>
</tr>
<tr>
<td>TimeoutException</td>
<td>当一个指令在足够的时间内没有完成时抛出</td>
</tr>
<tr>
<td>MoveTargetOutOfBoundsException</td>
<td>actions的move操作时抛出，将目标移动出了window之外</td>
</tr>
<tr>
<td>UnexpectedTagNameException</td>
<td>获取到的元素标签不符合要求时抛出，比如实例化Select，你传入了非select标签的元素时</td>
</tr>
<tr>
<td>ImeNotAvailableException</td>
<td>输入法不支持的时候抛出，这里两个异常不常见，ime引擎据说是仅用于linux下对中文/日文支持的时候</td>
</tr>
<tr>
<td>ImeActivationFailedException</td>
<td>激活输入法失败时抛出</td>
</tr>
<tr>
<td>ErrorInResponseException</td>
<td>不常见，server端出错时可能会抛</td>
</tr>
<tr>
<td>RemoteDriverServerException</td>
<td>不常见，好像是在某些情况下驱动启动浏览器失败的时候会报这个错</td>
</tr>
</tbody>
</table>
<hr />
<h3>3.2 Xpath&amp;Css定位方法速查表</h3>
<table>
<thead>
<tr><th>描述</th><th>Xpath</th><th>Css</th></tr>
</thead>
<tbody>
<tr>
<td>直接子元素</td>
<td>//div/a</td>
<td>div &gt; a</td>
</tr>
<tr>
<td>子元素或后代元素</td>
<td>//div//a</td>
<td>div a</td>
</tr>
<tr>
<td>以id定位</td>
<td>//div[@id='idValue']//a</td>
<td>div#idValue a</td>
</tr>
<tr>
<td>以class定位</td>
<td>//div[@class='classValue']//a</td>
<td>div.classValue a</td>
</tr>
<tr>
<td>同级弟弟元素</td>
<td>//ul/li[@class='first']/following-</td>
<td>ul&gt;li.first + li</td>
</tr>
<tr>
<td>属性</td>
<td>//form/input[@name='username']</td>
<td>form input[name='username']</td>
</tr>
<tr>
<td>多个属性</td>
<td>//input[@name='continue' and</td>
<td>input[name='continue'][type='button</td>
</tr>
<tr>
<td>第4个子元素</td>
<td>//ul[@id='list']/li[4]</td>
<td>ul#list li:nth-child(4)</td>
</tr>
<tr>
<td>第1个子元素</td>
<td>//ul[@id='list']/li[1]</td>
<td>ul#list li:first-child</td>
</tr>
<tr>
<td>最后1个子元素</td>
<td>//ul[@id='list']/li[last()]</td>
<td>ul#list li:last-child</td>
</tr>
<tr>
<td>属性包含某字段</td>
<td>//div[contains(@title,'Title')]</td>
<td>div[title*="Title"]</td>
</tr>
<tr>
<td>属性以某字段开头</td>
<td>//input[starts-with(@name,'user')]</td>
<td>input[name^="user"]</td>
</tr>
<tr>
<td>属性以某字段结尾</td>
<td>//input[ends-with(@name,'name')]</td>
<td>input[name$="name"]</td>
</tr>
<tr>
<td>text中包含某字段</td>
<td>//div[contains(text(), 'text')]</td>
<td>无法定位</td>
</tr>
<tr>
<td>元素有某属性</td>
<td>//div[@title]</td>
<td>div[title]</td>
</tr>
<tr>
<td>父节点</td>
<td>//div/..</td>
<td>无法定位</td>
</tr>
<tr>
<td>同级哥哥节点</td>
<td>//li/preceding-sibling::div[1]</td>
<td>无法定位</td>
</tr>
</tbody>
</table>
<h3>Tips</h3>
<p>这里介绍一款在线代码美化工具，在线访问地址：<br /><a href="https://carbon.now.sh/" rel="nofollow" target="_blank">https://carbon.now.sh</a></p>
<p>另外如果使用Vscode的话，可以安装对应的插件进行快速在线美化。</p>
<ul>
<li>打开Vscode,在插件栏输入：carbon-now-sh</li>
<li>点击安装</li>
<li>点击重新加载即可安装</li>
<li>按快捷键ALT+CMD+A(win系统下使用：ALT+WIN+A)即可</li>

</ul>
<p>效果预览：</p>
<p>&nbsp;</p>
<div class="image-package">
<div class="image-container">
<div class="image-container-fill">&nbsp;</div>
<div class="image-view" data-width="1862" data-height="630"><img src="./images/python基础 — Selenium 详细介绍0.png" alt="" data-original-src="//upload-images.jianshu.io/upload_images/52908-4c0ed15daa1d9ce5.png" data-original-width="1862" data-original-height="630" data-original-format="image/png" data-original-filesize="124206" data-image-index="0" /></div>
</div>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）</center></div><div class='banquan'>原文出处:本文由博客园博主北京-宏哥提供。<br/>
原文连接:https://www.cnblogs.com/du-hong/p/12010213.html</div><br>
    <h3>1. 简介</h3>
<p>&nbsp;　　本来上一篇就是练习篇的最后一篇文章了，但是有的小伙伴私下反映说是做了那么多练习，没有一个比较综合的demo练练手。因此宏哥在这里又补存了一些常见的知识点进行练习，在文章最后也通过实例给小伙伴们或者童鞋们进行了一个登录模块的自动化测试的实例，其他的你可以照猫画虎地轻松的搞定和实现。</p>
<h3 class="postTitle">2. python-web自动化-三种等待方式</h3>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body ">
<p>当有元素定位不到时，比如下拉框，弹出框等各种定位不到时；</p>
<p>一般是两种问题：1 、有frame ；2、没有加等待</p>
<p>下面学习三种等待方式：</p>
<h4>2.1 强制等待 sleep（xx）或者Time.sleep</h4>
<p><strong>是在程序运行过程中使用time模块中的sleep进行代码的休眠进行强制等待，是显式等待中的一种极端情况。</strong></p>
<p>这种方法简单粗暴，不管浏览器是否加载完，程序都要等待规定的xx时间，时间到了才继续执行下面的代码。</p>
<p>不建议总是用这种等待方式，会严重影响程序的执行速度。通过time模块中sleep进行代码的暂停，但是实际使用过程中，如果都以sleep进行控制严重影响了程序的运行。</p>
<h5>2.1.1 参考代码1</h5>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> coding=utf-8🔥</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: 《手把手教你》系列练习篇之9-python+ selenium自动化测试
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> time

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 强制等待&mdash;&mdash;代码休眠</span>

<span style="color: #0000ff;">from</span> selenium <span style="color: #0000ff;">import</span><span style="color: #000000;"> webdriver

driver </span>=<span style="color: #000000;"> webdriver.Chrome()
driver.get(</span><span style="color: #800000;">"</span><span style="color: #800000;">https://www.baidu.com</span><span style="color: #800000;">"</span><span style="color: #000000;">)
time.sleep(</span>3<span style="color: #000000;">)

driver.quit()</span></pre>
</div>
<h5>2.1.2 参考代码2</h5>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> coding=utf-8🔥</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: 《手把手教你》系列练习篇之9-python+ selenium自动化测试
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>

<span style="color: #0000ff;">from</span> selenium <span style="color: #0000ff;">import</span><span style="color: #000000;"> webdriver
</span><span style="color: #0000ff;">from</span> time <span style="color: #0000ff;">import</span><span style="color: #000000;"> sleep
driver </span>=<span style="color: #000000;"> webdriver.Chrome()
driver.get(</span><span style="color: #800000;">'</span><span style="color: #800000;">https://www.baidu.com/</span><span style="color: #800000;">'</span><span style="color: #000000;">)
sleep(</span>3)<span style="color: #008000;">#</span><span style="color: #008000;">强制性等待3s再执行以下代码</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(driver.current_url)
driver.quit()</span><span style="color: #008000;">#</span><span style="color: #008000;">退出驱动，关闭所有窗口</span></pre>
</div>
<h4>2.2 隐性等待 implicitly_wait(xx)</h4>
<p>这种方法是设置一个最长的等待时间，如果在规定时间内网页全部元素加载完成，则执行下一步，否则一直等待时间截止才执行下一步。比强制性等待智能些</p>
<p>！隐性等待对整个driver的周期都起作用，所以只要设置一次即可</p>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body ">
<h5>2.2.1 参考代码1</h5>
<div class="cnblogs_code">
<pre><code># coding=utf-8🔥

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: 《手把手教你》系列练习篇之9-python+ selenium自动化测试
'''

# 3.导入模块

from selenium import<span> webdriver
from selenium.common.exceptions import<span> NoSuchElementException
from time import<span> ctime

driver =<span> webdriver.Firefox()

# 设置隐式等待为10秒
driver.implicitly_wait(10<span>)
driver.get("http://www.baidu.com"<span>)

try<span>:
    print<span>(ctime())
    driver.find_element_by_id("kw22").send_keys('selenium'<span>)
except<span> NoSuchElementException as e:
    print<span>(e)
finally<span>:
    print<span>(ctime())
    driver.quit()</span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
</div>
</div>
<p>这里可以看到在10秒内没有找到想要找到的元素，但是依旧执行了10秒，然后报错，如果修改代码为可以找到，代码执行非常迅速。</p>
<p>implicitly_wait()默认参数的单位为秒，本例中设置等待时长为10秒。首先这10秒并非一个固定的等待时间，它并不影响脚本的执行速度。其次，它并不针对页面上的某一元素进行等待。当脚本执行到某个元素定位时，如果元素可以定位，则继续执行；如果元素定位</p>
<p>不到，则它将以轮询的方式不断地判断元素是否被定位到。假设在第6秒定位到了元素则继续执行，若直到超出设置时长（10秒）还没有定位到元素，则抛出异常。</p>
<h5>2.2.2 参考代码2</h5>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> coding=utf-8🔥</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: 《手把手教你》系列练习篇之9-python+ selenium自动化测试
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>

<span style="color: #0000ff;">from</span> selenium <span style="color: #0000ff;">import</span><span style="color: #000000;"> webdriver
driver </span>=<span style="color: #000000;"> webdriver.Chrome()
driver.get(</span><span style="color: #800000;">'</span><span style="color: #800000;">https://www.baidu.com/</span><span style="color: #800000;">'</span><span style="color: #000000;">)
driver.implicitly_wait(</span>30)<span style="color: #008000;">#</span><span style="color: #008000;">隐性等待,最长30s</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(driver.current_url)
driver.quit()</span></pre>
</div>
<h4>2.3.显性等待 WebDriverWait</h4>
<p>WebDriverWait配合该类的until()和until_not()方法，根据条件灵活的等待</p>
<p>程序每隔xx秒看一眼，如果条件成立了，则执行下一步，否则继续等待，直到超过设置的最长时间，然后抛出TimeoutException。</p>
<p>显式等待是你在代码中定义等待一定条件发生后再进一步执行你的代码。</p>
<p>A. 使用前，先引用相关库</p>
<p>B. 确定元素的定位表达式</p>
<p>C.&nbsp; 使用expected_conditions对应的方法来生成判断条件</p>
<div class="cnblogs_code">
<pre><code>WebDriverWait(driver,10,1<span style="color: #000000;">).until(EC.visibility_of_element_located((By.ID,ele_locator)))
WebDriverWait(driver,</span>10,1).until(EC.visibility_of_element_located((By.XPATH,ele_locator)))</pre>
</div>
<p>D.&nbsp; 调用WebDriverWait类设置等待总时长、轮询周期</p>
<h5>2.3.1 参考代码1</h5>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> coding=utf-8🔥</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: 《手把手教你》系列练习篇之9-python+ selenium自动化测试
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>

<span style="color: #008000;">#</span><span style="color: #008000;">A. 使用前，先引用相关库</span>
<span style="color: #0000ff;">from</span> selenium <span style="color: #0000ff;">import</span><span style="color: #000000;"> webdriver
</span><span style="color: #0000ff;">from</span> selenium.webdriver.support.wait <span style="color: #0000ff;">import</span><span style="color: #000000;"> WebDriverWait
</span><span style="color: #0000ff;">from</span> selenium.webdriver.support <span style="color: #0000ff;">import</span><span style="color: #000000;"> expected_conditions as EC
</span><span style="color: #0000ff;">from</span> selenium.webdriver.common.by <span style="color: #0000ff;">import</span><span style="color: #000000;"> By
 
driver </span>= webdriver.Chrome()<span style="color: #008000;">#</span><span style="color: #008000;">打开Chrome浏览器</span>
driver.get(<span style="color: #800000;">'</span><span style="color: #800000;">https://www.baidu.com/</span><span style="color: #800000;">'</span>)<span style="color: #008000;">#</span><span style="color: #008000;">打开百度</span>
driver.find_element_by_xpath(<span style="color: #800000;">'</span><span style="color: #800000;">//div[@id="u1"]//a[@name="tj_login"]</span><span style="color: #800000;">'</span>).click()<span style="color: #008000;">#</span><span style="color: #008000;">点击【登录】；click() 方法，可模拟在按钮上的一次鼠标单击。</span><span style="color: #008000;">
#</span><span style="color: #008000;"> B. 确定元素的定位表达式</span>
ele_locator = <span style="color: #800000;">"</span><span style="color: #800000;">TANGRAM__PSP_10__footerULoginBtn</span><span style="color: #800000;">"</span><span style="color: #008000;">#</span><span style="color: #008000;">通过id,确定&lsquo;用户名登录&rsquo;元素</span>
 
<span style="color: #008000;">#</span><span style="color: #008000;"> C.  使用expected_conditions对应的方法来生成判断条件</span><span style="color: #008000;">
#</span><span style="color: #008000;"> EC.方法名(定位方式,定位表达式)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> EC.visibility_of_element_located(By.ID,ele_locator)#元素可见</span>
 
<span style="color: #008000;">#</span><span style="color: #008000;"> D.  调用WebDriverWait类设置等待总时长、轮询周期</span><span style="color: #008000;">
#</span><span style="color: #008000;"> WebDriverWait(driver, 超时时长, 调用频率（默认0.5s）).until(可执行方法, 超时时返回的信息)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 等待10秒钟，每隔1秒去查看对应的元素是否可见；如果可见，继续下一步操作；如果不可见，则继续等待，直到10s结束，如果元素还是不可见，则抛出超时异常</span>
WebDriverWait(driver,10,1<span style="color: #000000;">).until(EC.visibility_of_element_located((By.ID,ele_locator)))

driver.find_element_by_id(</span><span style="color: #800000;">'</span><span style="color: #800000;">TANGRAM__PSP_10__footerULoginBtn</span><span style="color: #800000;">'</span>).click()<span style="color: #008000;">#</span><span style="color: #008000;">点击【用户名登录】</span>
<span style="color: #000000;"> 
driver.close()</span><span style="color: #008000;">#</span><span style="color: #008000;">关闭当前窗口</span></pre>
</div>
<h5>2.3.2 参考代码2</h5>
<div class="cnblogs_code">
<pre><code># coding=utf-8🔥

# 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行

# 2.注释：包括记录创建时间，创建人，项目名称。
'''
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: 《手把手教你》系列练习篇之9-python+ selenium自动化测试
'''

# 3.导入模块

from time import<span> ctime
from selenium import<span> webdriver
from selenium.webdriver.common.by import<span> By
from selenium.webdriver.support.ui import<span> WebDriverWait
from selenium.webdriver.support import<span> expected_conditions as EC

dr =<span> webdriver.Chrome()
dr.get('https://www.baidu.com'<span>)

try<span>:
    print<span>(ctime())
    element = WebDriverWait(dr, 10<span>).until(
        EC.presence_of_element_located((By.ID, "kw"<span>))
    )
    # WebDriverWait(driver=self.driver, timeout=300, poll_frequency=0.5,  ignored_exceptions=None)
    # driver：浏览器驱动
    # timeout：最长超时等待时间
    # poll_frequency：检测的时间间隔，默认为500ms
    # ignore_exception：超时后抛出的异常信息，默认情况下抛 NoSuchElementException 异常
    print("我已找到"<span>)
finally<span>:
    print<span>(ctime())
    dr.quit()</span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
</div>
<p>执行结果：</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）0.png" alt="" /></p>
<p>以上代码执行后就发现，整段代码执行速度非常快，即使我在WebDriverWait中设置10秒，也不会等待10秒的情况，因为在不到一秒内，已经完成了加载并定位id为&ldquo;kw&rdquo;的元素。</p>
<p>通过WebDriverWait 和 ExpectedCondition 组合使用，让我们的代码执行只需要等待需要的时长，而不是固定的时长，这样最大限度的节省时间。</p>
<p>&nbsp;此外ExpectedCondition类中提供了很多预期条件判断方法，省去了再创建包的功夫：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #800000;">"""</span><span style="color: #800000;">
title_is：判断当前页面的title是否等于预期
title_contains：判断当前页面的title是否包含预期字符串
presence_of_element_located：判断某个元素是否被加到了dom树里，并不代表该元素一定可见
visibility_of_element_located：判断某个元素是否可见. 可见代表元素非隐藏，并且元素的宽和高都不等于0
visibility_of：跟上面的方法做一样的事情，只是上面的方法要传入locator，这个方法直接传定位到的element就好了
presence_of_all_elements_located：判断是否至少有1个元素存在于dom树中。举个例子，如果页面上有n个元素的class都是'column-md-3'，那么只要有1个元素存在，这个方法就返回True
text_to_be_present_in_element：判断某个元素中的text是否 包含 了预期的字符串
text_to_be_present_in_element_value：判断某个元素中的value属性是否包含了预期的字符串
frame_to_be_available_and_switch_to_it：判断该frame是否可以switch进去，如果可以的话，返回True并且switch进去，否则返回False
invisibility_of_element_located：判断某个元素中是否不存在于dom树或不可见
element_to_be_clickable - it is Displayed and Enabled：判断某个元素中是否可见并且是enable的，这样的话才叫clickable
staleness_of：等某个元素从dom树中移除，注意，这个方法也是返回True或False
element_to_be_selected：判断某个元素是否被选中了,一般用在下拉列表
element_located_to_be_selected
element_selection_state_to_be：判断某个元素的选中状态是否符合预期
element_located_selection_state_to_be：跟上面的方法作用一样，只是上面的方法传入定位到的element，而这个方法传入locator
alert_is_present：判断页面上是否存在alert
</span><span style="color: #800000;">"""</span></pre>
</div>
<p>另外这里使用了until()函数也可以使用until_not()</p>
<div>
<p>　　until_not(method, message='')</p>
<p>　　调用该方法体提供的回调函数作为一个参数，直到返回值为False</p>
<p>　　until(method, message='')</p>
<p>　　调用该方法体提供的回调函数作为一个参数，直到返回值为True</p>
<h3>3. 下拉框or弹框</h3>
</div>
</div>
</div>
<p>通常情况下，在网页中会有一些下拉框进行选择或者给你一个弹框告诉你需要进行确认，遇到这样的情况如何解决呢，宏哥在这里就来简单地说一说&hellip;&hellip;&lsquo;&rsquo;</p>
<h4>3.1 代码实现：</h4>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）1.png" alt="" /></p>
<h4>3.2 参考代码：</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> coding=utf-8🔥</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-09
@author: 北京-宏哥   QQ交流群：705269076
Project: python+ selenium自动化测试练习篇8
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> time

</span><span style="color: #0000ff;">from</span> selenium <span style="color: #0000ff;">import</span><span style="color: #000000;"> webdriver
</span><span style="color: #0000ff;">from</span> selenium.webdriver.common.by <span style="color: #0000ff;">import</span><span style="color: #000000;"> By
</span><span style="color: #0000ff;">from</span> selenium.webdriver.common.keys <span style="color: #0000ff;">import</span><span style="color: #000000;"> Keys
</span><span style="color: #0000ff;">from</span> selenium.webdriver.common.action_chains <span style="color: #0000ff;">import</span><span style="color: #000000;"> ActionChains
</span><span style="color: #0000ff;">from</span> selenium.webdriver.support.select <span style="color: #0000ff;">import</span><span style="color: #000000;"> Select


driver </span>=<span style="color: #000000;"> webdriver.Chrome()
driver.get(</span><span style="color: #800000;">"</span><span style="color: #800000;">https://www.baidu.com</span><span style="color: #800000;">"</span><span style="color: #000000;">)
time.sleep(</span>5<span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> driver.find_element(By.ID, "kw").send_keys("selenium&amp;python")</span><span style="color: #008000;">
#</span><span style="color: #008000;"> driver.find_element(By.ID, "su").click()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> driver.find_element(By.XPATH, '/html/body/div[1]/div[5]/div[1]/div[2]/div[1]/div[2]/div[1]').click()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> driver.find_element(By.XPATH, '/html/body/div[1]/div[5]/div[1]/div[2]/div[1]/div[1]/span[2]').click()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 折腾半天才发现定位出来的不是下拉框&hellip;&hellip;</span>
driver.find_element(By.LINK_TEXT, <span style="color: #800000;">'</span><span style="color: #800000;">设置</span><span style="color: #800000;">'</span><span style="color: #000000;">).click()
driver.find_element(By.LINK_TEXT, </span><span style="color: #800000;">'</span><span style="color: #800000;">搜索设置</span><span style="color: #800000;">'</span><span style="color: #000000;">).click()
time.sleep(</span>2<span style="color: #000000;">)

sel </span>= driver.find_element(By.XPATH, <span style="color: #800000;">'</span><span style="color: #800000;">//*[@id="nr"]</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 定位下拉框</span>
Select(sel).select_by_value(<span style="color: #800000;">'</span><span style="color: #800000;">50</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 通过value的值进行选定条目</span>
driver.find_element(By.CLASS_NAME, <span style="color: #800000;">'</span><span style="color: #800000;">prefpanelgo</span><span style="color: #800000;">'</span><span style="color: #000000;">).click()
time.sleep(</span>2<span style="color: #000000;">)
driver.switch_to.alert.accept()  </span><span style="color: #008000;">#</span><span style="color: #008000;"> 此处同意警告框提示内容</span>
time.sleep(2<span style="color: #000000;">)

driver.quit()</span></pre>
</div>
<h4>3.3 运行结果：</h4>
<p>运行代码后，控制台打印如下图的结果</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）2.png" alt="" /></p>
<h4>3.4 浏览器</h4>
<p>浏览器跳转到设置页面，会提示&ldquo;已记录下您的偏好&rdquo;</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）3.png" alt="" /></p>
<p>在百度首页想要进行设置每次搜索页面显示的数目，就会有一个下拉框进行选择，这里可以导入Select这个模块进行对下拉框进行选择，通常下拉框的列表是包含一个值的，这样就可以通过value来选定，完成设置之后，当然是要保存设置啦，点击保存发现，居然有</p>
<p>一个弹框，这可如何是好，切换至alert之后接受吧&hellip;&hellip;</p>
<p>通过在编辑器中的提示，我们同样可以给弹框发送一个值，当然这里设置中并没有出现这类情况。</p>
<p>这次对下拉框和弹框的处理过程中，折腾了不短时间，原因就是元素等待的问题，下回要仔细研究下元素等待的问题了。</p>
<h3>4. 自动化测试demo</h3>
<p>使用selenium进行测试，当然是需要进行验证的，此时结合python的断言函数就变得非常有用了。测试中设定好预期，当实际情况与预期有差别，给出错误信息，好像正是所希望的。</p>
<p>来一段简单的代码看下断言的基本使用:</p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）4.png" alt="复制代码" /></a></span></div>
<pre><code><span data-darkreader-inline-color="">#<span data-darkreader-inline-color=""> coding:utf-8

<span data-darkreader-inline-color="">import<span data-darkreader-inline-color=""> time

<span data-darkreader-inline-color="">from selenium <span data-darkreader-inline-color="">import<span data-darkreader-inline-color=""> webdriver

dr =<span data-darkreader-inline-color=""> webdriver.Chrome()
dr.maximize_window()

dr.get(<span data-darkreader-inline-color="">"<span data-darkreader-inline-color="">https://www.baidu.com<span data-darkreader-inline-color="">"<span data-darkreader-inline-color="">)
<span data-darkreader-inline-color="">print<span data-darkreader-inline-color="">(dr.title)

<span data-darkreader-inline-color="">try<span data-darkreader-inline-color="">:
    <span data-darkreader-inline-color="">assert (dr.title == <span data-darkreader-inline-color="">"<span data-darkreader-inline-color="">百度，你就知道<span data-darkreader-inline-color="">"<span data-darkreader-inline-color="">)
<span data-darkreader-inline-color="">except<span data-darkreader-inline-color="">:
    <span data-darkreader-inline-color="">print(<span data-darkreader-inline-color="">'<span data-darkreader-inline-color="">标题错误，请查看错误信息<span data-darkreader-inline-color="">'<span data-darkreader-inline-color="">)

time.sleep(5<span data-darkreader-inline-color="">)
dr.quit()</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）4.png" alt="复制代码" /></a></span></div>
</div>
<p>获取页面的title是否符合我们的预期，当打开的网页title不是我们想要的，不仅从函数assert的提示信息看到原因，也可输出简单的提示信息。</p>
<p>Web登录测试是很常见的测试，手动测试大家再熟悉不过了，那如何进行自动化登录测试呢！本文就基于python+selenium结合unittest单元测试框架来进行一次简单但比较完整的cnblog自动化登录测试，可提供点参考！下面就包括测试代码和每种测试情况的截图。</p>
<p>&nbsp;另一种方式是结合python测试框架unittest进行验证。以下的代码只是为了演示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> coding=utf-8🔥</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 1.先设置编码，utf-8可支持中英文，如上，一般放在第一行</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 2.注释：包括记录创建时间，创建人，项目名称。</span>
<span style="color: #800000;">'''</span><span style="color: #800000;">
Created on 2019-12-10
@author: 北京-宏哥   QQ交流群：705269076
Project: python+ selenium自动化测试练习篇9
</span><span style="color: #800000;">'''</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 3.导入模块</span>

<span style="color: #0000ff;">import</span><span style="color: #000000;"> unittest
</span><span style="color: #0000ff;">from</span> selenium <span style="color: #0000ff;">import</span><span style="color: #000000;"> webdriver
</span><span style="color: #0000ff;">from</span> time <span style="color: #0000ff;">import</span><span style="color: #000000;"> sleep
</span><span style="color: #800000;">'''</span><span style="color: #800000;">
cnblog的登录测试，分下面几种情况：
(1)用户名、密码正确
(2)用户名正确、密码不正确
(3)用户名正确、密码为空
(4)用户名错误、密码正确
(5)用户名为空、密码正确（还有用户名和密码均为空时与此情况是一样的，这里就不单独测试了）
</span><span style="color: #800000;">'''</span>

<span style="color: #0000ff;">class</span><span style="color: #000000;"> LoginCase(unittest.TestCase):

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> setUp(self):
        self.dr </span>=<span style="color: #000000;"> webdriver.Chrome()
        self.dr.maximize_window()

    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 定义登录方法</span>
    <span style="color: #0000ff;">def</span><span style="color: #000000;"> login(self, username, password):
        self.dr.get(</span><span style="color: #800000;">'</span><span style="color: #800000;">https://passport.cnblogs.com/user/signin</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> cnblog登录页面</span>
        self.dr.find_element_by_id(<span style="color: #800000;">'</span><span style="color: #800000;">LoginName</span><span style="color: #800000;">'</span><span style="color: #000000;">).send_keys(username)
        self.dr.find_element_by_id(</span><span style="color: #800000;">'</span><span style="color: #800000;">Password</span><span style="color: #800000;">'</span><span style="color: #000000;">).send_keys(password)
        self.dr.find_element_by_id(</span><span style="color: #800000;">'</span><span style="color: #800000;">submitBtn</span><span style="color: #800000;">'</span><span style="color: #000000;">).click()

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> test_login_success(self):
        </span><span style="color: #800000;">'''</span><span style="color: #800000;">用户名、密码正确</span><span style="color: #800000;">'''</span><span style="color: #000000;">
        self.login(</span><span style="color: #800000;">'</span><span style="color: #800000;">北京-宏哥</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">!qaz2wsx</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 正确用户名和密码</span>
        sleep(3<span style="color: #000000;">)
        link </span>= self.dr.find_element_by_id(<span style="color: #800000;">'</span><span style="color: #800000;">lnk_current_user</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        self.assertTrue(</span><span style="color: #800000;">'</span><span style="color: #800000;">北京-宏哥</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> link.text)  <span style="color: #008000;">#</span><span style="color: #008000;"> 用assertTrue(x)方法来断言  bool(x) is True 登录成功后用户昵称在lnk_current_user里</span>
        self.dr.get_screenshot_as_file(<span style="color: #800000;">"</span><span style="color: #800000;">D:\\cnblogtest\\login_success.jpg</span><span style="color: #800000;">"</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 截图  可自定义截图后的保存位置和图片命名</span>

    <span style="color: #0000ff;">def</span><span style="color: #000000;"> test_login_pwd_error(self):
        </span><span style="color: #800000;">'''</span><span style="color: #800000;">用户名正确、密码不正确</span><span style="color: #800000;">'''</span><span style="color: #000000;">
        self.login(</span><span style="color: #800000;">'</span><span style="color: #800000;">北京-宏哥</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">kemi</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 正确用户名，错误密码</span>
        sleep(2<span style="color: #000000;">)
        error_message </span>= self.dr.find_element_by_class_name(<span style="color: #800000;">'</span><span style="color: #800000;">ajax-error-box</span><span style="color: #800000;">'</span><span style="color: #000000;">).text
        self.assertIn(</span><span style="color: #800000;">'</span><span style="color: #800000;">用户名或密码错误</span><span style="color: #800000;">'</span>, error_message)  <span style="color: #008000;">#</span><span style="color: #008000;"> 用assertIn(a,b)方法来断言 a in b  '用户名或密码错误'在error_message里</span>
        self.dr.get_screenshot_as_file(<span style="color: #800000;">"</span><span style="color: #800000;">D:\\cnblogtest\\login_pwd_error.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> test_login_pwd_null(self):
        </span><span style="color: #800000;">'''</span><span style="color: #800000;">用户名正确、密码为空</span><span style="color: #800000;">'''</span><span style="color: #000000;">
        self.login(</span><span style="color: #800000;">'</span><span style="color: #800000;">北京-宏哥</span><span style="color: #800000;">'</span>, <span style="color: #800000;">''</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 密码为空</span>
        error_message = self.dr.find_element_by_id(<span style="color: #800000;">'</span><span style="color: #800000;">Password-error</span><span style="color: #800000;">'</span><span style="color: #000000;">).text
        self.assertEqual(error_message, </span><span style="color: #800000;">'</span><span style="color: #800000;">请输入密码</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 用assertEqual(a,b)方法来断言  a == b  请输入密码等于error_message</span>
        self.dr.get_screenshot_as_file(<span style="color: #800000;">"</span><span style="color: #800000;">D:\\cnblogtest\\login_pwd_null.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> test_login_user_error(self):
        </span><span style="color: #800000;">'''</span><span style="color: #800000;">用户名错误、密码正确</span><span style="color: #800000;">'''</span><span style="color: #000000;">
        self.login(</span><span style="color: #800000;">'</span><span style="color: #800000;">北京-宏哥1</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">!qaz2wsx</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 密码正确，用户名错误</span>
        sleep(2<span style="color: #000000;">)
        error_message </span>= self.dr.find_element_by_id(<span style="color: #800000;">'</span><span style="color: #800000;">ajax-error-box</span><span style="color: #800000;">'</span><span style="color: #000000;">).text
        self.assertIn(</span><span style="color: #800000;">'</span><span style="color: #800000;">用户名或密码错误</span><span style="color: #800000;">'</span>, error_message)  <span style="color: #008000;">#</span><span style="color: #008000;"> 用assertIn(a,b)方法来断言 a in b</span>
        self.dr.get_screenshot_as_file(<span style="color: #800000;">"</span><span style="color: #800000;">D:\\cnblogtest\\login_user_error.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> test_login_user_null(self):
        </span><span style="color: #800000;">'''</span><span style="color: #800000;">用户名为空、密码正确</span><span style="color: #800000;">'''</span><span style="color: #000000;">
        self.login(</span><span style="color: #800000;">''</span>, <span style="color: #800000;">'</span><span style="color: #800000;">!qaz2wsx</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 用户名为空，密码正确</span>
        error_message = self.dr.find_element_by_id(<span style="color: #800000;">'</span><span style="color: #800000;">LoginName-error</span><span style="color: #800000;">'</span><span style="color: #000000;">).text
        self.assertEqual(error_message, </span><span style="color: #800000;">'</span><span style="color: #800000;">请输入登录用户名</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> 用assertEqual(a,b)方法来断言  a == b</span>
        self.dr.get_screenshot_as_file(<span style="color: #800000;">"</span><span style="color: #800000;">D:\\cnblogtest\\login_user_null.jpg</span><span style="color: #800000;">"</span><span style="color: #000000;">)

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> tearDown(self):
        sleep(</span>2<span style="color: #000000;">)
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">自动测试完毕！</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        self.dr.quit()


</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    unittest.main()</span></pre>
</div>
<p>通过以上代码，我们可以看到使用selenium和unittest框架结合，已经可以对用户登陆的模块做一个简单的自动化测试。</p>
<p><strong>但是现在博客园的登陆机制的改变有可能部分用例不成功，但是你知道怎么做就可以了。</strong></p>
<p>测试截图如下：</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）6.png" alt="" /></p>
<p>&nbsp;正确用户名和密码登录成功！</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）7.png" alt="" /></p>
<p>&nbsp;用户名正确，密码为空</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）8.png" alt="" /></p>
<p>&nbsp;用户名为空，密码正确</p>
<p><img src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）9.png" alt="" /></p>
<h3>5. 小结</h3>
<p>&nbsp;好了，今天的分享就到这里吧！！！谢谢各位的耐心阅读。</p>
<p>&nbsp;</p>
<p style="text-align: center;"><span style="font-size: 18px;"><strong><strong>您的肯定就是我进步的动力。</strong>如果你感觉还不错，就请鼓励一下吧！记得点波&nbsp;<span style="font-size: 18pt; color: #ff0000;">推荐</span>&nbsp;不要忘记哦！！！</strong></span></p>
<p><span style="font-size: 18px;">&nbsp;</span></p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/《手把手教你》系列练习篇之9-python+ selenium自动化测试 -番外篇 - 最后一波啊！！！（详细教程）10.png" alt="" /></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
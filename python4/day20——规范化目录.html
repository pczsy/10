<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修day20——规范化目录' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>day20——规范化目录</center></div><div class='banquan'>原文出处:本文由博客园博主SupSnake提供。<br/>
原文连接:https://www.cnblogs.com/NiceSnake/p/11284976.html</div><br>
    <h1 id="day20">day20</h1>
<h2 id="为什么要有规范化目录">为什么要有规范化目录</h2>
<ol>
<li>可读性高: 不熟悉这个项目的代码的人，一眼就能看懂目录结构，知道程序启动脚本是哪个，测试目录在哪儿，配置文件在哪儿等等。从而非常快速的了解这个项目。</li>
<li>可维护性高: 定义好组织规则后，维护者就能很明确地知道，新增的哪个文件和代码应该放在什么目录之下。这个好处是，随着时间的推移，代码/配置的规模增加，项目结构不会混乱，仍然能够组织良好。</li>
</ol>
<p>变量：静态路径。变量</p>
<p>代码分类：</p>
<p>​ 加载快</p>
<p>​ 可读性高</p>
<p>​ 查询修改都简单</p>
<h2 id="分析规范化目录">分析规范化目录</h2>
<p>所有文件都在blog文件夹下</p>
<p><img src="./images/day20——规范化目录0.png" alt="img" /></p>
<h5 id="start.py-文件">1、start.py 文件</h5>
<p>​ 在bin文件夹下</p>
<p>​ 项目启动文件。你的项目需要有专门的文件启动，而不是在你的核心逻辑部分进行启动的，有人对这个可能不太理解，我为什么还要设置一个单独的启动文件呢？你看你生活中使用的所有电器基本都一个单独的启动按钮，汽车，热水器，电视，等等等等，那么为什么他们会单独设置一个启动按钮，而不是在一堆线路板或者内部随便找一个地方开启呢？ 目的就是放在显眼的位置，方便开启。你想想你的项目这么多py文件，如果src文件也有很多，那么到底哪个文件启动整个项目，你还得一个一个去寻找，太麻烦了，这样我把它单独拿出来，就是方便开启整个项目。</p>
<pre><code><code>import sys
import os
# sys.path.append(r&#39;D:\lnh.python\py project\teaching_show\blog&#39;)
# print(os.path.dirname(__file__))
# 获取本文件的绝对路径  # D:/lnh.python/py project/teaching_show/blog/bin
# print(os.path.dirname(os.path.dirname(__file__)))
# 获取父级目录也就是blog的绝对路径  # D:/lnh.python/py project/teaching_show/blog
BATH_DIR = os.path.dirname(os.path.dirname(__file__))
sys.path.append(BATH_DIR)
from core.src import run

if __name__ == &#39;__main__&#39;:
    run()</code></pre>
<h5 id="settings.py文件">2、settings.py文件</h5>
<p>​ 在conf文件夹下</p>
<p>​ 配置文件，就是放置一些项目中需要的静态参数，比如<strong>文件路径</strong>，<strong>数据库配置</strong>，<strong>软件的默认设置</strong>等等</p>
<h5 id="src.py-主逻辑核心逻辑文件">3、src.py 主逻辑核心逻辑文件</h5>
<p>​ 在core文件夹下</p>
<p>​ 这个文件主要存放的就是核心逻辑功能，你看你需要进行选择的这些核心功能函数，都应该放在这个文件中。</p>
<h5 id="类似于register文件">4、类似于register文件</h5>
<p>​ 在db文件夹下</p>
<p>​ 用户信息，数据相关，多个文件，这个文件文件名不固定，register只是我们项目中用到的注册表，但是这种文件就是存储数据的文件，类似于<strong>文本数据库</strong>，那么我们一些项目中的数据有的是从数据库中获取的，有些数据就是这种文本数据库中获取的，总之，你的项目中有时会遇到将一些数据存储在文件中，与程序交互的情况，所以我们要单独设置这样的文件。</p>
<h5 id="common.py-公共组件部分">5、common.py 公共组件部分</h5>
<p>​ 在lib文件夹下</p>
<p>​ 公共组件文件，这里面放置一些我们常用的公共组件函数，并不是我们核心逻辑的函数，而更像是服务于整个程序中的公用的插件，程序中需要即调用。比如我们程序中的<strong>装饰器</strong>auth，有些函数是需要这个装饰器认证的，但是有一些是不需要这个装饰器认证的，它既是何处需要何处调用即可。比如还有<strong>密码加密功能</strong>，<strong>序列化功能</strong>，<strong>日志功能</strong>等这些功能都可以放在这里。</p>
<h5 id="logging日志文件access.log">6、logging日志文件——access.log</h5>
<p>​ 在log文件夹下</p>
<p>​ 记录用户的访问次数，转账，取钱，充钱等等，log文件顾名思义就是存储log日志的文件。日志我们一会就会讲到，日志主要是供开发人员使用。比如你项目中出现一些bug问题，比如开发人员对服务器做的一些操作都会记录到日志中，以便开发者浏览，查询。</p>
<h5 id="readme">7、README</h5>
<p>​ <strong>这个我觉得是每个项目都应该有的一个文件</strong>，目的是能简要描述该项目的信息，让读者快速了解这个项目。</p>
<p>它需要说明以下几个事项:</p>
<ol>
<li>软件定位，软件的基本功能。</li>
<li>运行代码的方法: 安装环境、启动命令等。</li>
<li>简要的使用说明。</li>
<li>代码目录结构说明，更详细点可以说明软件的基本原理。</li>
<li>常见问题说明。</li>
</ol>
<p>我觉得有以上几点是比较好的一个<code>README</code>。在软件开发初期，由于开发过程中以上内容可能不明确或者发生变化，并不是一定要在一开始就将所有信息都补全。但是在项目完结的时候，是需要撰写这样的一个文档的。</p>
<p>可以参考Redis源码中<a href="https://github.com/antirez/redis#what-is-redis">Readme</a>的写法，这里面简洁但是清晰的描述了Redis功能和源码结构。</p>
<h2 id="博客园代码演示">博客园代码演示</h2>
<p>原代码</p>
<pre><code><code>status_dic = {
    &#39;username&#39;: None,
    &#39;status&#39;: False,
}
flag = True

REGISTER_PATH = r&#39;F:\s24\day20\register&#39;

def login():
    i = 0
    with open(REGISTER_PATH, encoding=&#39;utf-8&#39;) as f1:
        dic = {i.strip().split(&#39;|&#39;)[0]: i.strip().split(&#39;|&#39;)[1] for i in f1}
    while i &lt; 3:
        username = input(&#39;请输入用户名：&#39;).strip()
        password = input(&#39;请输入密码：&#39;).strip()
        if username in dic and dic[username] == password:
            print(&#39;登录成功&#39;)
            status_dic[&#39;username&#39;] = username
            status_dic[&#39;status&#39;] = True
            return True
        else:
            print(&#39;用户名密码错误，请重新登录&#39;)
            i += 1


def register():
    with open(REGISTER_PATH, encoding=&#39;utf-8&#39;) as f1:
        dic = {i.strip().split(&#39;|&#39;)[0]: i.strip().split(&#39;|&#39;)[1] for i in f1}
    while 1:
        print(&#39;\033[1;45m 欢迎来到注册页面 \033[0m&#39;)
        username = input(&#39;请输入用户名：&#39;).strip()
        if not username.isalnum():
            print(&#39;\033[1;31;0m 用户名有非法字符，请重新输入 \033[0m&#39;)
            continue
        if username in dic:
            print(&#39;\033[1;31;0m 用户名已经存在，请重新输入 \033[0m&#39;)
            continue
        password = input(&#39;请输入密码：&#39;).strip()
        if 6 &lt;= len(password) &lt;= 14:
            with open(REGISTER_PATH, encoding=&#39;utf-8&#39;, mode=&#39;a&#39;) as f1:
                f1.write(f&#39;\n{username}|{password}&#39;)
            status_dic[&#39;username&#39;] = str(username)
            status_dic[&#39;status&#39;] = True
            print(&#39;\033[1;32;0m 恭喜您，注册成功！已帮您成功登录~ \033[0m&#39;)
            return True
        else:
            print(&#39;\033[1;31;0m 密码长度超出范围，请重新输入 \033[0m&#39;)


def auth(func):
    def inner(*args, **kwargs):
        if status_dic[&#39;status&#39;]:
            ret = func(*args, **kwargs)
            return ret
        else:
            print(&#39;\033[1;31;0m 请先进行登录 \033[0m&#39;)
            if login():
                ret = func(*args, **kwargs)
                return ret

    return inner


@auth
def article():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问文章页面\033[0m&#39;)


@auth
def diary():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问日记页面\033[0m&#39;)


@auth
def comment():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问评论页面\033[0m&#39;)


@auth
def enshrine():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问收藏页面\033[0m&#39;)


def login_out():
    status_dic[&#39;username&#39;] = None
    status_dic[&#39;status&#39;] = False
    print(&#39;\033[1;32;0m 注销成功 \033[0m&#39;)


def exit_program():
    global flag
    flag = False
    return flag


choice_dict = {
    1: login,
    2: register,
    3: article,
    4: diary,
    5: comment,
    6: enshrine,
    7: login_out,
    8: exit_program,
}
def run():
    while flag:
        print(&#39;&#39;&#39;
        欢迎来到博客园首页
        1:请登录
        2:请注册
        3:文章页面
        4:日记页面
        5:评论页面
        6:收藏页面
        7:注销
        8:退出程序&#39;&#39;&#39;)

        choice = input(&#39;请输入您选择的序号:&#39;).strip()
        if choice.isdigit():
            choice = int(choice)
            if 0 &lt; choice &lt;= len(choice_dict):
                choice_dict[choice]()
            else:
                print(&#39;\033[1;31;0m 您输入的超出范围，请重新输入 \033[0m&#39;)

        else:
            print(&#39;\033[1;31;0m 您您输入的选项有非法字符，请重新输入 \033[0m&#39;)</code></pre>
<h3 id="规范化目录">规范化目录</h3>
<h4 id="blog">blog</h4>
<h5 id="bin-starts.py">bin-starts.py</h5>
<pre><code><code># run() # 找不到名字
# 找到src.py文件的run名字

# from src import run
# run()
# sys.path 到底是什么?

# import time
# import t1
# import sys
# t1.func()
&#39;&#39;&#39;
sys模块内置模块,文件运行时,sys内置模块就会将一些模块 自动  加载到内存. 内置模块. time,json pickle等等.以及当前目录的.
如何引用到一个模块最本质的原因在于这个模块名称空间在不在内存.
如果直接引用不到一个模块,他必定不是内置或者当前目录下的py文件.
所以,我们要手动将其添加到内存. 
sys.path.append()就是手动的将一些模块添加到内存,添加完毕之后,就可以直接引用了.
&#39;&#39;&#39;
# import sys
# # 版本二: 繁琐,我要将整个项目作为根目录,添加到内存中.
# sys.path.append(r&#39;F:\s24\day20\模拟博客园代码\blog\core&#39;)
# sys.path.append(r&#39;F:\s24\day20\模拟博客园代码\blog\conf&#39;)
# sys.path.append(r&#39;F:\s24\day20\模拟博客园代码\blog\db&#39;)
# from src import run
# run()


# 版本三: 你把项目路径写死了,所有的开发人员如果共同开发这个项目,必须都得按照这个目录结构去构建.
# import sys
# sys.path.append(r&#39;F:\s24\day20\模拟博客园代码\blog&#39;)
# from core.src import run
# run()


# 版本四:
import sys
import os

# print(__file__)
# print(os.path.dirname(os.path.dirname(__file__)))
# sys.path.append(r&#39;F:\s24\day20\模拟博客园代码\blog&#39;)
# from core.src import run
# run()

BASE_PATH = os.path.dirname(os.path.dirname(__file__))
sys.path.append(BASE_PATH)
from core.src import run
if __name__ == &#39;__main__&#39;:

    run()</code></pre>
<h5 id="conf-settings.py">conf-settings.py</h5>
<pre><code><code>import sys
import os
BASE_PATH = os.path.dirname(os.path.dirname(__file__))
REGISTER_PATH = os.path.join(BASE_PATH, &#39;db&#39;, &#39;register&#39;)</code></pre>
<h5 id="core-src.py">core-src.py</h5>
<pre><code><code>from conf import settings
from lib import common
status_dic = {
    &#39;username&#39;: None,
    &#39;status&#39;: False,
}
flag = True

def login():
    i = 0
    with open(settings.REGISTER_PATH, encoding=&#39;utf-8&#39;) as f1:
        dic = {i.strip().split(&#39;|&#39;)[0]: i.strip().split(&#39;|&#39;)[1] for i in f1}
    while i &lt; 3:
        username = input(&#39;请输入用户名：&#39;).strip()
        password = input(&#39;请输入密码：&#39;).strip()
        if username in dic and dic[username] == password:
            print(&#39;登录成功&#39;)
            status_dic[&#39;username&#39;] = username
            status_dic[&#39;status&#39;] = True
            return True
        else:
            print(&#39;用户名密码错误，请重新登录&#39;)
            i += 1


def register():
    with open(settings.REGISTER_PATH, encoding=&#39;utf-8&#39;) as f1:
        dic = {i.strip().split(&#39;|&#39;)[0]: i.strip().split(&#39;|&#39;)[1] for i in f1}
    while 1:
        print(&#39;\033[1;45m 欢迎来到注册页面 \033[0m&#39;)
        username = input(&#39;请输入用户名：&#39;).strip()
        if not username.isalnum():
            print(&#39;\033[1;31;0m 用户名有非法字符，请重新输入 \033[0m&#39;)
            continue
        if username in dic:
            print(&#39;\033[1;31;0m 用户名已经存在，请重新输入 \033[0m&#39;)
            continue
        password = input(&#39;请输入密码：&#39;).strip()
        if 6 &lt;= len(password) &lt;= 14:
            with open(settings.REGISTER_PATH, encoding=&#39;utf-8&#39;, mode=&#39;a&#39;) as f1:
                f1.write(f&#39;\n{username}|{password}&#39;)
            status_dic[&#39;username&#39;] = str(username)
            status_dic[&#39;status&#39;] = True
            print(&#39;\033[1;32;0m 恭喜您，注册成功！已帮您成功登录~ \033[0m&#39;)
            return True
        else:
            print(&#39;\033[1;31;0m 密码长度超出范围，请重新输入 \033[0m&#39;)


@common.auth
def article():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问文章页面\033[0m&#39;)


@common.auth
def diary():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问日记页面\033[0m&#39;)


@common.auth
def comment():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问评论页面\033[0m&#39;)


@common.auth
def enshrine():
    print(f&#39;\033[1;32;0m 欢迎{status_dic[&quot;username&quot;]}访问收藏页面\033[0m&#39;)


def login_out():
    status_dic[&#39;username&#39;] = None
    status_dic[&#39;status&#39;] = False
    print(&#39;\033[1;32;0m 注销成功 \033[0m&#39;)


def exit_program():
    global flag
    flag = False
    return flag


choice_dict = {
    1: login,
    2: register,
    3: article,
    4: diary,
    5: comment,
    6: enshrine,
    7: login_out,
    8: exit_program,
}
def run():
    while flag:
        print(&#39;&#39;&#39;
        欢迎来到博客园首页
        1:请登录
        2:请注册
        3:文章页面
        4:日记页面
        5:评论页面
        6:收藏页面
        7:注销
        8:退出程序&#39;&#39;&#39;)

        choice = input(&#39;请输入您选择的序号:&#39;).strip()
        if choice.isdigit():
            choice = int(choice)
            if 0 &lt; choice &lt;= len(choice_dict):
                choice_dict[choice]()
            else:
                print(&#39;\033[1;31;0m 您输入的超出范围，请重新输入 \033[0m&#39;)

        else:
            print(&#39;\033[1;31;0m 您您输入的选项有非法字符，请重新输入 \033[0m&#39;)</code></pre>
<h5 id="db-register">db-register</h5>
<pre><code><code>liye|liyedsb
meet|baoyuandsb</code></pre>
<h5 id="log-access.log">log-access.log</h5>
<pre><code><code></code></pre>
<h5 id="readme-1">README</h5>
<pre><code><code>说明书</code></pre>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
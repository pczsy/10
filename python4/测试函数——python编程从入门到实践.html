<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修测试函数——python编程从入门到实践' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>测试函数——python编程从入门到实践</center></div><div class='banquan'>原文出处:本文由博客园博主Shirley-Yang提供。<br/>
原文连接:https://www.cnblogs.com/shirley-yang/p/11173321.html</div><br>
    <h3 style="text-align: center;">测试函数</h3>
<p>　　学习测试，得有测试的代码。下面是一个简单的函数：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">name_function.py</span></pre>
<hr />
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_formatted_name(first, last):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">Generate a neatly formatted full name.</span><span style="color: #800000;">"""</span><span style="color: #000000;">
    full_name </span>= first + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> +<span style="color: #000000;"> last
    </span><span style="color: #0000ff;">return</span> full_name.title()</pre>
</div>
<p>　　为核实get_formatted_name()像期望的那样工作，编写一个使用这个函数的程序：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">names.py</span></pre>
<hr />
<pre><code><span style="color: #0000ff;">from</span> name_function <span style="color: #0000ff;">import</span><span style="color: #000000;"> get_formatted_name


</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">Enter 'q' at any time to quit.</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">while</span><span style="color: #000000;"> True:
    first </span>= input(<span style="color: #800000;">"</span><span style="color: #800000;">\nPlease give me a first name: </span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">if</span> first == <span style="color: #800000;">'</span><span style="color: #800000;">q</span><span style="color: #800000;">'</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">
    last </span>= input(<span style="color: #800000;">"</span><span style="color: #800000;">Please give me a last name: </span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">if</span> last == <span style="color: #800000;">'</span><span style="color: #800000;">q</span><span style="color: #800000;">'</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">

    formatted_name </span>=<span style="color: #000000;"> get_formatted_name(first, last)
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">\tNeatly formatted name: </span><span style="color: #800000;">"</span> + formatted_name + <span style="color: #800000;">"</span><span style="color: #800000;">.</span><span style="color: #800000;">"</span>)</pre>
</div>
<p>　　运行：</p>
<div class="cnblogs_code">
<pre><code>Enter <span style="color: #800000;">'</span><span style="color: #800000;">q</span><span style="color: #800000;">'</span><span style="color: #000000;"> at any time to quit.

Please give me a first name: janis
Please give me a last name: joplin
    Neatly formatted name: Janis Joplin.

Please give me a first name: bob
Please give me a last name: dylan
    Neatly formatted name: Bob Dylan.

Please give me a first name: q</span></pre>
</div>
<p>　　从输出可知，合并得到的姓名正确无误。现在假设要修改get_formatted_name()，使其还能够处理中间名。确保不破化这个函数处理只有名和姓的方式，为此可在每次修改get_formatted_name()后都进行测试：运行names.py，并输入像Janis Joplin这样的姓名。但python提供了一种自动化测试函数输出的高效方式，对get_formatted_name()进行自动化测试，就可信心满满，确信函数提供测试过的姓名时，都能正确工作。</p>
<h4>1 单元测试和测试用例</h4>
<p>　　Python标准库中的模块unittest提供了代码测试工具。单元测试&mdash;&mdash;合适函数某个方面没有问题；测试用例&mdash;&mdash;一组单元测试，这些单元测试一起核实函数在各种情况下的行为都符合要求。良好的测试用例考虑到函数可能收到的各种输入，包含针对所有这些测试情形的测试。。。全覆盖式测试用例包含一整套单元测试，涵盖了各种可能的函数使用方式。</p>
<h4>2 可通过的测试</h4>
<p>　　编写测试用例，可先导入模块unittest以及要测试的函数，再创建一个继承unittest.TestCase的类，并编写一系列方法对函数行为的不同方面进行测试。</p>
<p>　　下面时一个只包含一个方法的测试用例，检查函数get_formatted_name()在给定名和姓时能否正确工作：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #000025;">test_name_function.py</span></pre>
<hr />
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> unittest
</span><span style="color: #0000ff;">from</span> name_function <span style="color: #0000ff;">import</span><span style="color: #000000;"> get_formatted_name


</span><span style="color: #0000ff;">class</span> NamesTestCase(unittest.TestCase):  <span style="color: #008000;">#</span><span style="color: #008000;"> 创建包含针对 get_formatted_name() 的单元测试的类；最好包含字样Test；必须继承unittest.TestCase</span>
    <span style="color: #800000;">"""</span><span style="color: #800000;">测试name_function.py</span><span style="color: #800000;">"""</span>

    <span style="color: #0000ff;">def</span><span style="color: #000000;"> test_first_last_name(self):
        </span><span style="color: #800000;">"""</span><span style="color: #800000;">能够正确地处理像Janis Joplin这样的姓名吗？</span><span style="color: #800000;">"""</span><span style="color: #000000;">
        formatted_name </span>= get_formatted_name(<span style="color: #800000;">'</span><span style="color: #800000;">janis</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">joplin</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        self.assertEqual(formatted_name, </span><span style="color: #800000;">'</span><span style="color: #800000;">Janis Joplin</span><span style="color: #800000;">'</span>)  <span style="color: #008000;">#</span><span style="color: #008000;"> unittest类中的一个断言方法，判断是否相等</span>


<span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span>:  <span style="color: #008000;">#</span><span style="color: #008000;"> 在pycharm中运行时需要这行代码，IDLE运行则不需要</span>
    unittest.main()  <span style="color: #008000;">#</span><span style="color: #008000;"> 让python运行这个文件中的测试</span></pre>
</div>
<p>　　运行test_name_function.py时，所有以test打头的方法都将自动运行。</p>
<h4>3 不能通过的测试</h4>
<p>　　修改get_formatted_name()，使其能够处理中间名，但这样做时，故意让函数无法处理只有名和姓的名字。</p>
<p>　　get_formatted_name()的新版本，通过一个实参指定中间名：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">name_function.py</span></pre>
<hr />
<pre><code><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_formatted_name(first, middle, last):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">Generate a neatly formatted full name.</span><span style="color: #800000;">"""</span><span style="color: #000000;">
    full_name </span>= first + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + middle + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> +<span style="color: #000000;"> last
    </span><span style="color: #0000ff;">return</span> full_name.title()</pre>
</div>
<p>&nbsp;　　此时运行test_name_function.py，运行结果：</p>
<div class="cnblogs_code">
<pre><code>Ran 1 test <span style="color: #0000ff;">in</span><span style="color: #000000;"> 0.003s

FAILED (errors</span>=1<span style="color: #000000;">)

Error
Traceback (most recent call last):
  File </span><span style="color: #800000;">"</span><span style="color: #800000;">C:\Program Files\Python 3.7\lib\unittest\case.py</span><span style="color: #800000;">"</span>, line 59, <span style="color: #0000ff;">in</span><span style="color: #000000;"> testPartExecutor
    </span><span style="color: #0000ff;">yield</span><span style="color: #000000;">
  File </span><span style="color: #800000;">"</span><span style="color: #800000;">C:\Program Files\Python 3.7\lib\unittest\case.py</span><span style="color: #800000;">"</span>, line 615, <span style="color: #0000ff;">in</span><span style="color: #000000;"> run
    testMethod()
  File </span><span style="color: #800000;">"</span><span style="color: #800000;">C:\Users\yxf\Desktop\python_pycharm\test_names_function.py</span><span style="color: #800000;">"</span>, line 10, <span style="color: #0000ff;">in</span><span style="color: #000000;"> test_first_last_name
    formatted_name </span>= get_formatted_name(<span style="color: #800000;">'</span><span style="color: #800000;">janis</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">joplin</span><span style="color: #800000;">'</span><span style="color: #000000;">)
TypeError: get_formatted_name() missing </span>1 required positional argument: <span style="color: #800000;">'</span><span style="color: #800000;">last</span><span style="color: #800000;">'</span><span style="color: #000000;">


Process finished with exit code </span>1<span style="color: #000000;">

Assertion failed

Assertion failed

Assertion failed</span></pre>
</div>
<p>　　运行结果中给出了详细的错误信息。</p>
<h4>4 测试未通过时怎么办</h4>
<p>　　由测试代码运行得到的错误信息可知get_formatted_name()少一个实参，修改get_formatted_name()：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">def</span> get_formatted_name(first, last, middle=<span style="color: #800000;">''</span><span style="color: #000000;">):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">Generate a neatly formatted full name.</span><span style="color: #800000;">"""</span>
    <span style="color: #0000ff;">if</span><span style="color: #000000;"> middle:
        full_name </span>= first + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> + middle + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> +<span style="color: #000000;"> last
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        full_name </span>= first + <span style="color: #800000;">'</span> <span style="color: #800000;">'</span> +<span style="color: #000000;"> last
    </span><span style="color: #0000ff;">return</span> full_name.title()</pre>
</div>
<p>　　再次运行test_name_function.py：</p>
<div class="cnblogs_code">
<pre><code>Ran 1 test <span style="color: #0000ff;">in</span><span style="color: #000000;"> 0.002s

OK</span></pre>
</div>
<h4>5 添加新测试</h4>
<p>　　再编写一个测试用例，用于测试包含中间名字的测试，即在NamesTestCase类中再添加一个方法：</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">def</span><span style="color: #000000;"> test_first_last_middle_name(self):
        </span><span style="color: #800000;">"""</span><span style="color: #800000;">能够正确地处理像Wolfgang Amadeus Mozart这样的名字吗？</span><span style="color: #800000;">"""</span><span style="color: #000000;">
        formatted_name </span>= get_formatted_name(<span style="color: #800000;">'</span><span style="color: #800000;">wolfgang</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">mozart</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">amadeus</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        self.assertEqual(formatted_name, </span><span style="color: #800000;">'</span><span style="color: #800000;">Wolfgang Amadeus Mozart</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>　　***调用函数时，可选实参，即本段代码中中间名在最后。</p>
<p>　　方法名必须以test_打头，这样它才会在运行test_name_function.py时自动运行。</p>
<p>　　在TestCase类中可以使用很长的方法名，这些方法名必须是描述性的，这样才能明白测试未通过时的输出。</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
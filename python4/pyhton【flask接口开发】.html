<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修pyhton【flask接口开发】' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>pyhton【flask接口开发】</center></div><div class='banquan'>原文出处:本文由博客园博主piecesof提供。<br/>
原文连接:https://www.cnblogs.com/deliaries/p/11352259.html</div><br>
    <p><span style="font-size: 18px;"><strong>使用flask进行接口开发</strong></span></p>
<p>&nbsp;</p>
<p>语言：Python3</p>
<p>框架：flask</p>
<p>&nbsp;</p>
<p>在进行开发前首先得安装flask，然后才能使用。安装可以直接使用pip命令进行安装：pip install flask。</p>
<p>使用flask进行接口的流程：</p>
<p>1、定义一个服务server：</p>
<div class="cnblogs_code">
<pre><code>server = flask.Flask(<span style="color: #800080;">__name__</span>)          <span style="color: #008000;">#创建一个服务，</span><span style="color: #008000;">把当前的python文件当做一个服务启动，__name__代表当前的python文件。</span></pre>
</div>
<p>2、定义接口函数：</p>
<p>接口函数的定义需要在定义函数上面加上flask提供的装饰器 &ldquo;@server.route()&rdquo;，将普通函数转换为服务登录接口。</p>
<div class="cnblogs_code">
<pre><code>@server.route(<span style="color: #800000;">'</span><span style="color: #800000;">/regist</span><span style="color: #800000;">'</span>,methods=[<span style="color: #800000;">'</span>get<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span>post<span style="color: #800000;">'</span><span style="color: #800000;">])       <span style="color: #008000;">#第一个参数表示请求接口路径，第二个参数表示接口请求方式，如果不填的话默认get方式。</span></span></pre>
</div>
<p>3、运行服务server：</p>
<div class="cnblogs_code">
<pre><code>server.run(port=8000,debug=True,host=<span style="color: #800000;">'</span><span style="color: #800000;">127.0.0.1</span><span style="color: #800000;">'</span>)    <span style="color: #008000;">#</span><span style="color: #008000;"> port不能与本地服务端口冲突，host为要访问的IP地址，debug=True，表示当前为调试状态运行，修改完代码程序会自动运行，不需要手动重新运行。</span></pre>
</div>
<p>&nbsp;</p>
<p>按照以上步骤完成一个小接口：</p>
<p><strong>示例一：</strong></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> flask,json

server </span>= flask.Flask(<span style="color: #800080;">__name__</span>)         　　　　　 <span style="color: #008000;">#<span style="color: #008000;">创建一个服务，<span style="color: #008000;">把当前的python文件当做一个服务启动，__name__代表当前的python文件。</span></span></span>
<span style="color: #000000;">
@server.route(</span><span style="color: #800000;">'</span><span style="color: #800000;">/regist</span><span style="color: #800000;">'</span>,methods=[<span style="color: #800000;">'</span><span style="color: #800000;">post</span><span style="color: #800000;">'</span>])       <span style="color: #008000;">#第一个参数表示请求接口路径，第二个参数表示接口请求方式，如果不填的话默认get方式。</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> index():
    res </span>= {<span style="color: #800000;">'</span><span style="color: #800000;">msg</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">这是我开发的第一个接口</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">msg_code</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">0000</span><span style="color: #800000;">'</span><span style="color: #000000;">}
    </span><span style="color: #0000ff;">return</span> json.dumps(res,ensure_ascii=<span style="color: #000000;">False)　　<span style="color: #008000;">#<span style="color: #008000;">二进制转化为utf-8</span></span>

server.run(port</span>=8000,debug=True,host=<span style="color: #800000;">'</span><span style="color: #800000;">127.0.0.1</span><span style="color: #800000;">'</span>)　　<span style="color: #008000;">#<span style="color: #008000;">port不能与本地服务端口冲突，host为要访问的IP地址，debug=True，表示当前为调试状态运行，修改完代码程序会自动运行，不需要手动重新运行。</span></span></pre>
</div>
<p>使用postman请求后结果如下：</p>
<p><img src="./images/pyhton【flask接口开发】0.png" alt="" /></p>
<p><strong>示例二：</strong></p>
<p>接口实现接收请求数据，并对接收数据按照一定方式进行验证签名，签名通过后，获取接口请求过来的用户信息，查找数据库中是否存在该条记录，无记录进行注册步骤。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> flask,json

server </span>= flask.Flask(<span style="color: #800080;">__name__</span>)          <span style="color: #008000;">#</span><span style="color: #008000;">__name__代表当前的python文件。把当前的python文件当做一个服务启动</span>
<span style="color: #000000;">
@server.route(</span><span style="color: #800000;">'</span><span style="color: #800000;">/regist</span><span style="color: #800000;">'</span>,methods=[<span style="color: #800000;">'</span><span style="color: #800000;">post</span><span style="color: #800000;">'</span>])       <span style="color: #008000;">#</span><span style="color: #008000;">接口请求地址及接口请求方式</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> regist():
    jsondata </span>= flask.request.get_json()                     <span style="color: #008000;">#</span><span style="color: #008000;">获取到的值为请求的json串</span>
    username = jsondata[<span style="color: #800000;">'</span><span style="color: #800000;">username</span><span style="color: #800000;">'</span>] <span style="color: #0000ff;">if</span> (<span style="color: #800000;">'</span><span style="color: #800000;">username</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> jsondata) <span style="color: #0000ff;">else</span> <span style="color: #800000;">''</span>                       
    password = jsondata[<span style="color: #800000;">'</span><span style="color: #800000;">password</span><span style="color: #800000;">'</span>] <span style="color: #0000ff;">if</span> (<span style="color: #800000;">'</span><span style="color: #800000;">password</span><span style="color: #800000;">'</span> <span style="color: #0000ff;">in</span> jsondata) <span style="color: #0000ff;">else</span> <span style="color: #800000;">''</span><span style="color: #000000;">
    signjudge </span>=<span style="color: #000000;"> signMD5.signjudge()
    </span><span style="color: #0000ff;">if</span> signjudge.jsonsignjudge(jsondata) != jsondata[<span style="color: #800000;">'</span><span style="color: #800000;">sign</span><span style="color: #800000;">'</span><span style="color: #000000;">]:
        </span><span style="color: #008000;">#</span><span style="color: #008000;">######### 签名校验失败 ##########</span>
        <span style="color: #0000ff;">return</span> json.dumps({<span style="color: #800000;">'</span><span style="color: #800000;">msg</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">签名校验失败</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">msg_code</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'3<span style="color: #800000;">001<span style="color: #800000;">'</span></span></span>}, ensure_ascii=<span style="color: #000000;">False)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">pass</span>
    <span style="color: #0000ff;">if</span> username == <span style="color: #800000;">''</span> <span style="color: #0000ff;">or</span> password == <span style="color: #800000;">''</span><span style="color: #000000;">:
        </span><span style="color: #008000;">#</span><span style="color: #008000;">######### 缺少必填信息 ##########</span>
        <span style="color: #0000ff;">return</span> json.dumps({<span style="color: #800000;">'</span><span style="color: #800000;">msg</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">缺少必填信息</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">msg_code</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'1<span style="color: #800000;">001<span style="color: #800000;">'</span></span></span>}, ensure_ascii=<span style="color: #000000;">False)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">pass</span><span style="color: #000000;">
    interfacejudge </span>=<span style="color: #000000;"> interfcaejudge.interfacejudge()
    </span><span style="color: #0000ff;">if</span> interfacejudge.judgefielduser(username) !=<span style="color: #000000;"> None:
        </span><span style="color: #0000ff;">return</span> json.dumps({<span style="color: #800000;">'</span><span style="color: #800000;">msg</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">用户已存在</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">msg_code</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'2<span style="color: #800000;">001<span style="color: #800000;">'</span></span></span>}, ensure_ascii=<span style="color: #000000;">False)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        interfacejudge.insertsuerinfo(username,password)
        </span><span style="color: #0000ff;">return</span> json.dumps({<span style="color: #800000;">'</span><span style="color: #800000;">msg</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">注册成功</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">msg_code</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">0000</span><span style="color: #800000;">'</span>}, ensure_ascii=<span style="color: #000000;">False)

server.run(port</span>=8000,debug=True,host=<span style="color: #800000;">'</span><span style="color: #800000;">127.0.0.1</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<pre><code><span style="color: #808080; font-style: italic;">&nbsp;</span></pre>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修浅谈 Flask 框架' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>浅谈 Flask 框架</center></div><div class='banquan'>原文出处:本文由博客园博主林染提供。<br/>
原文连接:https://www.cnblogs.com/zengyi1995/p/11322989.html</div><br>
    <h3 class="md-end-block md-heading md-focus"><em><strong><span class="md-plain md-expand">一、框架对比</span></strong></em></h3>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Django &mdash;&mdash; 教科书式框架</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">优势：组件全，功能全，教科书</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">劣势：占用资源，创建复杂度高</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Flask &mdash;&mdash; 以简单为基准开发，一切从简，能省则省</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">优势：轻，块</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">劣势：先天不足，第三方组件稳定性较差</span></p>
</li>
</ul>
</li>
</ul>
<table class="md-table" style="height: 177px; width: 556px;">
<thead>
<tr class="md-end-block" align="center" valign="middle"><th style="margin-left: 120px;"><span class="td-span">Django</span></th><th><span class="td-span">Flask</span></th></tr>
</thead>
<tbody>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span">Admin &mdash;&mdash; Model</span></td>
<td><span class="td-span">原生无</span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span">Model</span></td>
<td><span class="td-span">原生无</span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span">Form</span></td>
<td><span class="td-span">原生无</span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span">Session</span></td>
<td><span class="td-span">有 &mdash;&mdash; 颠覆认知操作<br /><br /></span></td>





</tr>





</tbody>




</table>
<h3 class="md-end-block md-heading"><em><strong><span class="md-plain">二、Flask入门</span></strong></em></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">下载安装</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">下载：pip install Flask</span></p>




</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">注意：不要使用工具中的插件创建 Flask 项目</span></p>




</li>




</ul>




</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">三行代码启动Flask项目</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
app.run()</span></pre>
</div>
</li>
</ul>
<h3 class="md-end-block md-heading"><em><strong><span class="md-plain">三、Flask的请求和响应</span></strong></em></h3>
<h4 class="md-end-block md-heading"><span class="md-plain">3.1 Flask中的响应Response</span></h4>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">与django对比</span></p>
<table class="md-table" style="height: 168px; width: 607px;">
<thead>
<tr class="md-end-block" align="center" valign="middle"><th><span class="td-span"><span class="md-plain">Django</span></span></th><th><span class="td-span"><span class="md-plain">Flask</span></span></th><th><span class="td-span"><span class="md-plain">返回</span></span></th></tr>
</thead>
<tbody>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">HttpResponse("hello")</span></span></td>
<td><span class="td-span"><span class="md-plain">"hello"</span></span></td>
<td><span class="td-span"><span class="md-plain">字符串</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">render(request,"html",{"k":v})</span></span></td>
<td><span class="td-span"><span class="md-plain">render_template("html",k=v)</span></span></td>
<td><span class="td-span"><span class="md-plain">html页面</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">redirect("/")</span></span></td>
<td><span class="td-span"><span class="md-plain">redirect("/")</span></span></td>
<td><span class="td-span"><span class="md-plain">重定向</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">JsonResponse({"k":v})</span></span></td>
<td><span class="td-span"><span class="md-plain">jsonify({"k":v})</span></span></td>
<td><span class="td-span"><span class="md-plain">标准的json字符串</span></span></td>
</tr>
</tbody>
</table>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">以上是web框架的Response三剑客</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">返回字符串 &mdash;&mdash; string</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> home():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">hello World I am Flask</span><span style="color: #800000;">"</span><span style="color: #000000;">
app.run()</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">返回html页面 &mdash;&mdash; string</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, render_template
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/index</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> index():
    </span><span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">index.html</span><span style="color: #800000;">"</span><span style="color: #000000;">)
app.run()</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">返回重定向 &mdash;&mdash; string</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, redirect
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> login():
    </span><span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">"</span><span style="color: #800000;">/index</span><span style="color: #800000;">"</span><span style="color: #000000;">)
app.run()</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">返回文件内容 &mdash;&mdash; Response instance</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">send_file()：读取并返回文件内容，自动识别文件类型，Content-type中添加类型，即，Content-type：文本类型</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">浏览器特性：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">可识别的Content-type，会自动渲染</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">不可识别的Content-type，会自动下载</span></p>
</li>
</ul>
</li>
</ul>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, send_file
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/get_file</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_file():
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 返回文件内容，自动识别文件类型，Content-type中添加文件类型，Content-type:文件类型</span>
    <span style="color: #0000ff;">return</span> send_file(<span style="color: #800000;">"</span><span style="color: #800000;">2.exe</span><span style="color: #800000;">"</span><span style="color: #000000;">)
app.run()</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">返回标准格式的json字符串 &mdash;&mdash; string</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">jsonify()：返回标准格式的json字符串，本质：先序列化json的字典，Content-type中加入Application/json，Flask1.1.1 直接返回字典格式，相当于自动执行jsonify</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, send_file
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/get_json</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_json():
    d </span>= {<span style="color: #800000;">"</span><span style="color: #800000;">k</span><span style="color: #800000;">"</span>:<span style="color: #800000;">"</span><span style="color: #800000;">v</span><span style="color: #800000;">"</span><span style="color: #000000;">}
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 返回标准Json格式字符串 API接口</span>
    <span style="color: #0000ff;">return</span><span style="color: #000000;"> jsonify(d)
app.run()</span></pre>
</div>
</li>
</ul>
<h4 class="md-end-block md-heading"><span class="md-plain">3.2 Flask中的请求Request</span></h4>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">与django对比</span></p>
<table class="md-table" style="height: 373px; width: 1024px;">
<thead>
<tr class="md-end-block" align="center" valign="middle"><th><span class="td-span"><span class="md-plain">Django</span></span></th><th><span class="td-span"><span class="md-plain">Flask</span></span></th><th><span class="td-span"><span class="md-plain">Flask中的含义</span></span></th></tr>
</thead>
<tbody>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.method</span></span></td>
<td><span class="td-span"><span class="md-plain">request.method</span></span></td>
<td><span class="td-span"><span class="md-plain">获取请求方式</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.GET</span></span></td>
<td><span class="td-span"><span class="md-plain">request.args</span></span></td>
<td><span class="td-span"><span class="md-plain">获取URL中的数据</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.POST</span></span></td>
<td><span class="td-span"><span class="md-plain">request.form</span></span></td>
<td><span class="td-span"><span class="md-plain">获取FormData中的数据 ，也就是所谓的Form标签</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.FILES</span></span></td>
<td><span class="td-span"><span class="md-plain">request.files</span></span></td>
<td><span class="td-span"><span class="md-plain">获取request中的文件，返回FileStorage中，存在save(保存文件）和filename(原始文件名)</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td>&nbsp;</td>
<td><span class="td-span"><span class="md-plain">request.json</span></span></td>
<td><span class="td-span"><span class="md-plain">请求中Content-Type：application/json，请求体中的数据被序列化到 request.json中，以字典的形式存放</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td>&nbsp;</td>
<td><span class="td-span"><span class="md-plain">request.data</span></span></td>
<td><span class="td-span"><span class="md-plain">请求中Content-Type中不包含Form或FormData，保留请求体中的原始数据，bytes类型</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.path_info</span></span></td>
<td><span class="td-span"><span class="md-plain">request.path</span></span></td>
<td><span class="td-span"><span class="md-plain">请求路径 路由地址</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.get_full_patch()</span></span></td>
<td><span class="td-span"><span class="md-plain">request.url</span></span></td>
<td><span class="td-span"><span class="md-plain">访问请求的完整路径包括 url参数</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.get_host()</span></span></td>
<td><span class="td-span"><span class="md-plain">request.host</span></span></td>
<td><span class="td-span"><span class="md-plain">主机位 127.0.0.1:5000</span></span></td>
</tr>
<tr class="md-end-block" align="center" valign="middle">
<td><span class="td-span"><span class="md-plain">request.COOKTES</span></span></td>
<td><span class="td-span"><span class="md-plain">request.cookies</span></span></td>
<td><span class="td-span"><span class="md-plain">字典获取浏览器请求时带上的Cookie</span></span></td>
</tr>
</tbody>
</table>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">注意：request.values，获取url和FormData中的数据，敏感地带(url和FormData中存在相同的key时会出错)</span></p>
</li>
</ul>
</li>
</ul>
<div class="cnblogs_code" style="margin-left: 60px;" onclick="cnblogs_code_show('17cffd62-3064-4658-af92-16aec6b29954')"><img id="code_img_closed_17cffd62-3064-4658-af92-16aec6b29954" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_17cffd62-3064-4658-af92-16aec6b29954" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('17cffd62-3064-4658-af92-16aec6b29954',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_17cffd62-3064-4658-af92-16aec6b29954" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> os
</span><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, request, render_template
</span><span style="color: #008000;">#</span><span style="color: #008000;"> request 请求上下文管理</span>
app = Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
​
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span>,methods=[<span style="color: #800000;">"</span><span style="color: #800000;">GET</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">POST</span><span style="color: #800000;">"</span><span style="color: #000000;">])
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> login():
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> print(request.args.to_dict())</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> print(request.host)</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> print(request.path)</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> print(request.url)</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> print(request.cookies)</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 优先判断 请求方式</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 如果是 GET 请求 返回登录页面</span>
    <span style="color: #0000ff;">if</span> request.method == <span style="color: #800000;">"</span><span style="color: #800000;">GET</span><span style="color: #800000;">"</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">login.html</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 如果是 POST 请求 获取用户名密码 校验</span>
    <span style="color: #0000ff;">else</span>: <span style="color: #008000;">#</span><span style="color: #008000;"> 405 请求方式不被允许</span>
        my_file = request.files.get(<span style="color: #800000;">"</span><span style="color: #800000;">my_file</span><span style="color: #800000;">"</span><span style="color: #000000;">)
        filename </span>= my_file.filename <span style="color: #008000;">#</span><span style="color: #008000;"> 获取原始文件名</span>
        file_path = os.path.join(<span style="color: #800000;">"</span><span style="color: #800000;">avatar</span><span style="color: #800000;">"</span><span style="color: #000000;">,filename)
        my_file.save(file_path)
        </span><span style="color: #0000ff;">print</span>(request.form.to_dict()) <span style="color: #008000;">#</span><span style="color: #008000;"> form - FormData</span>
        <span style="color: #0000ff;">if</span> request.form.get(<span style="color: #800000;">"</span><span style="color: #800000;">username</span><span style="color: #800000;">"</span>) == <span style="color: #800000;">"</span><span style="color: #800000;">YWB</span><span style="color: #800000;">"</span><span style="color: #000000;">:
            </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Login OK!</span><span style="color: #800000;">"</span>
    <span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Login 不OK!</span><span style="color: #800000;">"</span><span style="color: #000000;">
​
</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    app.run()</span></pre>
</div>
<span class="cnblogs_code_collapse">示例</span></div>
<h3 class="md-end-block md-heading"><strong><em><span class="md-plain">四、 Jinja2：template语言</span></em></strong></h3>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">{{ }} 引用或执行</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">{% %} 逻辑引用</span></p>
<div class="cnblogs_code">
<pre><code>STUDENT = {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Old</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 38, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">中</span><span style="color: #800000;">'</span><span style="color: #000000;">}
STUDENT_LIST </span>=<span style="color: #000000;"> [
    {</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Old</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 38, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">中</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    {</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Boy</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 73, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">男</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    {</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">EDU</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 84, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">女</span><span style="color: #800000;">'</span><span style="color: #000000;">}
]
STUDENT_DICT </span>=<span style="color: #000000;"> {
    </span>1: {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Old</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 38, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">中</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    </span>2: {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Boy</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 73, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">男</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    </span>3: {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">EDU</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 84, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">女</span><span style="color: #800000;">'</span><span style="color: #000000;">},
}
</span><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, render_template, Markup
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
​
@app.template_global()
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> ab(a,b):
    </span><span style="color: #0000ff;">return</span> a+<span style="color: #000000;">b
​
@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> home():
    </span><span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">stu.html</span><span style="color: #800000;">"</span>,stu=STUDENT,stu_l = STUDENT_LIST,stu_d =<span style="color: #000000;"> STUDENT_DICT)
​
@app.template_global()
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> my_input(na,ty):
    s </span>= f<span style="color: #800000;">"</span><span style="color: #800000;">&lt;input type='{ty}' value='{na}'&gt;</span><span style="color: #800000;">"</span>
    <span style="color: #0000ff;">return</span><span style="color: #000000;"> Markup(s)
​
</span><span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    app.run()</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('51627368-1ca0-4dbf-8d36-b24da6a44571')"><img id="code_img_closed_51627368-1ca0-4dbf-8d36-b24da6a44571" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_51627368-1ca0-4dbf-8d36-b24da6a44571" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('51627368-1ca0-4dbf-8d36-b24da6a44571',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_51627368-1ca0-4dbf-8d36-b24da6a44571" class="cnblogs_code_hide">
<pre><code>&lt;p&gt;{{ ab(50,60) }}&lt;/p&gt;<span style="color: #000000;">

{{ stu }}
</span>&lt;table border=<span style="color: #800000;">"</span><span style="color: #800000;">1px</span><span style="color: #800000;">"</span>&gt;
    &lt;tr&gt;
        &lt;td&gt;name&lt;/td&gt;
        &lt;td&gt;age&lt;/td&gt;
        &lt;td&gt;gender&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;{{ stu.name }}&lt;/td&gt;
        &lt;td&gt;{{ stu[<span style="color: #800000;">"</span><span style="color: #800000;">age</span><span style="color: #800000;">"</span>] }}&lt;/td&gt;
        &lt;td&gt;{{ stu.get(<span style="color: #800000;">"</span><span style="color: #800000;">gender</span><span style="color: #800000;">"</span>) }}&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;<span style="color: #000000;">

{{ stu_l }}
</span>&lt;table border=<span style="color: #800000;">"</span><span style="color: #800000;">1px</span><span style="color: #800000;">"</span>&gt;
    &lt;tr&gt;
        &lt;td&gt;name&lt;/td&gt;
        &lt;td&gt;age&lt;/td&gt;
        &lt;td&gt;gender&lt;/td&gt;
    &lt;/tr&gt;<span style="color: #000000;">
    {</span>% <span style="color: #0000ff;">for</span> student <span style="color: #0000ff;">in</span> stu_l %<span style="color: #000000;">}
    </span>&lt;tr&gt;
        &lt;td&gt;{{ student.name }}&lt;/td&gt;
        &lt;td&gt;{{ student[<span style="color: #800000;">"</span><span style="color: #800000;">age</span><span style="color: #800000;">"</span>] }}&lt;/td&gt;
        &lt;td&gt;<span style="color: #000000;">
            {</span>% <span style="color: #0000ff;">if</span>  student.get(<span style="color: #800000;">"</span><span style="color: #800000;">gender</span><span style="color: #800000;">"</span>) != <span style="color: #800000;">"</span><span style="color: #800000;">男</span><span style="color: #800000;">"</span> <span style="color: #0000ff;">and</span>  student.get(<span style="color: #800000;">"</span><span style="color: #800000;">gender</span><span style="color: #800000;">"</span>) != <span style="color: #800000;">"</span><span style="color: #800000;">女</span><span style="color: #800000;">"</span> %<span style="color: #000000;">}
            女
            {</span>% <span style="color: #0000ff;">else</span> %<span style="color: #000000;">}
            {{ student.get(</span><span style="color: #800000;">"</span><span style="color: #800000;">gender</span><span style="color: #800000;">"</span><span style="color: #000000;">) }}
            {</span>% endif %<span style="color: #000000;">}
        </span>&lt;/td&gt;
    &lt;/tr&gt;<span style="color: #000000;">
    {</span>% endfor %<span style="color: #000000;">}
</span>&lt;/table&gt;<span style="color: #000000;">

{{ stu_d }}
</span>&lt;table border=<span style="color: #800000;">"</span><span style="color: #800000;">1px</span><span style="color: #800000;">"</span>&gt;
    &lt;tr&gt;
        &lt;td&gt;id&lt;/td&gt;
        &lt;td&gt;name&lt;/td&gt;
        &lt;td&gt;age&lt;/td&gt;
        &lt;td&gt;gender&lt;/td&gt;
    &lt;/tr&gt;<span style="color: #000000;">
    {</span>% <span style="color: #0000ff;">for</span> skey,svalue <span style="color: #0000ff;">in</span> stu_d.items() %<span style="color: #000000;">}
    </span>&lt;tr&gt;
        &lt;td&gt;{{ skey }}&lt;/td&gt;
        &lt;td&gt;{{ svalue.get(<span style="color: #800000;">"</span><span style="color: #800000;">name</span><span style="color: #800000;">"</span>) }}&lt;/td&gt;
        &lt;td&gt;{{ svalue.get(<span style="color: #800000;">"</span><span style="color: #800000;">age</span><span style="color: #800000;">"</span>) }}&lt;/td&gt;
        &lt;td&gt;
            11111
        &lt;/td&gt;
    &lt;/tr&gt;<span style="color: #000000;">
    {</span>% endfor %<span style="color: #000000;">}
</span>&lt;/table&gt;</pre>
</div>
<span class="cnblogs_code_collapse">stu.html</span></div>
</li>
</ul>
<h3 class="md-end-block md-heading"><strong><em><span class="md-plain">五、Flask的知识点</span></em></strong></h3>
<h4 class="md-end-block md-heading"><span class="md-plain">5.1 Flask中的session</span></h4>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">基于请求上下文管理机制</span></p>
<div class="cnblogs_code">
<pre><code>STUDENT = {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Old</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 38, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">中</span><span style="color: #800000;">'</span><span style="color: #000000;">}
STUDENT_LIST </span>=<span style="color: #000000;"> [
    {</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Old</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 38, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">中</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    {</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Boy</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 73, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">男</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    {</span><span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">EDU</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 84, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">女</span><span style="color: #800000;">'</span><span style="color: #000000;">}
]
STUDENT_DICT </span>=<span style="color: #000000;"> {
    </span>1: {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Old</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 38, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">中</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    </span>2: {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">Boy</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 73, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">男</span><span style="color: #800000;">'</span><span style="color: #000000;">},
    </span>3: {<span style="color: #800000;">'</span><span style="color: #800000;">name</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">EDU</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">age</span><span style="color: #800000;">'</span>: 84, <span style="color: #800000;">'</span><span style="color: #800000;">gender</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">女</span><span style="color: #800000;">'</span><span style="color: #000000;">},
}
</span><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask, render_template, request, session, redirect
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> app.config["DEBUG"] = True</span>
app.debug =<span style="color: #000000;"> True
app.secret_key </span>= <span style="color: #800000;">"</span><span style="color: #800000;">!@#$%^(*&amp;^%$#@#$%&amp;*(^$WQ*(^EWET*^EWEU</span><span style="color: #800000;">"</span>

<span style="color: #0000ff;">def</span> war(func): <span style="color: #008000;">#</span><span style="color: #008000;"> func = home</span>
    <span style="color: #0000ff;">def</span> inner(*args,**<span style="color: #000000;">kwargs):
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 校验session</span>
        <span style="color: #0000ff;">if</span> session.get(<span style="color: #800000;">"</span><span style="color: #800000;">user</span><span style="color: #800000;">"</span><span style="color: #000000;">):
            ret </span>= func(*args,**kwargs) <span style="color: #008000;">#</span><span style="color: #008000;"> func = home</span>
            <span style="color: #0000ff;">return</span><span style="color: #000000;"> ret
        </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
            </span><span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> inner

@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;">)
@war           </span><span style="color: #008000;">#</span><span style="color: #008000;"> war(home) -&gt; inner == == home</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 先要经过一次校验 才能执行或不执行视图函数</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> home():
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 校验用户登录 session</span>
    <span style="color: #008000;">#</span><span style="color: #008000;">如果session。get（&ldquo;user&rdquo;） 存在</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 如果不存在 返回Login</span>
    <span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">stu.html</span><span style="color: #800000;">"</span>,stu=STUDENT,stu_l = STUDENT_LIST,stu_d =<span style="color: #000000;"> STUDENT_DICT)

@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/a</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> homea():
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 校验用户登录状态？</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 校验session中有没有 user Key</span>
    <span style="color: #0000ff;">if</span> session.get(<span style="color: #800000;">"</span><span style="color: #800000;">user</span><span style="color: #800000;">"</span><span style="color: #000000;">):
        inp </span>= Markup(<span style="color: #800000;">"</span><span style="color: #800000;">&lt;input type='submit' value='后端给返回的按钮'&gt;</span><span style="color: #800000;">"</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">my_a.html</span><span style="color: #800000;">"</span>, btn=<span style="color: #000000;">inp)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 校验失败</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 跳转login</span>
    <span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span><span style="color: #000000;">)

@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span>,methods=[<span style="color: #800000;">"</span><span style="color: #800000;">GET</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">POST</span><span style="color: #800000;">"</span><span style="color: #000000;">])
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> login():
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 当请求方式为 GET 的时候</span>
    <span style="color: #0000ff;">if</span> request.method == <span style="color: #800000;">"</span><span style="color: #800000;">GET</span><span style="color: #800000;">"</span><span style="color: #000000;">:
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> eyJ1c2VyIjoiYWxleGFuZGVyLmRzYi5saSJ9.XUfYMw.o8oZX2GMC-kjZPWBkyRuUeSMp4M</span>
        <span style="color: #008000;">#</span><span style="color: #008000;">  交由客户端保管机制</span>
        <span style="color: #008000;">#</span><span style="color: #008000;"> {"user":"alexander.dsb.li"}</span>
      <span style="color: #008000;">#</span><span style="color: #008000;"> Flask理念 - 一切从简 为服务器减轻压力</span>
        <span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">login.html</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        user_info </span>=<span style="color: #000000;"> request.form.to_dict()
        session[</span><span style="color: #800000;">"</span><span style="color: #800000;">user</span><span style="color: #800000;">"</span>] = user_info.get(<span style="color: #800000;">"</span><span style="color: #800000;">username</span><span style="color: #800000;">"</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">print</span>(session.get(<span style="color: #800000;">"</span><span style="color: #800000;">user</span><span style="color: #800000;">"</span><span style="color: #000000;">))
        </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">login OK!</span><span style="color: #800000;">"</span>

<span style="color: #0000ff;">if</span> <span style="color: #800080;">__name__</span> == <span style="color: #800000;">'</span><span style="color: #800000;">__main__</span><span style="color: #800000;">'</span><span style="color: #000000;">:
    app.run(</span><span style="color: #800000;">"</span><span style="color: #800000;">0.0.0.0</span><span style="color: #800000;">"</span>,9527)</pre>
</div>
</li>
</ul>
<h4 class="md-end-block md-heading"><span class="md-plain">5.2 Flask中的路由</span></h4>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">@app.route()</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">参数：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">rule：路由地址，例，"/login" </span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">methods：允许进入视图函数的请求方式</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">endpoint：mapping ，路由地址和endpoint之间的mapping，路由地址和视图函数之间还有一个mapping，注意，endpoint在同一个app中不能出现重复,默认值是视图函数名</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">defaults：默认路由参数 </span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">strict_slashes：是否严格遵循路由匹配规则</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">redirect_to：永久重定向 ，308和301</span></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="cnblogs_code" style="margin-left: 60px;" onclick="cnblogs_code_show('157f2e14-d014-45d4-80ff-f28797e0250d')"><img id="code_img_closed_157f2e14-d014-45d4-80ff-f28797e0250d" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_157f2e14-d014-45d4-80ff-f28797e0250d" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('157f2e14-d014-45d4-80ff-f28797e0250d',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_157f2e14-d014-45d4-80ff-f28797e0250d" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask,request,url_for
</span><span style="color: #008000;">#</span><span style="color: #008000;"> url_for用于对endpoint设置的名称的反向获取url</span>
app = Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)

@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/a</span><span style="color: #800000;">"</span>,methods=[<span style="color: #800000;">"</span><span style="color: #800000;">GET</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">PoSt</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">options</span><span style="color: #800000;">"</span>,<span style="color: #800000;">"</span><span style="color: #800000;">abc</span><span style="color: #800000;">"</span>],endpoint=<span style="color: #800000;">"</span><span style="color: #800000;">end_homea</span><span style="color: #800000;">"</span> ,defaults={<span style="color: #800000;">"</span><span style="color: #800000;">count</span><span style="color: #800000;">"</span>:20},strict_slashes=True,redirect_to=<span style="color: #800000;">"</span><span style="color: #800000;">/</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> homea(count):
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> print(url_for("end_homea"))  </span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 如果在蓝图里面，要使用url_for("蓝图标识".endpoint)</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> 如文件名为app01，则url_for("app01.end_homea")</span>
    count = request.args.get(<span style="color: #800000;">"</span><span style="color: #800000;">count</span><span style="color: #800000;">"</span><span style="color: #000000;">,count)
    </span><span style="color: #0000ff;">return</span> f<span style="color: #800000;">"</span><span style="color: #800000;">200OK!{count}</span><span style="color: #800000;">"</span></pre>
</div>
<span class="cnblogs_code_collapse">示例</span></div>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">动态参数路由</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">可以分页,获取文件,解决分类,解决正则路由问题</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask,request,url_for
</span><span style="color: #008000;">#</span><span style="color: #008000;"> url_for用于对endpoint设置的名称的反向获取url</span>
app = Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)

@app.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/get_img/&lt;filename&gt;</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_img(filename):
    filepath </span>= os.path.join(<span style="color: #800000;">"</span><span style="color: #800000;">img</span><span style="color: #800000;">"</span><span style="color: #000000;">, filename)
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> send_file(filepath)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 访问地址 : http://127.0.0.1:5000/info/1</span>
@app.route(<span style="color: #800000;">"</span><span style="color: #800000;">/info/&lt;int:nid&gt;</span><span style="color: #800000;">"</span>, methods=[<span style="color: #800000;">"</span><span style="color: #800000;">GET</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">POST</span><span style="color: #800000;">"</span>], endpoint=<span style="color: #800000;">"</span><span style="color: #800000;">r_info</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> student_info(nid):
    </span><span style="color: #0000ff;">print</span>(url_for(<span style="color: #800000;">"</span><span style="color: #800000;">r_info</span><span style="color: #800000;">"</span>,nid=2))  <span style="color: #008000;">#</span><span style="color: #008000;"> /info/2，反向url时也要加上参数</span>
    <span style="color: #0000ff;">return</span> f<span style="color: #800000;">"</span><span style="color: #800000;">Hello Old boy {nid}</span><span style="color: #800000;">"</span>   <span style="color: #008000;">#</span><span style="color: #008000;"> Python3.6的新特性 f"{变量名}"</span></pre>
</div>
</li>
</ul>
<h4 class="md-end-block md-heading"><span class="md-plain">5.3 Flask初始化配置</span></h4>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">常用配置：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">template_folder：模板文件存放路径</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">static_folder：静态文件存放目录，默认值是static</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">static_url_path：静态文件访问路径，默认值是/ + static_folder</span></p>
</li>
</ul>
</li>
</ul>
<div class="cnblogs_code" style="margin-left: 30px;" onclick="cnblogs_code_show('928287b3-5161-4b7b-b977-0f0985672200')"><img id="code_img_closed_928287b3-5161-4b7b-b977-0f0985672200" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_928287b3-5161-4b7b-b977-0f0985672200" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('928287b3-5161-4b7b-b977-0f0985672200',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_928287b3-5161-4b7b-b977-0f0985672200" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
app </span>= Flask(<span style="color: #800080;">__name__</span>,template_folder=<span style="color: #800000;">"</span><span style="color: #800000;">templatess</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            static_folder</span>=<span style="color: #800000;">"</span><span style="color: #800000;">static</span><span style="color: #800000;">"</span>,static_url_path=<span style="color: #800000;">"</span><span style="color: #800000;">/futeng</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> static == 你的家</span><span style="color: #008000;">
#</span><span style="color: #008000;"> /static == 回家路</span><span style="color: #008000;">
#</span><span style="color: #008000;"> /futeng == 富腾路</span></pre>
</div>
<span class="cnblogs_code_collapse">示例</span></div>
<h4 class="md-end-block md-heading"><span class="md-plain">5.4 Flask实例配置</span></h4>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">Flask实例配置，即app的配置，可以在app.default_config中查看</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> 在setting.py中，写配置对应的类</span>
<span style="color: #0000ff;">import</span><span style="color: #000000;"> hashlib,time
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> DebugConfig(object):
    DEBUG </span>=<span style="color: #000000;"> True
    SECRET_KEY </span>= <span style="color: #800000;">"</span><span style="color: #800000;">#$%^&amp;*($#$%^&amp;*%$#$%^&amp;*^%$#$%</span><span style="color: #800000;">"</span><span style="color: #000000;">
    PERMANENT_SESSION_LIFETIME </span>= 3600<span style="color: #000000;">
    SESSION_COOKIE_NAME </span>= <span style="color: #800000;">"</span><span style="color: #800000;">I am Not Session</span><span style="color: #800000;">"</span>

<span style="color: #0000ff;">class</span><span style="color: #000000;"> TestConfig(object):
    TESTING </span>=<span style="color: #000000;"> True
    SECRET_KEY </span>= hashlib.md5(f<span style="color: #800000;">"</span><span style="color: #800000;">{time.time()}#$%^&amp;*($#$%^&amp;*%$#$%^&amp;*^%$#$%{time.time()}</span><span style="color: #800000;">"</span>.encode(<span style="color: #800000;">"</span><span style="color: #800000;">utf8</span><span style="color: #800000;">"</span><span style="color: #000000;">)).hexdigest()
    PERMANENT_SESSION_LIFETIME </span>= 360000<span style="color: #000000;">
    SESSION_COOKIE_NAME </span>= <span style="color: #800000;">"</span><span style="color: #800000;">#$%^&amp;*($#$%^&amp;*%$#$%^&amp;*^%$#$%</span><span style="color: #800000;">"</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 在可执行文件中，调用</span>
<span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
</span><span style="color: #0000ff;">from</span> setting <span style="color: #0000ff;">import</span><span style="color: #000000;"> DebugConfig,TestConfig

app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
app.config.from_object(DebugConfig)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 或 app.config.from_object(TestConfig)</span></pre>
</div>
</li>
</ul>
<h4 class="md-end-block md-heading"><span class="md-plain">5.5 Flask的蓝图</span></h4>
<ul>
<li class="md-end-block md-p"><span class="md-plain"><span class="md-plain">蓝图：Blueprint，不能被run的Flask实例 不存在Config</span></span>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> 在可执行文件中，调用</span>
<span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
</span><span style="color: #0000ff;">from</span> users <span style="color: #0000ff;">import</span><span style="color: #000000;"> bp
</span><span style="color: #0000ff;">from</span> car_users <span style="color: #0000ff;">import</span><span style="color: #000000;"> car_bp

app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
app.register_blueprint(bp)
app.register_blueprint(car_bp)</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('e25ab08f-e216-4ebd-9050-c6cfb90e580e')"><img id="code_img_closed_e25ab08f-e216-4ebd-9050-c6cfb90e580e" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_e25ab08f-e216-4ebd-9050-c6cfb90e580e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e25ab08f-e216-4ebd-9050-c6cfb90e580e',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_e25ab08f-e216-4ebd-9050-c6cfb90e580e" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Blueprint
bp </span>= Blueprint(<span style="color: #800000;">"</span><span style="color: #800000;">app01</span><span style="color: #800000;">"</span>,<span style="color: #800080;">__name__</span><span style="color: #000000;">)

@bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/add_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> add_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">添加用户</span><span style="color: #800000;">"</span><span style="color: #000000;">

@bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/find_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> find_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">查看用户</span><span style="color: #800000;">"</span><span style="color: #000000;">

@bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/drop_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> drop_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">删除用户</span><span style="color: #800000;">"</span><span style="color: #000000;">

@bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/up_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> up_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">修改用户</span><span style="color: #800000;">"</span></pre>
</div>
<span class="cnblogs_code_collapse">users.py</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('617d7026-30a0-47df-92b4-4d13917a02de')"><img id="code_img_closed_617d7026-30a0-47df-92b4-4d13917a02de" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_617d7026-30a0-47df-92b4-4d13917a02de" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('617d7026-30a0-47df-92b4-4d13917a02de',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_617d7026-30a0-47df-92b4-4d13917a02de" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Blueprint
car_bp </span>= Blueprint(<span style="color: #800000;">"</span><span style="color: #800000;">app02</span><span style="color: #800000;">"</span>,<span style="color: #800080;">__name__</span>,url_prefix=<span style="color: #800000;">"</span><span style="color: #800000;">/car</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 参数url_prefix是为了区分users.py和car_users.py中的相同路由</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 使用url_prefix后，访问时，要在原来路由前加上url_prefix设置的路径</span>
<span style="color: #000000;">
@car_bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/add_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> add_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">car添加用户</span><span style="color: #800000;">"</span><span style="color: #000000;">

@car_bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/find_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> find_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">car查看用户</span><span style="color: #800000;">"</span><span style="color: #000000;">

@car_bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/drop_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> drop_user():
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">car删除用户</span><span style="color: #800000;">"</span><span style="color: #000000;">

@car_bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/up_user</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> up_user():
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">I am vf</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">car修改用户</span><span style="color: #800000;">"</span></pre>
</div>
<span class="cnblogs_code_collapse">car_users.py</span></div>
</li>
</ul>
<h4 class="md-end-block md-heading"><span class="md-plain">5.6 Flask特殊装饰器</span></h4>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">@app.before_request：在请求进入视图函数之前 做出处理</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">@app.after_request：在响应返回客户端之前,结束视图函数之后</span></p>
</li>
</ul>
<div class="cnblogs_code" style="margin-left: 60px;" onclick="cnblogs_code_show('0f36f7a2-b845-4899-8d9d-4ef7595060c2')"><img id="code_img_closed_0f36f7a2-b845-4899-8d9d-4ef7595060c2" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_0f36f7a2-b845-4899-8d9d-4ef7595060c2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('0f36f7a2-b845-4899-8d9d-4ef7595060c2',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_0f36f7a2-b845-4899-8d9d-4ef7595060c2" class="cnblogs_code_hide">
<pre><code><span style="color: #000000;">@app.before_request
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> be1():
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">I am Be1</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> return "第一个请求你就过不去"  # 5种</span>
<span style="color: #000000;">
@app.before_request
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> be2():
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">I am Be2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> return "第二个请求过不去了" # 5种</span>
<span style="color: #000000;">
@app.after_request
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> af1(res):
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">I am af1</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> res

@app.after_request
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> af2(res):
    </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">"</span><span style="color: #800000;">I am af2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">return</span> res</pre>
</div>
<span class="cnblogs_code_collapse">示例</span></div>
<ul class="ul-list" data-mark="-">
<li style="list-style-type: none;">
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">be+af 请求生命周期:</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">正常：be1 -&gt; be2 -&gt; vf -&gt; af2 -&gt; af1</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">异常：be1 -&gt; af2 -&gt; af1</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">注意：只要有响应返回 , af全部执行</span></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">@app.errorhandler：重定义错误页面</span></p>
</li>
</ul>
<div class="cnblogs_code" style="margin-left: 60px;" onclick="cnblogs_code_show('2e4b578d-ba8f-47a0-b2a4-a1f166148441')"><img id="code_img_closed_2e4b578d-ba8f-47a0-b2a4-a1f166148441" class="code_img_closed" src="./images/浅谈 Flask 框架0.png" alt="" /><img id="code_img_opened_2e4b578d-ba8f-47a0-b2a4-a1f166148441" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2e4b578d-ba8f-47a0-b2a4-a1f166148441',event)" src="./images/浅谈 Flask 框架1.png" alt="" />
<div id="cnblogs_code_open_2e4b578d-ba8f-47a0-b2a4-a1f166148441" class="cnblogs_code_hide">
<pre><code>@app.errorhandler(404)        <span style="color: #008000;">#</span><span style="color: #008000;"> 只能是 4xx，5xx</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> error404(error_message):
    </span><span style="color: #0000ff;">print</span><span style="color: #000000;">(error_message)
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> return redirect("https://www.autohome.com.cn/111232130/#pvareaid=33112794r5454") # 5种类型</span></pre>
</div>
<span class="cnblogs_code_collapse">示例</span></div>
<h4 class="md-end-block md-heading"><span class="md-plain">5.7 Flask的CBV</span></h4>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">CBV：继承 MethodView 让当前的 class 可以成为视图类</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)

</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Login(views.MethodView): 
    </span><span style="color: #0000ff;">def</span> get(self,*args,**<span style="color: #000000;">kwargs):
        </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">I am Get</span><span style="color: #800000;">"</span>

    <span style="color: #0000ff;">def</span> post(self,*args,**<span style="color: #000000;">kwargs):
        </span><span style="color: #0000ff;">pass</span><span style="color: #000000;">

app.add_url_rule(</span><span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                 endpoint</span>=<span style="color: #800000;">"</span><span style="color: #800000;">my_login</span><span style="color: #800000;">"</span>,    <span style="color: #008000;">#</span><span style="color: #008000;"> 可以不设置endpoint</span>
                 view_func=Login.as_view(name=<span style="color: #800000;">"</span><span style="color: #800000;">loginlogin</span><span style="color: #800000;">"</span>)   <span style="color: #008000;">#</span><span style="color: #008000;"> view_func.__name__="loginlogin"</span>
                )</pre>
</div>
</li>
</ul>
<h3 class="md-end-block md-heading"><strong><em><span class="md-plain">六、Flask组件：Flask-Session</span></em></strong></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">下载：pip install Flask-Session</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">使用：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
</span><span style="color: #0000ff;">from</span> flask_session <span style="color: #0000ff;">import</span><span style="color: #000000;"> Session
</span><span style="color: #0000ff;">from</span> redis <span style="color: #0000ff;">import</span><span style="color: #000000;"> Redis

app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
app.config[</span><span style="color: #800000;">"</span><span style="color: #800000;">SESSION_TYPE</span><span style="color: #800000;">"</span>] = <span style="color: #800000;">"</span><span style="color: #800000;">redis</span><span style="color: #800000;">"</span><span style="color: #000000;">
app.config[</span><span style="color: #800000;">"</span><span style="color: #800000;">SESSION_REDIS</span><span style="color: #800000;">"</span>] = Redis(host=<span style="color: #800000;">"</span><span style="color: #800000;">192.168.12.87</span><span style="color: #800000;">"</span>,port=6379,db=10<span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> app.session_interface # Flask 利用 session_interface 选择 Session 的存放位置 和 存放机制</span><span style="color: #008000;">
#</span><span style="color: #008000;"> app.default_config</span>
<span style="color: #000000;">
Session(app)    </span></pre>
</div>
</li>
</ul>
<h3 class="md-end-block md-heading"><strong><em><span class="md-plain">七、Flask总结</span></em></strong></h3>
<ol class="ol-list" start="">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">下载：pip install Flask</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">启动：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Flask
app </span>= Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">)
app.run(</span><span style="color: #800000;">"</span><span style="color: #800000;">0.0.0.0</span><span style="color: #800000;">"</span>,9527)        <span style="color: #008000;">#</span><span style="color: #008000;"> 监听地址 监听端口</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">response</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> Flask 三剑客</span>
<span style="color: #0000ff;">return</span> <span style="color: #800000;">""</span>    <span style="color: #008000;">#</span><span style="color: #008000;"> 返回字符串 HTTPResponse</span>
<span style="color: #0000ff;">return</span> render_template(<span style="color: #800000;">"</span><span style="color: #800000;">index.html</span><span style="color: #800000;">"</span>)    <span style="color: #008000;">#</span><span style="color: #008000;"> 返回模板 依赖MarkupSafe 默认存放路径：templates </span>
<span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span>)    <span style="color: #008000;">#</span><span style="color: #008000;"> 响应头中加入 - location：重定向</span><span style="color: #008000;">
#</span><span style="color: #008000;"> Flask 特殊Response</span>
<span style="color: #0000ff;">return</span> send_file(文件名称或文件路径+文件名称)    <span style="color: #008000;">#</span><span style="color: #008000;"> 打开并返回文件内容 自动识别文件类型 响应头 Content-Type:文件类型</span>
<span style="color: #0000ff;">return</span> jsonify({k:v})    <span style="color: #008000;">#</span><span style="color: #008000;"> 返回标准格式的json字符串 响应头中 Content-Type:application/json</span><span style="color: #008000;">
#</span><span style="color: #008000;"> Flask 1.1.1中直接返回dict 本质上是在运行jsonify</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">request</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> request
request.form  </span><span style="color: #008000;">#</span><span style="color: #008000;"> 获取FormData中的数据 to_dict() 类似字典类型 .get() ["key"] KeyError</span>
request.args  <span style="color: #008000;">#</span><span style="color: #008000;"> 获取URL中的数据 to_dict() 类似字典类型 .get() ["key"] KeyError</span>
request.json  <span style="color: #008000;">#</span><span style="color: #008000;"> 请求头中 Content-Type:application/json 存放字典</span>
request.data  <span style="color: #008000;">#</span><span style="color: #008000;"> 请求头中 Content-Type没有Form FormData 存放bytes类型</span>
<span style="color: #000000;">
request.method  </span><span style="color: #008000;">#</span><span style="color: #008000;"> 请求方式</span>
request.cookies  <span style="color: #008000;">#</span><span style="color: #008000;"> 浏览器的cookie键值对</span>
request.headers  <span style="color: #008000;">#</span><span style="color: #008000;"> 请求头</span>
request.path  <span style="color: #008000;">#</span><span style="color: #008000;"> 路由地址 请求地址</span>
request.url  <span style="color: #008000;">#</span><span style="color: #008000;"> 请求全部地址</span>
request.host  <span style="color: #008000;">#</span><span style="color: #008000;"> 主机位</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">session 交由客户端保管机制 保管一串儿加密字符串</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> session
app.config[</span><span style="color: #800000;">"</span><span style="color: #800000;">SECRET_KEY</span><span style="color: #800000;">"</span>] = <span style="color: #800000;">"</span><span style="color: #800000;">@#$%^&amp;*(()*&amp;^%$#*&amp;^&amp;%^&amp;*)</span><span style="color: #800000;">"</span><span style="color: #000000;">
session[</span><span style="color: #800000;">"</span><span style="color: #800000;">key</span><span style="color: #800000;">"</span>] = <span style="color: #800000;">"</span><span style="color: #800000;">value</span><span style="color: #800000;">"</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">路由配置 route</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">@app.route(
    rule,    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 路由地址</span>
    endpoint,    <span style="color: #008000;">#</span><span style="color: #008000;"> mapping 名称对应路由地址 url_for 反向推算路由地址 url_for(endpoint)</span>
    methods,    <span style="color: #008000;">#</span><span style="color: #008000;"> 允许进入视图函数的 请求方式</span>
    redirect_to,    <span style="color: #008000;">#</span><span style="color: #008000;"> 永久重定向 301 308</span>
    strict_slashes,    <span style="color: #008000;">#</span><span style="color: #008000;"> 是否严格遵循路由匹配规则</span>
    defalut,    <span style="color: #008000;">#</span><span style="color: #008000;"> 默认参数</span>
<span style="color: #000000;">)

@app.add_url_rule(
    rule,
    view_func,    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 视图函数</span>
<span style="color: #000000;">)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> 动态参数路由</span>
@app.route(<span style="color: #800000;">"</span><span style="color: #800000;">/get_file/&lt;filename&gt;</span><span style="color: #800000;">"</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> get_file(filename):
    </span><span style="color: #0000ff;">pass</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">初始化配置</span></p>
<div class="cnblogs_code">
<pre><code>Flask(<span style="color: #800080;">__name__</span><span style="color: #000000;">,
      template_folder,    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 模板存放文件</span>
      static_folder,    <span style="color: #008000;">#</span><span style="color: #008000;"> 静态文件存放目录</span>
      static_url_path,    <span style="color: #008000;">#</span><span style="color: #008000;"> 静态文件访问路径</span>
     )</pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">config</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">class</span><span style="color: #000000;"> DebugConfig(object):
    DEBUG </span>=<span style="color: #000000;"> True
    ...

app.config.from_object(DebugConfig)</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">蓝图 Blueprint 当成不能被 run 的 Flask 实例</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> Blueprint
bp </span>= Blueprint(<span style="color: #800000;">"</span><span style="color: #800000;">bp</span><span style="color: #800000;">"</span>,<span style="color: #800080;">__name__</span><span style="color: #000000;">,
              url_perfix,    </span><span style="color: #008000;">#</span><span style="color: #008000;"> url前缀</span>
<span style="color: #000000;">              )
@bp.route(</span><span style="color: #800000;">"</span><span style="color: #800000;">/mybp</span><span style="color: #800000;">"</span>,endpont=<span style="color: #800000;">"</span><span style="color: #800000;">666</span><span style="color: #800000;">"</span><span style="color: #000000;">)
@bp.add_url_rule
@bp.before_request
@bp.after_request
@bp.errorhandler(http错误码)

url_for(</span><span style="color: #800000;">"</span><span style="color: #800000;">蓝图标识</span><span style="color: #800000;">"</span><span style="color: #000000;">.endpoint)
url_for(</span><span style="color: #800000;">"</span><span style="color: #800000;">bp.666</span><span style="color: #800000;">"</span><span style="color: #000000;">)

app.register_blueprint(bp)</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">特殊装饰器</span></p>
<div class="cnblogs_code">
<pre><code>@app.before_request    <span style="color: #008000;">#</span><span style="color: #008000;"> 在请求进入视图函数之前，做出处理</span>
@app.after_request    <span style="color: #008000;">#</span><span style="color: #008000;"> 在结束视图函数之后，响应客户端之前</span>
@app.errorhandler(http错误码)    <span style="color: #008000;">#</span><span style="color: #008000;"> 重定向错误信息</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> error404(errorMessage):
    </span><span style="color: #0000ff;">pass</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">CBV</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> flask <span style="color: #0000ff;">import</span><span style="color: #000000;"> views
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Login(views.MethodView):
    </span><span style="color: #0000ff;">def</span> get(self,*args,**<span style="color: #000000;">kwargs):
        </span><span style="color: #0000ff;">pass</span><span style="color: #000000;">
app.add_url_rule(</span><span style="color: #800000;">"</span><span style="color: #800000;">/login</span><span style="color: #800000;">"</span>,endpoint=None,view_func=Login.as_view(name=<span style="color: #800000;">"</span><span style="color: #800000;">loginlogin</span><span style="color: #800000;">"</span><span style="color: #000000;">))
</span><span style="color: #008000;">#</span><span style="color: #008000;"> name是当前视图函数名，必须唯一，因为他是endpoint</span></pre>
</div>
</li>
</ol>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>
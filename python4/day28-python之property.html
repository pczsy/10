<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修day28-python之property' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>day28-python之property</center></div><div class='banquan'>原文出处:本文由博客园博主有猿人提供。<br/>
原文连接:https://www.cnblogs.com/sqy-yyr/p/11379414.html</div><br>
    <p>1.property用法</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class Goods:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # 原价</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.original_price = 100</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # 折扣</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.discount = 0.8</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     @property</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def price(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # 实际价格 = 原价 * 折扣</span><span style="color: #008000;">
#</span><span style="color: #008000;">         new_price = self.original_price * self.discount</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return new_price</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     @price.setter</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def price(self, value):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.original_price = value</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     @price.deleter</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def price(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         del self.original_price</span>
<span style="color: #0000ff;">class</span><span style="color: #000000;"> Goods:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self):
        self.original_price </span>= 100<span style="color: #000000;">
        self.discount </span>= 0.8<span style="color: #000000;">

    @property
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;">  price(self):
        new_price </span>= self.original_price *<span style="color: #000000;"> self.discount
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">  new_price

    @price.setter
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> price(self,value):
        self.original_price </span>=<span style="color: #000000;"> value

    @price.deleter
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> price(self):
        </span><span style="color: #0000ff;">del</span><span style="color: #000000;"> self.original_price
obj </span>=<span style="color: #000000;"> Goods()
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(obj.price)
obj.price </span>= 200
<span style="color: #0000ff;">print</span><span style="color: #000000;">(obj.price)
</span><span style="color: #0000ff;">del</span><span style="color: #000000;"> obj.price
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(obj.price)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> obj = Goods()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(obj.price)        # 获取商品价格</span><span style="color: #008000;">
#</span><span style="color: #008000;"> obj.price = 200   # 修改商品原价</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(obj.price)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> del obj.price     # 删除商品原价</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(obj.price)</span></pre>
</div>
<p>2.property补充</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     @property</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def AAA(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('get的时候运行我啊')</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     @AAA.setter</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def AAA(self,val):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('set的时候运行我啊',val)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     @AAA.deleter</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def AAA(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('del的时候运行我啊')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> #只有在属性AAA定义property后才能定义AAA.setter,AAA.deleter</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1=Foo()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1.AAA</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1.AAA='aaa'</span><span style="color: #008000;">
#</span><span style="color: #008000;"> del f1.AAA</span>


<span style="color: #008000;">#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     def get_AAA(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('get的时候运行我啊')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def set_AAA(self,val):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('set的时候运行我啊',val)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def del_AAA(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('del的时候运行我啊')</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     AAA=property(get_AAA,set_AAA,del_AAA)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> #只有在属性AAA定义property后才能定义AAA.setter,AAA.deleter</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1=Foo()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1.AAA</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1.AAA='aaa'</span><span style="color: #008000;">
#</span><span style="color: #008000;"> del f1.AAA</span>

 </pre>
</div>
<p>3.上下文管理协议</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,name):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.name=name</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     def __enter__(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('执行enter')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return self</span><span style="color: #008000;">
#
#</span><span style="color: #008000;">     def __exit__(self, exc_type, exc_val, exc_tb):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('执行exit')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print(exc_type)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print(exc_val)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print(exc_tb)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return True</span>
 
<span style="color: #008000;">#</span><span style="color: #008000;"> with Foo('a.txt') as f:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print(f)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print(asdfsaasdfasdfasdfasdfasfasdfasdfasdfasdfasfdasfd)  #触发__exit__</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print(f.name)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('-----------------')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print('000000000000000000000000000000000000000000000')</span></pre>
</div>
<pre><code>with obj as  f:<br />    '代码块'<br />   <br />1.with obj ----》触发obj.__enter__(),拿到返回值<br /><br />2.as f-----&gt;f=返回值、<br /><br />3.with obj as f  等同于     f=obj.__enter__()<br /><br />4.执行代码块<br />一：没有异常的情况下，整个代码块运行完毕后去触发__exit__,它的三个参数都为None<br />二：有异常的情况下，从异常出现的位置直接触发__exit__<br />   a：如果__exit__的返回值为True，代表吞掉了异常<br />   b：如果__exit__的返回值不为True，代表吐出了异常<br />   c：__exit__的的运行完毕就代表了整个with语句的执行完毕<br /><br /></pre>
<pre><code>#自省<br />hasattr(obj,'属性') #obj.属性  是否存在<br />getattr(obj,'属性') #获取obj.属性   不存在则报错<br />getattr(obj,'属性'，'默认值') #获取obj.属性   不存在不会报错，返回那个默认值<br />setattr(obj，'属性'，'属性的值') #obj.属性=属性的值<br />delattr(obj，'属性') #del obj.属性<br /><br />#__getattr__,__setattr__,__delattr__<br />obj点的方式去操作属性时触发的方法<br /><br />__getattr__:obj.属性 不存在时触发<br />__setattr__:obj.属性=属性的值 时触发<br />__delattr__:del obj.属性 时触发<br /><br />#__getitem__,__setitem_,__delitem__<br />obj[&lsquo;属性&rsquo;]的方式去操作属性时触发的方法<br /><br />__getitem__:obj['属性'] 时触发<br />__setitem__:obj['属性']=属性的值 时触发<br />__delitem__:del obj['属性'] 时触发<br /><br />#__get__,__set__,__delete__<br />描述就是一个新式类，这个类至少要实现上述三个方法的一个<br />class 描述符：<br />   def __get__（）：<br />      pass<br />   def __set__（）：<br />      pass<br />   def __delete__（）：<br />      pass<br /><br />class 类：<br />   name=描述符（）<br /><br />obj=类（）<br />obj.name #get<br />obj.name='egon' #set<br />del obj.name #delete<br /><br />#__del__:析构方法<br />垃圾回收时触发<br />4.元类介绍</pre>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">      pass</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> f1=Foo() #f1是通过Foo类实例化的对象</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> print(type(f1))</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(type(Foo))</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> class Bar:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     pass</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> print(type(Bar))</span>



<span style="color: #008000;">#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         pass</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Foo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Foo.__dict__)</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> def __init__(self,name,age):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     self.name=name</span><span style="color: #008000;">
#</span><span style="color: #008000;">     self.age=age</span><span style="color: #008000;">
#</span><span style="color: #008000;"> def test(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('=====&gt;')</span>
 
<span style="color: #008000;">#</span><span style="color: #008000;"> FFo=type('FFo',(object,),{'x':1,'__init__':__init__,'test':test})</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(FFo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(FFo.__dict__)</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> f1=FFo('alex',18)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(f1.name)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1.test()</span></pre>
</div>
<p>5.利用描述符自定制property</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class Lazyproperty:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,func):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('==========&gt;',func)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.func=func</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __get__(self, instance, owner):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('get')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(instance)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(owner)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         if instance is None:</span><span style="color: #008000;">
#</span><span style="color: #008000;">             return self</span><span style="color: #008000;">
#</span><span style="color: #008000;">         res=self.func(instance)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         setattr(instance,self.func.__name__,res)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return res</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> def __set__(self, instance, value):</span>
    <span style="color: #008000;">#</span><span style="color: #008000;">     pass</span>
<span style="color: #0000ff;">class</span><span style="color: #000000;"> Lazypropery:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,func):
        self.func </span>=<span style="color: #000000;"> func
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__get__</span><span style="color: #000000;">(self, instance, owner):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">get</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">if</span> instance <span style="color: #0000ff;">is</span><span style="color: #000000;"> None:
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> self
        res </span>=<span style="color: #000000;"> self.func(instance)
        setattr(instance,self.func.</span><span style="color: #800080;">__name__</span><span style="color: #000000;">,res)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> res
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__set__</span><span style="color: #000000;">(self, instance, value):
        </span><span style="color: #0000ff;">pass</span>
<span style="color: #0000ff;">class</span><span style="color: #000000;"> Room:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,name,width,length):
        self.name </span>=<span style="color: #000000;"> name
        self.width </span>=<span style="color: #000000;"> width
        self.length </span>=<span style="color: #000000;"> length
    @Lazypropery
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> area(self):
        </span><span style="color: #0000ff;">return</span>  self.width*<span style="color: #000000;">self.length
    @property
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> areal(self):
        </span><span style="color: #0000ff;">return</span>  self.width*<span style="color: #000000;">self.length
</span><span style="color: #0000ff;">print</span>(Room.<span style="color: #800080;">__dict__</span><span style="color: #000000;">)
r1 </span>= Room(<span style="color: #800000;">'</span><span style="color: #800000;">厕所</span><span style="color: #800000;">'</span>,1,1<span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span>(r1.<span style="color: #800080;">__dict__</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> class Room:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,name,width,length):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.name=name</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.width=width</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.length=length</span><span style="color: #008000;">
#</span><span style="color: #008000;">     # @property #area=property(area)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     @Lazyproperty  #area=Lazypropery(area)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def area(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return self.width * self.length</span><span style="color: #008000;">
#</span><span style="color: #008000;">     @property  #test=property(test)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def area1(self):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return  self.width * self.length</span><span style="color: #008000;">
#</span><span style="color: #008000;"> # print(Room.__dict__)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> r1=Room('厕所',1,1)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.__dict__)</span>

<span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.area)
</span><span style="color: #0000ff;">print</span>(Room.<span style="color: #800080;">__dict__</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;">实例调用</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Room.__dict__)</span>

<span style="color: #008000;">#</span><span style="color: #008000;">类调用</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Room.area)</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(Room.area)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.test)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(Room.test)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> print(r1.test)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Room.test)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area1)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area1)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area1)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area1)</span>

<span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.areal)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.areal)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.areal)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.areal)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.areal)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(r1.areal)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.__dict__)</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(r1.area)</span></pre>
</div>
<p>6.类的装饰器</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> def deco(func):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('==========')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     return func</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> # @deco       #test=deco(test)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> # def test():</span><span style="color: #008000;">
#</span><span style="color: #008000;"> #     print('test函数运行')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> # test()</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> @deco #Foo=deco(Foo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     pass</span>





 

<span style="color: #008000;">#</span><span style="color: #008000;"> def deco(obj):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('==========',obj)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     obj.x=1</span><span style="color: #008000;">
#</span><span style="color: #008000;">     obj.y=2</span><span style="color: #008000;">
#</span><span style="color: #008000;">     obj.z=3</span><span style="color: #008000;">
#</span><span style="color: #008000;">     return obj</span><span style="color: #008000;">
#</span><span style="color: #008000;"> @deco #Foo=deco(Foo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     pass</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> print(Foo.__dict__)</span>

<span style="color: #008000;">#</span><span style="color: #008000;">一切皆对象</span><span style="color: #008000;">
#</span><span style="color: #008000;"> # @deco #test=deco(test)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> def test():</span><span style="color: #008000;">
#</span><span style="color: #008000;">     print('test函数')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> test.x=1</span><span style="color: #008000;">
#</span><span style="color: #008000;"> test.y=1</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(test.__dict__)</span></pre>
</div>
<p>7.装饰器修订版</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> def Typed(**kwargs):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def deco(obj):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         for key,val in kwargs.items():</span><span style="color: #008000;">
#</span><span style="color: #008000;">             # obj.key=val</span><span style="color: #008000;">
#</span><span style="color: #008000;">             setattr(obj,key,val)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return obj</span><span style="color: #008000;">
#</span><span style="color: #008000;">     return deco</span>

<span style="color: #0000ff;">def</span> Typed(**<span style="color: #000000;">kwargs):
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> deco(obj):
        </span><span style="color: #0000ff;">for</span> key,val <span style="color: #0000ff;">in</span><span style="color: #000000;"> kwargs.items():
            setattr(obj,key,val)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> obj
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;">  deco

@Typed(x</span>=1,y=2,z=3<span style="color: #000000;">)
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Foo:
    </span><span style="color: #0000ff;">pass</span>
<span style="color: #0000ff;">print</span>(Foo.<span style="color: #800080;">__dict__</span><span style="color: #000000;">)

@Typed(name</span>=<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Bar:
    </span><span style="color: #0000ff;">pass</span>
<span style="color: #0000ff;">print</span><span style="color: #000000;">(Bar.name)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> @Typed(x=1,y=2,z=3)   #1.Typed(x=1,y=2,z=3) ---&gt;deco   2.@deco----&gt;Foo=deco(Foo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class Foo:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     pass</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Foo.__dict__)</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> @Typed(name='egon')  #@deco   ----&gt;Bar=deco(Bar)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class Bar:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     pass</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(Bar.name)</span></pre>
</div>
<p>8.类的装饰器的应用</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class Typed:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,key,expected_type):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.key=key</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.expected_type=expected_type</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __get__(self, instance, owner):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('get方法')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('instance参数【%s】' %instance)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('owner参数【%s】' %owner)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return instance.__dict__[self.key]</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __set__(self, instance, value):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('set方法')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('instance参数【%s】' % instance)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('value参数【%s】' % value)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('====&gt;',self)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         if not isinstance(value,self.expected_type):</span><span style="color: #008000;">
#</span><span style="color: #008000;">             # print('你传入的类型不是字符串，错误')</span><span style="color: #008000;">
#</span><span style="color: #008000;">             # return</span><span style="color: #008000;">
#</span><span style="color: #008000;">             raise TypeError('%s 传入的类型不是%s' %(self.key,self.expected_type))</span><span style="color: #008000;">
#</span><span style="color: #008000;">         instance.__dict__[self.key]=value</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __delete__(self, instance):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('delete方法')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('instance参数【%s】' % instance)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         instance.__dict__.pop(self.key)</span>
<span style="color: #0000ff;">class</span><span style="color: #000000;"> Typed:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,key,expected_type):
        self.key </span>=<span style="color: #000000;"> key
        self.expected_type </span>=<span style="color: #000000;"> expected_type
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__get__</span><span style="color: #000000;">(self, instance, owner):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">get方法</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">return</span> instance.<span style="color: #800080;">__dict__</span><span style="color: #000000;">[self.key]
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__set__</span><span style="color: #000000;">(self, instance, value):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">set方法</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span><span style="color: #000000;"> isinstance(value,self.expected_type):
            </span><span style="color: #0000ff;">raise</span> TypeError(<span style="color: #800000;">'</span><span style="color: #800000;">%s 传入的类型不是%s</span><span style="color: #800000;">'</span>%<span style="color: #000000;">(self.key,self.expected_type))
        instance.</span><span style="color: #800080;">__dict__</span>[self.key]=<span style="color: #000000;">value
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__delete__</span><span style="color: #000000;">(self, instance):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">delete方法</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        instance.</span><span style="color: #800080;">__dict__</span><span style="color: #000000;">.pop(self.key)

</span><span style="color: #0000ff;">def</span> deco(**<span style="color: #000000;">kwargs):
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> wrapper(obj):
        </span><span style="color: #0000ff;">for</span> key,val <span style="color: #0000ff;">in</span><span style="color: #000000;"> kwargs.items():
            setattr(obj,key,Typed(key,val))
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;">  obj
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;">  wrapper

@deco(name</span>=str,age=<span style="color: #000000;">int)
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> People:
    name </span>= <span style="color: #800000;">'</span><span style="color: #800000;">alex</span><span style="color: #800000;">'</span>
    <span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,name,age,salary,gender,heigth):
        self.name </span>=<span style="color: #000000;"> name
        self.age </span>=<span style="color: #000000;"> age
        self.salary </span>=<span style="color: #000000;"> salary
</span><span style="color: #0000ff;">print</span>(People.<span style="color: #800080;">__dict__</span><span style="color: #000000;">)
</span><span style="color: #008000;">#</span><span style="color: #008000;"> def deco(**kwargs): #kwargs={'name':str,'age':int}</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def wrapper(obj): #obj=People</span><span style="color: #008000;">
#</span><span style="color: #008000;">         for key,val in kwargs.items():#(('name',str),('age',int))</span><span style="color: #008000;">
#</span><span style="color: #008000;">             setattr(obj,key,Typed(key,val))</span><span style="color: #008000;">
#</span><span style="color: #008000;">             # setattr(People,'name',Typed('name',str)) #People.name=Typed('name',str)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return obj</span><span style="color: #008000;">
#</span><span style="color: #008000;">     return wrapper</span><span style="color: #008000;">
#</span><span style="color: #008000;"> @deco(name=str,age=int)  #@wrapper ===&gt;People=wrapper(People)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class People:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     name='alex'</span><span style="color: #008000;">
#</span><span style="color: #008000;">     # name=Typed('name',str)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     # age=Typed('age',int)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,name,age,salary,gender,heigth):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.name=name</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.age=age</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.salary=salary</span><span style="color: #008000;">
#</span><span style="color: #008000;"> # p1=People('213',13.3,13.3,'x','y')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(People.__dict__)</span></pre>
</div>
<p>9.自定制classmethod</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class ClassMethod:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,func):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.func=func</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __get__(self, instance, owner): #类来调用,instance为None,owner为类本身,实例来调用,instance为实例,owner为类本身,</span><span style="color: #008000;">
#</span><span style="color: #008000;">         def feedback(*args,**kwargs):</span><span style="color: #008000;">
#</span><span style="color: #008000;">             print('在这里可以加功能啊...')</span><span style="color: #008000;">
#</span><span style="color: #008000;">             return self.func(owner,*args,**kwargs)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return feedback</span>
<span style="color: #0000ff;">class</span><span style="color: #000000;"> ClassMethod:
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,func):
        self.func </span>=<span style="color: #000000;"> func
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__get__</span><span style="color: #000000;">(self, instance, owner):
        </span><span style="color: #0000ff;">def</span> feedback(*args,**<span style="color: #000000;">kwargs):
            </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">在这里可以加功能啊...</span><span style="color: #800000;">'</span><span style="color: #000000;">)
            </span><span style="color: #0000ff;">return</span>  self.func(owner,*args,**<span style="color: #000000;">kwargs)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> feedback

</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> People:
    name </span>= <span style="color: #800000;">'</span><span style="color: #800000;">linhaifeng</span><span style="color: #800000;">'</span><span style="color: #000000;">
    @ClassMethod
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> say_hi(cls,msg,x):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">你好啊,帅哥%s%s%s</span><span style="color: #800000;">'</span>%<span style="color: #000000;">(cls,msg,x))

</span><span style="color: #008000;">#</span><span style="color: #008000;"> People.say_hi('你那是偷心的贼',10)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class People:</span><span style="color: #008000;">
#</span><span style="color: #008000;">     name='linhaifeng'</span><span style="color: #008000;">
#</span><span style="color: #008000;">     @ClassMethod # say_hi=ClassMethod(say_hi)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def say_hi(cls,msg,x):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('你好啊,帅哥 %s %s %s' %(cls.name,msg,x))</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> People.say_hi('你是那偷心的贼',10)</span><span style="color: #008000;">
#
#</span><span style="color: #008000;"> p1=People()</span><span style="color: #008000;">
#</span><span style="color: #008000;"> p1.say_hi('你是那偷心的贼',10)</span>
p1 =<span style="color: #000000;"> People()
p1.say_hi(</span><span style="color: #800000;">'</span><span style="color: #800000;">你那是</span><span style="color: #800000;">'</span>,11)</pre>
</div>
<p>10.自定义制元类</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class MyType(type):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,a,b,c):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('元类的构造函数执行')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(a)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(b)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(c)</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __call__(self, *args, **kwargs):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print('=-======&gt;')</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(self)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         # print(args,kwargs)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         obj=object.__new__(self) #object.__new__(Foo)--&gt;f1</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.__init__(obj,*args,**kwargs)  #Foo.__init__(f1,*arg,**kwargs)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return obj</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class Foo(metaclass=MyType): #Foo=MyType(Foo,'Foo',(),{})---》__init__</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,name):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.name=name #f1.name=name</span>
<span style="color: #0000ff;">class</span><span style="color: #000000;"> MyType(type):
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,a,b,c):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">元类的构造函数执行</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__call__</span>(self, *args, **<span style="color: #000000;">kwargs):
        obj </span>= object.<span style="color: #800080;">__new__</span><span style="color: #000000;">(self)
        self.</span><span style="color: #800080;">__init__</span>(obj,*args,**<span style="color: #000000;">kwargs)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> obj
</span><span style="color: #0000ff;">class</span> Foo(metaclass=<span style="color: #000000;">MyType):
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,name):
        self.name </span>=<span style="color: #000000;"> name

</span><span style="color: #008000;">#</span><span style="color: #008000;"> print(Foo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1 = Foo('alex')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(f1)</span>
<span style="color: #000000;">
f1 </span>= Foo(<span style="color: #800000;">'</span><span style="color: #800000;">alex</span><span style="color: #800000;">'</span><span style="color: #000000;">)
</span><span style="color: #0000ff;">print</span><span style="color: #000000;">(f1)
</span><span style="color: #0000ff;">print</span>(f1.<span style="color: #800080;">__dict__</span><span style="color: #000000;">)



</span><span style="color: #008000;">#</span><span style="color: #008000;"> print(Foo)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1=Foo('alex')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(f1)</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> f1=Foo('alex')</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(f1)</span><span style="color: #008000;">
#</span><span style="color: #008000;"> print(f1.__dict__)</span></pre>
</div>
<p>11.自定义制元类精简版</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> class MyType(type):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,a,b,c):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         print('元类的构造函数执行')</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __call__(self, *args, **kwargs):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         obj=object.__new__(self)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.__init__(obj,*args,**kwargs)</span><span style="color: #008000;">
#</span><span style="color: #008000;">         return obj</span><span style="color: #008000;">
#</span><span style="color: #008000;"> class Foo(metaclass=MyType):</span><span style="color: #008000;">
#</span><span style="color: #008000;">     def __init__(self,name):</span><span style="color: #008000;">
#</span><span style="color: #008000;">         self.name=name</span><span style="color: #008000;">
#</span><span style="color: #008000;"> f1=Foo('alex')</span>

<span style="color: #0000ff;">class</span><span style="color: #000000;"> MyType(type):
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,a,b,c):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">元类的构造函数执行</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__call__</span>(self, *args, **<span style="color: #000000;">kwargs):
        obj </span>= object.<span style="color: #800080;">__new__</span><span style="color: #000000;">(self)
        self.</span><span style="color: #800080;">__init__</span>(obj,*args,**<span style="color: #000000;">kwargs)
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> obj

</span><span style="color: #0000ff;">class</span> Foo(metaclass=<span style="color: #000000;">MyType):
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span><span style="color: #000000;">(self,name):
        self.name </span>=<span style="color: #000000;"> name

f1 </span>= Foo(<span style="color: #800000;">'</span><span style="color: #800000;">alex</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>